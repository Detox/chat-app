let require,requirejs,define;(e=>{let t={},n={exports:null},r={};function i(e,r,i){const s=[];return e.every(e=>{const o=function(e,r){return"exports"==e?{}:"module"==e?n:(e.startsWith("./")&&(e=r.split("/").slice(0,-1).join("/")+"/"+e.substr(2)),t[e])}(e,r);return o?(s.push(o),!0):(i&&i(e),!1)})&&s}function s(e,t){(r[e]=r[e]||[]).push(t)}require=requirejs=((e,t)=>new Promise(n=>{const r=i(e,"",r=>s(r,require.bind(null,e,(...e)=>{t&&t(...e),n(e)})));r&&(t&&t(...r),n(r))})),(define=((e,o,a)=>{a||(a=o,o=[]);const c=i(o,e,t=>s(t,define.bind(null,e,o,a)));c&&(t[e]=a(...c)||n.exports,r[e]&&(r[e].forEach(e=>e()),delete r[e]))})).amd={},document.head.querySelector("[media=async]").removeAttribute("media"),window.WebComponents&&window.WebComponents.ready?e():document.addEventListener("WebComponentsReady",e,{once:!0})})(()=>{(function(){var e={};function t(){this.end=this.start=0,this.rules=this.parent=this.previous=null,this.cssText=this.parsedCssText="",this.atRule=!1,this.type=0,this.parsedSelector=this.selector=this.keyframesName=""}function n(e){var n=r,i=e=e.replace(c,"").replace(l,""),s=new t;s.start=0,s.end=i.length;for(var o=s,a=0,u=i.length;a<u;a++)if("{"===i[a]){o.rules||(o.rules=[]);var h=o,d=h.rules[h.rules.length-1]||null;(o=new t).start=a+1,o.parent=h,o.previous=d,h.rules.push(o)}else"}"===i[a]&&(o.end=a+1,o=o.parent||s);return n(s,e)}function r(e,t){var n=t.substring(e.start,e.end-1);if(e.parsedCssText=e.cssText=n.trim(),e.parent&&(n=(n=(n=function(e){return e.replace(/\\([0-9a-f]{1,6})\s/gi,function(e,t){for(t=6-(e=t).length;t--;)e="0"+e;return"\\"+e})}(n=t.substring(e.previous?e.previous.end:e.parent.start,e.start-1))).replace(p," ")).substring(n.lastIndexOf(";")+1),n=e.parsedSelector=e.selector=n.trim(),e.atRule=0===n.indexOf("@"),e.atRule?0===n.indexOf("@media")?e.type=o:n.match(_)&&(e.type=s,e.keyframesName=e.selector.split(p).pop()):e.type=0===n.indexOf("--")?a:i),n=e.rules)for(var c,l=0,u=n.length;l<u&&(c=n[l]);l++)r(c,t);return e}var i=1,s=7,o=4,a=1e3,c=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//gim,l=/@import[^;]*;/gim,u=/(?:^[^;\-\s}]+)?--[^;{}]*?:[^{};]*?(?:[;\n]|$)/gim,h=/(?:^[^;\-\s}]+)?--[^;{}]*?:[^{};]*?{[^}]*?}(?:[;\n]|$)?/gim,d=/@apply\s*\(?[^);]*\)?\s*(?:[;\n]|$)?/gim,f=/[^;:]*?:[^;]*?var\([^;]*\)(?:[;\n]|$)?/gim,_=/^@[^\s]*keyframes/,p=/\s+/g,m=Promise.resolve();function g(t){(t=e[t])&&(t._applyShimCurrentVersion=t._applyShimCurrentVersion||0,t._applyShimValidatingVersion=t._applyShimValidatingVersion||0,t._applyShimNextVersion=(t._applyShimNextVersion||0)+1)}function y(e){return e._applyShimCurrentVersion===e._applyShimNextVersion}var b,v=!(window.ShadyDOM&&window.ShadyDOM.inUse);function w(e){b=(!e||!e.shimcssproperties)&&(v||!(navigator.userAgent.match(/AppleWebKit\/601|Edge\/15/)||!window.CSS||!CSS.supports||!CSS.supports("box-shadow","0 0 0 var(--foo)")))}window.ShadyCSS&&void 0!==window.ShadyCSS.nativeCss?b=window.ShadyCSS.nativeCss:window.ShadyCSS?(w(window.ShadyCSS),window.ShadyCSS=void 0):w(window.WebComponents&&window.WebComponents.flags);var E=b,k=/(?:^|[;\s{]\s*)(--[\w-]*?)\s*:\s*(?:((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};{])+)|\{([^}]*)\}(?:(?=[;\s}])|$))/gi,x=/(?:^|\W+)@apply\s*\(?([^);\n]*)\)?/gi,A=/@media\s(.*)/,S=new Set;function P(e){return e?("string"==typeof e&&(e=n(e)),function e(t,n,r){r=void 0===r?"":r;var i="";if(t.cssText||t.rules){var s,o=t.rules;if((s=o)&&(s=!((s=o[0])&&s.selector&&0===s.selector.indexOf("--"))),s){s=0;for(var a,c=o.length;s<c&&(a=o[s]);s++)i=e(a,n,i)}else n=n?t.cssText:(n=(n=t.cssText).replace(u,"").replace(h,"")).replace(d,"").replace(f,""),(i=n.trim())&&(i="  "+i+"\n")}return i&&(t.selector&&(r+=t.selector+" {\n"),r+=i,t.selector&&(r+="}\n\n")),r}(e,E)):""}function T(e){return!e.__cssRules&&e.textContent&&(e.__cssRules=n(e.textContent)),e.__cssRules||null}function C(e,t,n,r){if(e){var c=!1,l=e.type;if(r&&l===o){var u=e.selector.match(A);u&&(window.matchMedia(u[1]).matches||(c=!0))}if(l===i?t(e):n&&l===s?n(e):l===a&&(c=!0),(e=e.rules)&&!c){c=0,l=e.length;for(var h;c<l&&(h=e[c]);c++)C(h,t,n,r)}}}var O=/;\s*/m,N=/^\s*(initial)|(inherit)\s*$/,R=/\s*!important/;function I(){this.a={}}I.prototype.set=function(e,t){e=e.trim(),this.a[e]={h:t,i:{}}},I.prototype.get=function(e){return e=e.trim(),this.a[e]||null};var M=null;function L(){this.b=this.c=null,this.a=new I}function D(e,t){for(var n;n=x.exec(t);){var r=n[0],i=n[1];n=n.index;var s=t.slice(0,n+r.indexOf("@apply"));t=t.slice(n+r.length);var o=B(e,s);r=void 0;var a=e;i=i.replace(O,"");var c=[],l=a.a.get(i);if(l||(a.a.set(i,{}),l=a.a.get(i)),l){a.c&&(l.i[a.c]=!0);var u=l.h;for(r in u)l=[r,": var(",i,"_-_",r],(a=o&&o[r])&&l.push(",",a.replace(R,"")),l.push(")"),R.test(u[r])&&l.push(" !important"),c.push(l.join(""))}t=""+s+(r=c.join("; "))+t,x.lastIndex=n+r.length}return t}function B(e,t){t=t.split(";");for(var n,r,i,s={},o=0;o<t.length;o++)if((n=t[o])&&1<(i=n.split(":")).length){var a=e;r=n=i[0].trim(),i=i.slice(1).join(":");var c=N.exec(i);c&&(c[1]?(a.b||(a.b=document.createElement("meta"),a.b.setAttribute("apply-shim-measure",""),a.b.style.all="initial",document.head.appendChild(a.b)),r=window.getComputedStyle(a.b).getPropertyValue(r)):r="apply-shim-inherit",i=r),r=i,s[n]=r}return s}L.prototype.o=function(e){return e=x.test(e)||k.test(e),x.lastIndex=0,k.lastIndex=0,e},L.prototype.m=function(e,t){if(void 0===e.a){for(var n=[],r=e.content.querySelectorAll("style"),i=0;i<r.length;i++){var s=r[i];if(s.hasAttribute("shady-unscoped")){if(!v){var o=s.textContent;S.has(o)||(S.add(o),o=s.cloneNode(!0),document.head.appendChild(o)),s.parentNode.removeChild(s)}}else n.push(s.textContent),s.parentNode.removeChild(s)}(n=n.join("").trim())?((r=document.createElement("style")).textContent=n,e.content.insertBefore(r,e.content.firstChild),n=r):n=null,e.a=n}return(e=e.a)?this.j(e,t):null},L.prototype.j=function(e,t){t=void 0===t?"":t;var n=T(e);return this.l(n,t),e.textContent=P(n),n},L.prototype.f=function(e){var t=this,n=T(e);return C(n,function(e){":root"===e.selector&&(e.selector="html"),t.g(e)}),e.textContent=P(n),n},L.prototype.l=function(e,t){var n=this;this.c=t,C(e,function(e){n.g(e)}),this.c=null},L.prototype.g=function(e){e.cssText=function(e,t){return t=t.replace(k,function(t,n,r,i){return function(e,t,n,r,i){if(r&&function e(t,n){var r=t.indexOf("var(");if(-1===r)return n(t,"","","");e:{for(var i=0,s=r+3,o=t.length;s<o;s++)if("("===t[s])i++;else if(")"===t[s]&&0==--i)break e;s=-1}return i=t.substring(r+4,s),r=t.substring(0,r),t=e(t.substring(s+1),n),-1===(s=i.indexOf(","))?n(r,i.trim(),"",t):n(r,i.substring(0,s).trim(),i.substring(s+1).trim(),t)}(r,function(t,n){n&&e.a.get(n)&&(i="@apply "+n+";")}),!i)return t;var s=D(e,""+i),o=t.slice(0,t.indexOf("--")),a=s=B(e,s),c=e.a.get(n),l=c&&c.h;l?a=Object.assign(Object.create(l),s):e.a.set(n,a);var u,h=[],d=!1;for(u in a){var f=s[u];void 0===f&&(f="initial"),!l||u in l||(d=!0),h.push(n+"_-_"+u+": "+f)}return d&&function(e,t){if(M)for(var n in t.i)n!==e.c&&M(n)}(e,c),c&&(c.h=a),r&&(o=t+";"+o),""+o+h.join("; ")+";"}(e,t,n,r,i)}),D(e,t)}(this,e.parsedCssText),":root"===e.selector&&(e.selector=":host > *")},L.prototype.detectMixin=L.prototype.o,L.prototype.transformStyle=L.prototype.j,L.prototype.transformCustomStyle=L.prototype.f,L.prototype.transformRules=L.prototype.l,L.prototype.transformRule=L.prototype.g,L.prototype.transformTemplate=L.prototype.m,L.prototype._separator="_-_",Object.defineProperty(L.prototype,"invalidCallback",{get:function(){return M},set:function(e){M=e}});var z,U=null,q=window.HTMLImports&&window.HTMLImports.whenReady||null;var F=new L;function j(){var e=this;this.a=null,function(e){requestAnimationFrame(function(){q?q(e):(U||(U=new Promise(function(e){z=e}),"complete"===document.readyState?z():document.addEventListener("readystatechange",function(){"complete"===document.readyState&&z()})),U.then(function(){e&&e()}))})}(function(){H(e)}),F.invalidCallback=g}function H(e){e.a||(e.a=window.ShadyCSS.CustomStyleInterface,e.a&&(e.a.transformCallback=function(e){F.f(e)},e.a.validateCallback=function(){requestAnimationFrame(function(){e.a.enqueued&&W(e)})}))}function W(e){if(H(e),e.a){var t=e.a.processStyles();if(e.a.enqueued){for(var n=0;n<t.length;n++){var r=e.a.getStyleForCustomStyle(t[n]);r&&F.f(r)}e.a.enqueued=!1}}}if(j.prototype.prepareTemplate=function(t,n){H(this),e[n]=t,n=F.m(t,n),t._styleAst=n},j.prototype.styleSubtree=function(e,t){if(H(this),t)for(var n in t)null===n?e.style.removeProperty(n):e.style.setProperty(n,t[n]);if(e.shadowRoot)for(this.styleElement(e),e=e.shadowRoot.children||e.shadowRoot.childNodes,t=0;t<e.length;t++)this.styleSubtree(e[t]);else for(e=e.children||e.childNodes,t=0;t<e.length;t++)this.styleSubtree(e[t])},j.prototype.styleElement=function(t){H(this);var n,r=t.localName;n=r?-1<r.indexOf("-")?r:t.getAttribute&&t.getAttribute("is")||"":t.is,(r=e[n])&&!y(r)&&((y(r)||r._applyShimValidatingVersion!==r._applyShimNextVersion)&&(this.prepareTemplate(r,n),function(e){e._applyShimValidatingVersion=e._applyShimNextVersion,e.b||(e.b=!0,m.then(function(){e._applyShimCurrentVersion=e._applyShimNextVersion,e.b=!1}))}(r)),(t=t.shadowRoot)&&(t=t.querySelector("style"))&&(t.__cssRules=r._styleAst,t.textContent=P(r._styleAst)))},j.prototype.styleDocument=function(e){H(this),this.styleSubtree(document.body,e)},!window.ShadyCSS||!window.ShadyCSS.ScopingShim){var V=new j,G=window.ShadyCSS&&window.ShadyCSS.CustomStyleInterface;window.ShadyCSS={prepareTemplate:function(e,t){W(V),V.prepareTemplate(e,t)},styleSubtree:function(e,t){W(V),V.styleSubtree(e,t)},styleElement:function(e){W(V),V.styleElement(e)},styleDocument:function(e){W(V),V.styleDocument(e)},getComputedStyleValue:function(e,t){return(e=window.getComputedStyle(e).getPropertyValue(t))?e.trim():""},nativeCss:E,nativeShadow:v},G&&(window.ShadyCSS.CustomStyleInterface=G)}window.ShadyCSS.ApplyShim=F}).call(this),function(){var e,t=!(window.ShadyDOM&&window.ShadyDOM.inUse);function n(n){e=(!n||!n.shimcssproperties)&&(t||!(navigator.userAgent.match(/AppleWebKit\/601|Edge\/15/)||!window.CSS||!CSS.supports||!CSS.supports("box-shadow","0 0 0 var(--foo)")))}window.ShadyCSS&&void 0!==window.ShadyCSS.nativeCss?e=window.ShadyCSS.nativeCss:window.ShadyCSS?(n(window.ShadyCSS),window.ShadyCSS=void 0):n(window.WebComponents&&window.WebComponents.flags);var r=e;function i(e,t){for(var n in t)null===n?e.style.removeProperty(n):e.style.setProperty(n,t[n])}var s,o=null,a=window.HTMLImports&&window.HTMLImports.whenReady||null;var c=null,l=null;function u(){this.customStyles=[],this.enqueued=!1}function h(e){!e.enqueued&&l&&(e.enqueued=!0,function(){var e=l;requestAnimationFrame(function(){a?a(e):(o||(o=new Promise(function(e){s=e}),"complete"===document.readyState?s():document.addEventListener("readystatechange",function(){"complete"===document.readyState&&s()})),o.then(function(){e&&e()}))})}())}u.prototype.c=function(e){e.__seenByShadyCSS||(e.__seenByShadyCSS=!0,this.customStyles.push(e),h(this))},u.prototype.b=function(e){return e.__shadyCSSCachedStyle?e.__shadyCSSCachedStyle:e.getStyle?e.getStyle():e},u.prototype.a=function(){for(var e=this.customStyles,t=0;t<e.length;t++){var n=e[t];if(!n.__shadyCSSCachedStyle){var r=this.b(n);r&&(r=r.__appliedElement||r,c&&c(r),n.__shadyCSSCachedStyle=r)}}return e},u.prototype.addCustomStyle=u.prototype.c,u.prototype.getStyleForCustomStyle=u.prototype.b,u.prototype.processStyles=u.prototype.a,Object.defineProperties(u.prototype,{transformCallback:{get:function(){return c},set:function(e){c=e}},validateCallback:{get:function(){return l},set:function(e){var t=!1;l||(t=!0),l=e,t&&h(this)}}});var d=new u;window.ShadyCSS||(window.ShadyCSS={prepareTemplate:function(){},styleSubtree:function(e,t){d.a(),i(e,t)},styleElement:function(){d.a()},styleDocument:function(e){d.a(),i(document.body,e)},getComputedStyleValue:function(e,t){return(e=window.getComputedStyle(e).getPropertyValue(t))?e.trim():""},nativeCss:r,nativeShadow:t}),window.ShadyCSS.CustomStyleInterface=d}.call(this),function(){"use strict";const e=window.Polymer;window.Polymer=function(e){return window.Polymer._polymerFn(e)},e&&Object.assign(Polymer,e),window.Polymer._polymerFn=function(e){throw new Error("Load polymer.html to use the Polymer() function.")},window.Polymer.version="2.6.0",window.JSCompiler_renameProperty=function(e,t){return e}}(),function(){"use strict";let e,t,n=/(url\()([^)]*)(\))/g,r=/(^\/)|(^#)|(^[\w-\d]*:)/;function i(n,i){if(n&&r.test(n))return n;if(void 0===e){e=!1;try{const t=new URL("b","http://a");t.pathname="c%20d",e="http://a/c%20d"===t.href}catch(e){}}return i||(i=document.baseURI||window.location.href),e?new URL(n,i).href:(t||((t=document.implementation.createHTMLDocument("temp")).base=t.createElement("base"),t.head.appendChild(t.base),t.anchor=t.createElement("a"),t.body.appendChild(t.anchor)),t.base.href=i,t.anchor.href=n,t.anchor.href||n)}Polymer.ResolveUrl={resolveCss:function(e,t){return e.replace(n,function(e,n,r,s){return n+"'"+i(r.replace(/["']/g,""),t)+"'"+s})},resolveUrl:i,pathFromUrl:function(e){return e.substring(0,e.lastIndexOf("/")+1)}}}(),function(){"use strict";Polymer.Settings=Polymer.Settings||{},Polymer.Settings.useShadow=!window.ShadyDOM,Polymer.Settings.useNativeCSSProperties=Boolean(!window.ShadyCSS||window.ShadyCSS.nativeCss),Polymer.Settings.useNativeCustomElements=!window.customElements.polyfillWrapFlushCallback;let e=Polymer.rootPath||Polymer.ResolveUrl.pathFromUrl(document.baseURI||window.location.href);Polymer.rootPath=e,Polymer.setRootPath=function(e){Polymer.rootPath=e};let t=Polymer.sanitizeDOMValue;Polymer.sanitizeDOMValue=t,Polymer.setSanitizeDOMValue=function(e){Polymer.sanitizeDOMValue=e};Polymer.passiveTouchGestures=!1,Polymer.setPassiveTouchGestures=function(e){Polymer.passiveTouchGestures=e}}(),function(){"use strict";let e=0;function t(){}t.prototype.__mixinApplications,t.prototype.__mixinSet,Polymer.dedupingMixin=function(t){let n=t.__mixinApplications;n||(n=new WeakMap,t.__mixinApplications=n);let r=e++;return function(e){let i=e.__mixinSet;if(i&&i[r])return e;let s=n,o=s.get(e);o||(o=t(e),s.set(e,o));let a=Object.create(o.__mixinSet||i||null);return a[r]=!0,o.__mixinSet=a,o}}}(),function(){"use strict";function e(e){const t=customElements.get("dom-module");return t?t.import(e):null}function t(e){let t=e.body?e.body:e;const n=Polymer.ResolveUrl.resolveCss(t.textContent,e.baseURI),r=document.createElement("style");return r.textContent=n,r}const n={stylesFromModules(e){const t=e.trim().split(/\s+/),n=[];for(let e=0;e<t.length;e++)n.push(...this.stylesFromModule(t[e]));return n},stylesFromModule(t){const n=e(t);if(!n)return console.warn("Could not find style data in module named",t),[];if(void 0===n._styles){const e=[];e.push(...this._stylesFromModuleImports(n));const t=n.querySelector("template");t&&e.push(...this.stylesFromTemplate(t,n.assetpath)),n._styles=e}return n._styles},stylesFromTemplate(e,t){if(!e._styles){const n=[],r=e.content.querySelectorAll("style");for(let e=0;e<r.length;e++){let i=r[e],s=i.getAttribute("include");s&&n.push(...this.stylesFromModules(s).filter(function(e,t,n){return n.indexOf(e)===t})),t&&(i.textContent=Polymer.ResolveUrl.resolveCss(i.textContent,t)),n.push(i)}e._styles=n}return e._styles},stylesFromModuleImports(t){let n=e(t);return n?this._stylesFromModuleImports(n):[]},_stylesFromModuleImports(e){const n=[],r=e.querySelectorAll("link[rel=import][type~=css]");for(let e=0;e<r.length;e++){let i=r[e];if(i.import){const e=i.import,r=i.hasAttribute("shady-unscoped");if(r&&!e._unscopedStyle){const n=t(e);n.setAttribute("shady-unscoped",""),e._unscopedStyle=n}else e._style||(e._style=t(e));n.push(r?e._unscopedStyle:e._style)}}return n},cssFromModules(e){let t=e.trim().split(/\s+/),n="";for(let e=0;e<t.length;e++)n+=this.cssFromModule(t[e]);return n},cssFromModule(t){let n=e(t);if(n&&void 0===n._cssText){let e=this._cssFromModuleImports(n),t=n.querySelector("template");t&&(e+=this.cssFromTemplate(t,n.assetpath)),n._cssText=e||null}return n||console.warn("Could not find style data in module named",t),n&&n._cssText||""},cssFromTemplate(e,t){let n="";const r=this.stylesFromTemplate(e,t);for(let e=0;e<r.length;e++){let t=r[e];t.parentNode&&t.parentNode.removeChild(t),n+=t.textContent}return n},cssFromModuleImports(t){let n=e(t);return n?this._cssFromModuleImports(n):""},_cssFromModuleImports(e){let t="",n=this._stylesFromModuleImports(e);for(let e=0;e<n.length;e++)t+=n[e].textContent;return t}};Polymer.StyleGather=n}(),function(){"use strict";let e={},t={};class n extends HTMLElement{static get observedAttributes(){return["id"]}static import(n,r){if(n){let i=function(n){return e[n]||t[n.toLowerCase()]}(n);return i&&r?i.querySelector(r):i}return null}attributeChangedCallback(e,t,n){t!==n&&this.register()}get assetpath(){if(!this.__assetpath){const e=window.HTMLImports&&HTMLImports.importForElement?HTMLImports.importForElement(this)||document:this.ownerDocument,t=Polymer.ResolveUrl.resolveUrl(this.getAttribute("assetpath")||"",e.baseURI);this.__assetpath=Polymer.ResolveUrl.pathFromUrl(t)}return this.__assetpath}register(n){var r;(n=n||this.id)&&(this.id=n,e[n]=this,t[n.toLowerCase()]=this,(r=this).querySelector("style")&&console.warn("dom-module %s has style outside template",r.id))}}n.prototype.modules=e,customElements.define("dom-module",n),Polymer.DomModule=n}(),function(){"use strict";const e={isPath:function(e){return e.indexOf(".")>=0},root:function(e){let t=e.indexOf(".");return-1===t?e:e.slice(0,t)},isAncestor:function(e,t){return 0===e.indexOf(t+".")},isDescendant:function(e,t){return 0===t.indexOf(e+".")},translate:function(e,t,n){return t+n.slice(e.length)},matches:function(e,t){return e===t||this.isAncestor(e,t)||this.isDescendant(e,t)},normalize:function(e){if(Array.isArray(e)){let t=[];for(let n=0;n<e.length;n++){let r=e[n].toString().split(".");for(let e=0;e<r.length;e++)t.push(r[e])}return t.join(".")}return e},split:function(e){return Array.isArray(e)?this.normalize(e).split("."):e.toString().split(".")},get:function(e,t,n){let r=e,i=this.split(t);for(let e=0;e<i.length;e++){if(!r)return;r=r[i[e]]}return n&&(n.path=i.join(".")),r},set:function(e,t,n){let r=e,i=this.split(t),s=i[i.length-1];if(i.length>1){for(let e=0;e<i.length-1;e++){if(!(r=r[i[e]]))return}r[s]=n}else r[t]=n;return i.join(".")}};e.isDeep=e.isPath,Polymer.Path=e}(),function(){"use strict";const e={},t=/-[a-z]/g,n=/([A-Z])/g,r={dashToCamelCase:n=>e[n]||(e[n]=n.indexOf("-")<0?n:n.replace(t,e=>e[1].toUpperCase())),camelToDashCase:t=>e[t]||(e[t]=t.replace(n,"-$1").toLowerCase())};Polymer.CaseMap=r}(),function(){"use strict";let e=0,t=0,n=[],r=0,i=document.createTextNode("");new window.MutationObserver(function(){const e=n.length;for(let t=0;t<e;t++){let e=n[t];if(e)try{e()}catch(e){setTimeout(()=>{throw e})}}n.splice(0,e),t+=e}).observe(i,{characterData:!0}),Polymer.Async={timeOut:{after:e=>({run:t=>window.setTimeout(t,e),cancel(e){window.clearTimeout(e)}}),run:(e,t)=>window.setTimeout(e,t),cancel(e){window.clearTimeout(e)}},animationFrame:{run:e=>window.requestAnimationFrame(e),cancel(e){window.cancelAnimationFrame(e)}},idlePeriod:{run:e=>window.requestIdleCallback?window.requestIdleCallback(e):window.setTimeout(e,16),cancel(e){window.cancelIdleCallback?window.cancelIdleCallback(e):window.clearTimeout(e)}},microTask:{run:t=>(i.textContent=r++,n.push(t),e++),cancel(e){const r=e-t;if(r>=0){if(!n[r])throw new Error("invalid async handle: "+e);n[r]=null}}}}}(),function(){"use strict";const e=Polymer.Async.microTask;Polymer.PropertiesChanged=Polymer.dedupingMixin(t=>{return class extends t{static createProperties(e){const t=this.prototype;for(let n in e)n in t||t._createPropertyAccessor(n)}static attributeNameForProperty(e){return e.toLowerCase()}static typeForProperty(e){}_createPropertyAccessor(e,t){this._addPropertyToAttributeMap(e),this.hasOwnProperty("__dataHasAccessor")||(this.__dataHasAccessor=Object.assign({},this.__dataHasAccessor)),this.__dataHasAccessor[e]||(this.__dataHasAccessor[e]=!0,this._definePropertyAccessor(e,t))}_addPropertyToAttributeMap(e){if(this.hasOwnProperty("__dataAttributes")||(this.__dataAttributes=Object.assign({},this.__dataAttributes)),!this.__dataAttributes[e]){const t=this.constructor.attributeNameForProperty(e);this.__dataAttributes[t]=e}}_definePropertyAccessor(e,t){Object.defineProperty(this,e,{get(){return this._getProperty(e)},set:t?function(){}:function(t){this._setProperty(e,t)}})}constructor(){super(),this.__dataEnabled=!1,this.__dataReady=!1,this.__dataInvalid=!1,this.__data={},this.__dataPending=null,this.__dataOld=null,this.__dataInstanceProps=null,this.__serializing=!1,this._initializeProperties()}ready(){this.__dataReady=!0,this._flushProperties()}_initializeProperties(){for(let e in this.__dataHasAccessor)this.hasOwnProperty(e)&&(this.__dataInstanceProps=this.__dataInstanceProps||{},this.__dataInstanceProps[e]=this[e],delete this[e])}_initializeInstanceProperties(e){Object.assign(this,e)}_setProperty(e,t){this._setPendingProperty(e,t)&&this._invalidateProperties()}_getProperty(e){return this.__data[e]}_setPendingProperty(e,t,n){let r=this.__data[e],i=this._shouldPropertyChange(e,t,r);return i&&(this.__dataPending||(this.__dataPending={},this.__dataOld={}),!this.__dataOld||e in this.__dataOld||(this.__dataOld[e]=r),this.__data[e]=t,this.__dataPending[e]=t),i}_invalidateProperties(){!this.__dataInvalid&&this.__dataReady&&(this.__dataInvalid=!0,e.run(()=>{this.__dataInvalid&&(this.__dataInvalid=!1,this._flushProperties())}))}_enableProperties(){this.__dataEnabled||(this.__dataEnabled=!0,this.__dataInstanceProps&&(this._initializeInstanceProperties(this.__dataInstanceProps),this.__dataInstanceProps=null),this.ready())}_flushProperties(){const e=this.__data,t=this.__dataPending,n=this.__dataOld;this._shouldPropertiesChange(e,t,n)&&(this.__dataPending=null,this.__dataOld=null,this._propertiesChanged(e,t,n))}_shouldPropertiesChange(e,t,n){return Boolean(t)}_propertiesChanged(e,t,n){}_shouldPropertyChange(e,t,n){return n!==t&&(n==n||t==t)}attributeChangedCallback(e,t,n){t!==n&&this._attributeToProperty(e,n),super.attributeChangedCallback&&super.attributeChangedCallback(e,t,n)}_attributeToProperty(e,t,n){if(!this.__serializing){const r=this.__dataAttributes,i=r&&r[e]||e;this[i]=this._deserializeValue(t,n||this.constructor.typeForProperty(i))}}_propertyToAttribute(e,t,n){this.__serializing=!0,n=arguments.length<3?this[e]:n,this._valueToNodeAttribute(this,n,t||this.constructor.attributeNameForProperty(e)),this.__serializing=!1}_valueToNodeAttribute(e,t,n){const r=this._serializeValue(t);void 0===r?e.removeAttribute(n):e.setAttribute(n,r)}_serializeValue(e){switch(typeof e){case"boolean":return e?"":void 0;default:return null!=e?e.toString():void 0}}_deserializeValue(e,t){switch(t){case Boolean:return null!==e;case Number:return Number(e);default:return e}}}})}(),function(){"use strict";let e=Polymer.CaseMap;const t={};let n=HTMLElement.prototype;for(;n;){let e=Object.getOwnPropertyNames(n);for(let n=0;n<e.length;n++)t[e[n]]=!0;n=Object.getPrototypeOf(n)}Polymer.PropertyAccessors=Polymer.dedupingMixin(n=>{const r=Polymer.PropertiesChanged(n);return class extends r{static createPropertiesForAttributes(){let t=this.observedAttributes;for(let n=0;n<t.length;n++)this.prototype._createPropertyAccessor(e.dashToCamelCase(t[n]))}static attributeNameForProperty(t){return e.camelToDashCase(t)}_initializeProperties(){this.__dataProto&&(this._initializeProtoProperties(this.__dataProto),this.__dataProto=null),super._initializeProperties()}_initializeProtoProperties(e){for(let t in e)this._setProperty(t,e[t])}_ensureAttribute(e,t){const n=this;n.hasAttribute(e)||this._valueToNodeAttribute(n,t,e)}_serializeValue(e){switch(typeof e){case"object":if(e instanceof Date)return e.toString();if(e)try{return JSON.stringify(e)}catch(e){return""}default:return super._serializeValue(e)}}_deserializeValue(e,t){let n;switch(t){case Object:try{n=JSON.parse(e)}catch(t){n=e}break;case Array:try{n=JSON.parse(e)}catch(t){n=null,console.warn(`Polymer::Attributes: couldn't decode Array as JSON: ${e}`)}break;case Date:n=isNaN(e)?String(e):Number(e),n=new Date(n);break;default:n=super._deserializeValue(e,t)}return n}_definePropertyAccessor(e,n){!function(e,n){if(!t[n]){let t=e[n];void 0!==t&&(e.__data?e._setPendingProperty(n,t):(e.__dataProto?e.hasOwnProperty(JSCompiler_renameProperty("__dataProto",e))||(e.__dataProto=Object.create(e.__dataProto)):e.__dataProto={},e.__dataProto[n]=t))}}(this,e),super._definePropertyAccessor(e,n)}_hasAccessor(e){return this.__dataHasAccessor&&this.__dataHasAccessor[e]}_isPropertyPending(e){return Boolean(this.__dataPending&&e in this.__dataPending)}}})}(),function(){"use strict";const e={"dom-if":!0,"dom-repeat":!0};function t(t){let n=t.getAttribute("is");if(n&&e[n]){let e=t;for(e.removeAttribute("is"),t=e.ownerDocument.createElement(n),e.parentNode.replaceChild(t,e),t.appendChild(e);e.attributes.length;)t.setAttribute(e.attributes[0].name,e.attributes[0].value),e.removeAttribute(e.attributes[0].name)}return t}function n(e,t){let r=t.parentInfo&&n(e,t.parentInfo);if(!r)return e;for(let e=r.firstChild,n=0;e;e=e.nextSibling)if(t.parentIndex===n++)return e}function r(e,t,n,r){r.id&&(t[r.id]=n)}function i(e,t,n){if(n.events&&n.events.length)for(let r,i=0,s=n.events;i<s.length&&(r=s[i]);i++)e._addMethodEventListenerToNode(t,r.name,r.value,e)}function s(e,t,n){n.templateInfo&&(t._templateInfo=n.templateInfo)}Polymer.TemplateStamp=Polymer.dedupingMixin(e=>{return class extends e{static _parseTemplate(e,t){if(!e._templateInfo){let n=e._templateInfo={};n.nodeInfoList=[],n.stripWhiteSpace=t&&t.stripWhiteSpace||e.hasAttribute("strip-whitespace"),this._parseTemplateContent(e,n,{parent:null})}return e._templateInfo}static _parseTemplateContent(e,t,n){return this._parseTemplateNode(e.content,t,n)}static _parseTemplateNode(e,t,n){let r,i=e;return"template"!=i.localName||i.hasAttribute("preserve-content")?"slot"===i.localName&&(t.hasInsertionPoint=!0):r=this._parseTemplateNestedTemplate(i,t,n)||r,i.firstChild&&(r=this._parseTemplateChildNodes(i,t,n)||r),i.hasAttributes&&i.hasAttributes()&&(r=this._parseTemplateNodeAttributes(i,t,n)||r),r}static _parseTemplateChildNodes(e,n,r){if("script"!==e.localName&&"style"!==e.localName)for(let i,s=e.firstChild,o=0;s;s=i){if("template"==s.localName&&(s=t(s)),i=s.nextSibling,s.nodeType===Node.TEXT_NODE){let t=i;for(;t&&t.nodeType===Node.TEXT_NODE;)s.textContent+=t.textContent,i=t.nextSibling,e.removeChild(t),t=i;if(n.stripWhiteSpace&&!s.textContent.trim()){e.removeChild(s);continue}}let a={parentIndex:o,parentInfo:r};this._parseTemplateNode(s,n,a)&&(a.infoIndex=n.nodeInfoList.push(a)-1),s.parentNode&&o++}}static _parseTemplateNestedTemplate(e,t,n){let r=this._parseTemplate(e,t);return(r.content=e.content.ownerDocument.createDocumentFragment()).appendChild(e.content),n.templateInfo=r,!0}static _parseTemplateNodeAttributes(e,t,n){let r=!1,i=Array.from(e.attributes);for(let s,o=i.length-1;s=i[o];o--)r=this._parseTemplateNodeAttribute(e,t,n,s.name,s.value)||r;return r}static _parseTemplateNodeAttribute(e,t,n,r,i){return"on-"===r.slice(0,3)?(e.removeAttribute(r),n.events=n.events||[],n.events.push({name:r.slice(3),value:i}),!0):"id"===r&&(n.id=i,!0)}static _contentForTemplate(e){let t=e._templateInfo;return t&&t.content||e.content}_stampTemplate(e){e&&!e.content&&window.HTMLTemplateElement&&HTMLTemplateElement.decorate&&HTMLTemplateElement.decorate(e);let t=this.constructor._parseTemplate(e),o=t.nodeInfoList,a=t.content||e.content,c=document.importNode(a,!0);c.__noInsertionPoint=!t.hasInsertionPoint;let l=c.nodeList=new Array(o.length);c.$={};for(let e,t=0,a=o.length;t<a&&(e=o[t]);t++){let o=l[t]=n(c,e);r(0,c.$,o,e),s(0,o,e),i(this,o,e)}return c=c}_addMethodEventListenerToNode(e,t,n,r){let i=function(e,t,n){return e=e._methodHost||e,function(t){e[n]?e[n](t,t.detail):console.warn("listener method `"+n+"` not defined")}}(r=r||e,0,n);return this._addEventListenerToNode(e,t,i),i}_addEventListenerToNode(e,t,n){e.addEventListener(t,n)}_removeEventListenerFromNode(e,t,n){e.removeEventListener(t,n)}}})}(),function(){"use strict";const e=Polymer.CaseMap;let t=0;const n={COMPUTE:"__computeEffects",REFLECT:"__reflectEffects",NOTIFY:"__notifyEffects",PROPAGATE:"__propagateEffects",OBSERVE:"__observeEffects",READ_ONLY:"__readOnly"},r=/[A-Z]/;let i;function s(e,t){let n=e[t];if(n){if(!e.hasOwnProperty(t)){n=e[t]=Object.create(e[t]);for(let e in n){let t=n[e],r=n[e]=Array(t.length);for(let e=0;e<t.length;e++)r[e]=t[e]}}}else n=e[t]={};return n}function o(e,n,r,i,s,o){if(n){let c=!1,l=t++;for(let t in r)a(e,n,l,t,r,i,s,o)&&(c=!0);return c}return!1}function a(e,t,n,r,i,s,o,a){let l=!1,u=t[o?Polymer.Path.root(r):r];if(u)for(let t,h=0,d=u.length;h<d&&(t=u[h]);h++)t.info&&t.info.lastRun===n||o&&!c(r,t.trigger)||(t.info&&(t.info.lastRun=n),t.fn(e,r,i,s,t.info,o,a),l=!0);return l}function c(e,t){if(t){let n=t.name;return n==e||t.structured&&Polymer.Path.isAncestor(n,e)||t.wildcard&&Polymer.Path.isDescendant(n,e)}return!0}function l(e,t,n,r,i){let s="string"==typeof i.method?e[i.method]:i.method,o=i.property;s?s.call(e,e.__data[o],r[o]):i.dynamicFn||console.warn("observer method `"+i.method+"` not defined")}function u(e,t,n){let r=Polymer.Path.root(t);if(r!==t){return h(e,Polymer.CaseMap.camelToDashCase(r)+"-changed",n[t],t),!0}return!1}function h(e,t,n,r){let i={value:n,queueProperty:!0};r&&(i.path=r),e.dispatchEvent(new CustomEvent(t,{detail:i}))}function d(e,t,n,r,i,s){let o=(s?Polymer.Path.root(t):t)!=t?t:null,a=o?Polymer.Path.get(e,o):e.__data[t];o&&void 0===a&&(a=n[t]),h(e,i.eventName,a,o)}function f(e,t,n,r,i){let s=e.__data[t];Polymer.sanitizeDOMValue&&(s=Polymer.sanitizeDOMValue(s,i.attrName,"attribute",e)),e._propertyToAttribute(t,i.attrName,s)}function _(e,t,n,r,i){let s=w(e,t,n,r,i),o=i.methodInfo;e.__dataHasAccessor&&e.__dataHasAccessor[o]?e._setPendingProperty(o,s,!0):e[o]=s}function p(t,n,r,i,s,o,a){r.bindings=r.bindings||[];let c={kind:i,target:s,parts:o,literal:a,isCompound:1!==o.length};if(r.bindings.push(c),function(e){return Boolean(e.target)&&"attribute"!=e.kind&&"text"!=e.kind&&!e.isCompound&&"{"===e.parts[0].mode}(c)){let{event:t,negate:n}=c.parts[0];c.listenerEvent=t||e.camelToDashCase(s)+"-changed",c.listenerNegate=n}let l=n.nodeInfoList.length;for(let e=0;e<c.parts.length;e++){let r=c.parts[e];r.compoundIndex=e,m(t,n,c,r,l)}}function m(e,t,n,r,i){if(!r.literal)if("attribute"===n.kind&&"-"===n.target[0])console.warn("Cannot set attribute "+n.target+' because "-" is not a valid attribute starting character');else{let s=r.dependencies,o={index:i,binding:n,part:r,evaluator:e};for(let n=0;n<s.length;n++){let r=s[n];"string"==typeof r&&((r=S(r)).wildcard=!0),e._addTemplatePropertyEffect(t,r.rootProperty,{fn:g,info:o,trigger:r})}}}function g(e,t,r,i,s,o,a){let c=a[s.index],l=s.binding,u=s.part;if(o&&u.source&&t.length>u.source.length&&"property"==l.kind&&!l.isCompound&&c.__isPropertyEffectsClient&&c.__dataHasAccessor&&c.__dataHasAccessor[l.target]){let n=r[t];t=Polymer.Path.translate(u.source,l.target,t),c._setPendingPropertyOrPath(t,n,!1,!0)&&e._enqueueClient(c)}else{!function(e,t,r,i,s){s=function(e,t,n,r){if(n.isCompound){let i=e.__dataCompoundStorage[n.target];i[r.compoundIndex]=t,t=i.join("")}return"attribute"!==n.kind&&("textContent"!==n.target&&("value"!==n.target||"input"!==e.localName&&"textarea"!==e.localName)||(t=null==t?"":t)),t}(t,s,r,i),Polymer.sanitizeDOMValue&&(s=Polymer.sanitizeDOMValue(s,r.target,r.kind,t));if("attribute"==r.kind)e._valueToNodeAttribute(t,s,r.target);else{let i=r.target;t.__isPropertyEffectsClient&&t.__dataHasAccessor&&t.__dataHasAccessor[i]?t[n.READ_ONLY]&&t[n.READ_ONLY][i]||t._setPendingProperty(i,s)&&e._enqueueClient(t):e._setUnmanagedPropertyToNode(t,i,s)}}(e,c,l,u,s.evaluator._evaluateBinding(e,u,t,r,i,o))}}function y(e,t){if(t.isCompound){let n=e.__dataCompoundStorage||(e.__dataCompoundStorage={}),r=t.parts,i=new Array(r.length);for(let e=0;e<r.length;e++)i[e]=r[e].literal;let s=t.target;n[s]=i,t.literal&&"property"==t.kind&&(e[s]=t.literal)}}function b(e,t,r){if(r.listenerEvent){let i=r.parts[0];e.addEventListener(r.listenerEvent,function(e){!function(e,t,r,i,s){let o,a=e.detail,c=a&&a.path;c?(i=Polymer.Path.translate(r,i,c),o=a&&a.value):o=e.target[r],o=s?!o:o,t[n.READ_ONLY]&&t[n.READ_ONLY][i]||!t._setPendingPropertyOrPath(i,o,!0,Boolean(c))||a&&a.queueProperty||t._invalidateProperties()}(e,t,r.target,i.source,i.negate)})}}function v(e,t,n,r,i,s){s=t.static||s&&("object"!=typeof s||s[t.methodName]);let o={methodName:t.methodName,args:t.args,methodInfo:i,dynamicFn:s};for(let i,s=0;s<t.args.length&&(i=t.args[s]);s++)i.literal||e._addPropertyEffect(i.rootProperty,n,{fn:r,info:o,trigger:i});s&&e._addPropertyEffect(t.methodName,n,{fn:r,info:o})}function w(e,t,n,r,i){let s=e._methodHost||e,o=s[i.methodName];if(o){let r=function(e,t,n,r){let i=[];for(let s=0,o=t.length;s<o;s++){let o,a=t[s],c=a.name;if(a.literal?o=a.value:a.structured?void 0===(o=Polymer.Path.get(e,c))&&(o=r[c]):o=e[c],a.wildcard){let e=0===c.indexOf(n+"."),t=0===n.indexOf(c)&&!e;i[s]={path:t?n:c,value:t?r[n]:o,base:o}}else i[s]=o}return i}(e.__data,i.args,t,n);return o.apply(s,r)}i.dynamicFn||console.warn("method `"+i.methodName+"` not defined")}const E=[],k=new RegExp("(\\[\\[|{{)\\s*(?:(!)\\s*)?((?:[a-zA-Z_$][\\w.:$\\-*]*)\\s*(?:\\(\\s*(?:(?:(?:((?:[a-zA-Z_$][\\w.:$\\-*]*)|(?:[-+]?[0-9]*\\.?[0-9]+(?:[eE][-+]?[0-9]+)?)|(?:(?:'(?:[^'\\\\]|\\\\.)*')|(?:\"(?:[^\"\\\\]|\\\\.)*\")))\\s*)(?:,\\s*(?:((?:[a-zA-Z_$][\\w.:$\\-*]*)|(?:[-+]?[0-9]*\\.?[0-9]+(?:[eE][-+]?[0-9]+)?)|(?:(?:'(?:[^'\\\\]|\\\\.)*')|(?:\"(?:[^\"\\\\]|\\\\.)*\")))\\s*))*)?)\\)\\s*)?)(?:]]|}})","g");function x(e){let t="";for(let n=0;n<e.length;n++){t+=e[n].literal||""}return t}function A(e){let t=e.match(/([^\s]+?)\(([\s\S]*)\)/);if(t){let e={methodName:t[1],static:!0,args:E};if(t[2].trim()){return function(e,t){return t.args=e.map(function(e){let n=S(e);return n.literal||(t.static=!1),n},this),t}(t[2].replace(/\\,/g,"&comma;").split(","),e)}return e}return null}function S(e){let t=e.trim().replace(/&comma;/g,",").replace(/\\(.)/g,"$1"),n={name:t,value:"",literal:!1},r=t[0];switch("-"===r&&(r=t[1]),r>="0"&&r<="9"&&(r="#"),r){case"'":case'"':n.value=t.slice(1,-1),n.literal=!0;break;case"#":n.value=Number(t),n.literal=!0}return n.literal||(n.rootProperty=Polymer.Path.root(t),n.structured=Polymer.Path.isPath(t),n.structured&&(n.wildcard=".*"==t.slice(-2),n.wildcard&&(n.name=t.slice(0,-2)))),n}function P(e,t,n,r){let i=n+".splices";e.notifyPath(i,{indexSplices:r}),e.notifyPath(n+".length",t.length),e.__data[i]={indexSplices:null}}function T(e,t,n,r,i,s){P(e,t,n,[{index:r,addedCount:i,removed:s,object:t,type:"splice"}])}Polymer.PropertyEffects=Polymer.dedupingMixin(c=>{const h=Polymer.TemplateStamp(Polymer.PropertyAccessors(c));class m extends h{constructor(){super(),this.__isPropertyEffectsClient=!0,this.__dataCounter=0,this.__dataClientsReady,this.__dataPendingClients,this.__dataToNotify,this.__dataLinkedPaths,this.__dataHasPaths,this.__dataCompoundStorage,this.__dataHost,this.__dataTemp,this.__dataClientsInitialized,this.__data,this.__dataPending,this.__dataOld,this.__computeEffects,this.__reflectEffects,this.__notifyEffects,this.__propagateEffects,this.__observeEffects,this.__readOnly,this.__templateInfo}get PROPERTY_EFFECT_TYPES(){return n}_initializeProperties(){super._initializeProperties(),C.registerHost(this),this.__dataClientsReady=!1,this.__dataPendingClients=null,this.__dataToNotify=null,this.__dataLinkedPaths=null,this.__dataHasPaths=!1,this.__dataCompoundStorage=this.__dataCompoundStorage||null,this.__dataHost=this.__dataHost||null,this.__dataTemp={},this.__dataClientsInitialized=!1}_initializeProtoProperties(e){this.__data=Object.create(e),this.__dataPending=Object.create(e),this.__dataOld={}}_initializeInstanceProperties(e){let t=this[n.READ_ONLY];for(let n in e)t&&t[n]||(this.__dataPending=this.__dataPending||{},this.__dataOld=this.__dataOld||{},this.__data[n]=this.__dataPending[n]=e[n])}_addPropertyEffect(e,t,r){this._createPropertyAccessor(e,t==n.READ_ONLY);let i=s(this,t)[e];i||(i=this[t][e]=[]),i.push(r)}_removePropertyEffect(e,t,n){let r=s(this,t)[e],i=r.indexOf(n);i>=0&&r.splice(i,1)}_hasPropertyEffect(e,t){let n=this[t];return Boolean(n&&n[e])}_hasReadOnlyEffect(e){return this._hasPropertyEffect(e,n.READ_ONLY)}_hasNotifyEffect(e){return this._hasPropertyEffect(e,n.NOTIFY)}_hasReflectEffect(e){return this._hasPropertyEffect(e,n.REFLECT)}_hasComputedEffect(e){return this._hasPropertyEffect(e,n.COMPUTE)}_setPendingPropertyOrPath(e,t,n,r){if(r||Polymer.Path.root(Array.isArray(e)?e[0]:e)!==e){if(!r){let n=Polymer.Path.get(this,e);if(!(e=Polymer.Path.set(this,e,t))||!super._shouldPropertyChange(e,t,n))return!1}if(this.__dataHasPaths=!0,this._setPendingProperty(e,t,n))return function(e,t,n){let r=e.__dataLinkedPaths;if(r){let i;for(let s in r){let o=r[s];Polymer.Path.isDescendant(s,t)?(i=Polymer.Path.translate(s,o,t),e._setPendingPropertyOrPath(i,n,!0,!0)):Polymer.Path.isDescendant(o,t)&&(i=Polymer.Path.translate(o,s,t),e._setPendingPropertyOrPath(i,n,!0,!0))}}}(this,e,t),!0}else{if(this.__dataHasAccessor&&this.__dataHasAccessor[e])return this._setPendingProperty(e,t,n);this[e]=t}return!1}_setUnmanagedPropertyToNode(e,t,n){n===e[t]&&"object"!=typeof n||(e[t]=n)}_setPendingProperty(e,t,r){let i=this.__dataHasPaths&&Polymer.Path.isPath(e),s=i?this.__dataTemp:this.__data;return!!this._shouldPropertyChange(e,t,s[e])&&(this.__dataPending||(this.__dataPending={},this.__dataOld={}),e in this.__dataOld||(this.__dataOld[e]=this.__data[e]),i?this.__dataTemp[e]=t:this.__data[e]=t,this.__dataPending[e]=t,(i||this[n.NOTIFY]&&this[n.NOTIFY][e])&&(this.__dataToNotify=this.__dataToNotify||{},this.__dataToNotify[e]=r),!0)}_setProperty(e,t){this._setPendingProperty(e,t,!0)&&this._invalidateProperties()}_invalidateProperties(){this.__dataReady&&this._flushProperties()}_enqueueClient(e){this.__dataPendingClients=this.__dataPendingClients||[],e!==this&&this.__dataPendingClients.push(e)}_flushProperties(){this.__dataCounter++,super._flushProperties(),this.__dataCounter--}_flushClients(){this.__dataClientsReady?this.__enableOrFlushClients():(this.__dataClientsReady=!0,this._readyClients(),this.__dataReady=!0)}__enableOrFlushClients(){let e=this.__dataPendingClients;if(e){this.__dataPendingClients=null;for(let t=0;t<e.length;t++){let n=e[t];n.__dataEnabled?n.__dataPending&&n._flushProperties():n._enableProperties()}}}_readyClients(){this.__enableOrFlushClients()}setProperties(e,t){for(let r in e)!t&&this[n.READ_ONLY]&&this[n.READ_ONLY][r]||this._setPendingPropertyOrPath(r,e[r],!0);this._invalidateProperties()}ready(){this._flushProperties(),this.__dataClientsReady||this._flushClients(),this.__dataPending&&this._flushProperties()}_propertiesChanged(e,r,i){let s=this.__dataHasPaths;this.__dataHasPaths=!1,function(e,t,r,i){let s=e[n.COMPUTE];if(s){let n=t;for(;o(e,s,n,r,i);)Object.assign(r,e.__dataOld),Object.assign(t,e.__dataPending),n=e.__dataPending,e.__dataPending=null}}(this,r,i,s);let c=this.__dataToNotify;this.__dataToNotify=null,this._propagatePropertyChanges(r,i,s),this._flushClients(),o(this,this[n.REFLECT],r,i,s),o(this,this[n.OBSERVE],r,i,s),c&&function(e,r,i,s,o){let c,l,h=e[n.NOTIFY],d=t++;for(let t in r)r[t]&&(h&&a(e,h,d,t,i,s,o)?c=!0:o&&u(e,t,i)&&(c=!0));c&&(l=e.__dataHost)&&l._invalidateProperties&&l._invalidateProperties()}(this,c,r,i,s),1==this.__dataCounter&&(this.__dataTemp={})}_propagatePropertyChanges(e,t,r){this[n.PROPAGATE]&&o(this,this[n.PROPAGATE],e,t,r);let i=this.__templateInfo;for(;i;)o(this,i.propertyEffects,e,t,r,i.nodeList),i=i.nextTemplateInfo}linkPaths(e,t){e=Polymer.Path.normalize(e),t=Polymer.Path.normalize(t),this.__dataLinkedPaths=this.__dataLinkedPaths||{},this.__dataLinkedPaths[e]=t}unlinkPaths(e){e=Polymer.Path.normalize(e),this.__dataLinkedPaths&&delete this.__dataLinkedPaths[e]}notifySplices(e,t){let n={path:""};P(this,Polymer.Path.get(this,e,n),n.path,t)}get(e,t){return Polymer.Path.get(t||this,e)}set(e,t,r){r?Polymer.Path.set(r,e,t):this[n.READ_ONLY]&&this[n.READ_ONLY][e]||this._setPendingPropertyOrPath(e,t,!0)&&this._invalidateProperties()}push(e,...t){let n={path:""},r=Polymer.Path.get(this,e,n),i=r.length,s=r.push(...t);return t.length&&T(this,r,n.path,i,t.length,[]),s}pop(e){let t={path:""},n=Polymer.Path.get(this,e,t),r=Boolean(n.length),i=n.pop();return r&&T(this,n,t.path,n.length,0,[i]),i}splice(e,t,n,...r){let i,s={path:""},o=Polymer.Path.get(this,e,s);return t<0?t=o.length-Math.floor(-t):t&&(t=Math.floor(t)),i=2===arguments.length?o.splice(t):o.splice(t,n,...r),(r.length||i.length)&&T(this,o,s.path,t,r.length,i),i}shift(e){let t={path:""},n=Polymer.Path.get(this,e,t),r=Boolean(n.length),i=n.shift();return r&&T(this,n,t.path,0,0,[i]),i}unshift(e,...t){let n={path:""},r=Polymer.Path.get(this,e,n),i=r.unshift(...t);return t.length&&T(this,r,n.path,0,t.length,[]),i}notifyPath(e,t){let n;if(1==arguments.length){let r={path:""};t=Polymer.Path.get(this,e,r),n=r.path}else n=Array.isArray(e)?Polymer.Path.normalize(e):e;this._setPendingPropertyOrPath(n,t,!0,!0)&&this._invalidateProperties()}_createReadOnlyProperty(e,t){var r;this._addPropertyEffect(e,n.READ_ONLY),t&&(this["_set"+(r=e,r[0].toUpperCase()+r.substring(1))]=function(t){this._setProperty(e,t)})}_createPropertyObserver(e,t,r){let i={property:e,method:t,dynamicFn:Boolean(r)};this._addPropertyEffect(e,n.OBSERVE,{fn:l,info:i,trigger:{name:e}}),r&&this._addPropertyEffect(t,n.OBSERVE,{fn:l,info:i,trigger:{name:t}})}_createMethodObserver(e,t){let r=A(e);if(!r)throw new Error("Malformed observer expression '"+e+"'");v(this,r,n.OBSERVE,w,null,t)}_createNotifyingProperty(t){this._addPropertyEffect(t,n.NOTIFY,{fn:d,info:{eventName:e.camelToDashCase(t)+"-changed",property:t}})}_createReflectedProperty(e){let t=this.constructor.attributeNameForProperty(e);"-"===t[0]?console.warn("Property "+e+" cannot be reflected to attribute "+t+' because "-" is not a valid starting attribute name. Use a lowercase first letter for the property instead.'):this._addPropertyEffect(e,n.REFLECT,{fn:f,info:{attrName:t}})}_createComputedProperty(e,t,r){let i=A(t);if(!i)throw new Error("Malformed computed expression '"+t+"'");v(this,i,n.COMPUTE,_,e,r)}static addPropertyEffect(e,t,n){this.prototype._addPropertyEffect(e,t,n)}static createPropertyObserver(e,t,n){this.prototype._createPropertyObserver(e,t,n)}static createMethodObserver(e,t){this.prototype._createMethodObserver(e,t)}static createNotifyingProperty(e){this.prototype._createNotifyingProperty(e)}static createReadOnlyProperty(e,t){this.prototype._createReadOnlyProperty(e,t)}static createReflectedProperty(e){this.prototype._createReflectedProperty(e)}static createComputedProperty(e,t,n){this.prototype._createComputedProperty(e,t,n)}static bindTemplate(e){return this.prototype._bindTemplate(e)}_bindTemplate(e,t){let n=this.constructor._parseTemplate(e),r=this.__templateInfo==n;if(!r)for(let e in n.propertyEffects)this._createPropertyAccessor(e);if(t&&((n=Object.create(n)).wasPreBound=r,!r&&this.__templateInfo)){let e=this.__templateInfoLast||this.__templateInfo;return this.__templateInfoLast=e.nextTemplateInfo=n,n.previousTemplateInfo=e,n}return this.__templateInfo=n}static _addTemplatePropertyEffect(e,t,n){(e.hostProps=e.hostProps||{})[t]=!0;let r=e.propertyEffects=e.propertyEffects||{};(r[t]=r[t]||[]).push(n)}_stampTemplate(e){C.beginHosting(this);let t=super._stampTemplate(e);C.endHosting(this);let n=this._bindTemplate(e,!0);if(n.nodeList=t.nodeList,!n.wasPreBound){let e=n.childNodes=[];for(let n=t.firstChild;n;n=n.nextSibling)e.push(n)}return t.templateInfo=n,function(e,t){let{nodeList:n,nodeInfoList:r}=t;if(r.length)for(let t=0;t<r.length;t++){let i=r[t],s=n[t],o=i.bindings;if(o)for(let t=0;t<o.length;t++){let n=o[t];y(s,n),b(s,e,n)}s.__dataHost=e}}(this,n),this.__dataReady&&o(this,n.propertyEffects,this.__data,null,!1,n.nodeList),t}_removeBoundDom(e){let t=e.templateInfo;t.previousTemplateInfo&&(t.previousTemplateInfo.nextTemplateInfo=t.nextTemplateInfo),t.nextTemplateInfo&&(t.nextTemplateInfo.previousTemplateInfo=t.previousTemplateInfo),this.__templateInfoLast==t&&(this.__templateInfoLast=t.previousTemplateInfo),t.previousTemplateInfo=t.nextTemplateInfo=null;let n=t.childNodes;for(let e=0;e<n.length;e++){let t=n[e];t.parentNode.removeChild(t)}}static _parseTemplateNode(e,t,n){let r=super._parseTemplateNode(e,t,n);if(e.nodeType===Node.TEXT_NODE){let i=this._parseBindings(e.textContent,t);i&&(e.textContent=x(i)||" ",p(this,t,n,"text","textContent",i),r=!0)}return r}static _parseTemplateNodeAttribute(e,t,n,i,s){let o=this._parseBindings(s,t);if(o){let s=i,a="property";r.test(i)?a="attribute":"$"==i[i.length-1]&&(i=i.slice(0,-1),a="attribute");let c=x(o);return c&&"attribute"==a&&e.setAttribute(i,c),"input"===e.localName&&"value"===s&&e.setAttribute(s,""),e.removeAttribute(s),"property"===a&&(i=Polymer.CaseMap.dashToCamelCase(i)),p(this,t,n,a,i,o,c),!0}return super._parseTemplateNodeAttribute(e,t,n,i,s)}static _parseTemplateNestedTemplate(e,t,n){let r=super._parseTemplateNestedTemplate(e,t,n),i=n.templateInfo.hostProps;for(let e in i){p(this,t,n,"property","_host_"+e,[{mode:"{",source:e,dependencies:[e]}])}return r}static _parseBindings(e,t){let n,r=[],i=0;for(;null!==(n=k.exec(e));){n.index>i&&r.push({literal:e.slice(i,n.index)});let s=n[1][0],o=Boolean(n[2]),a=n[3].trim(),c=!1,l="",u=-1;"{"==s&&(u=a.indexOf("::"))>0&&(l=a.substring(u+2),a=a.substring(0,u),c=!0);let h=A(a),d=[];if(h){let{args:e,methodName:n}=h;for(let t=0;t<e.length;t++){let n=e[t];n.literal||d.push(n)}let r=t.dynamicFns;(r&&r[n]||h.static)&&(d.push(n),h.dynamicFn=!0)}else d.push(a);r.push({source:a,mode:s,negate:o,customEvent:c,signature:h,dependencies:d,event:l}),i=k.lastIndex}if(i&&i<e.length){let t=e.substring(i);t&&r.push({literal:t})}return r.length?r:null}static _evaluateBinding(e,t,n,r,i,s){let o;return o=t.signature?w(e,n,r,0,t.signature):n!=t.source?Polymer.Path.get(e,t.source):s&&Polymer.Path.isPath(n)?Polymer.Path.get(e,n):e.__data[n],t.negate&&(o=!o),o}}return i=m,m});let C={stack:[],registerHost(e){if(this.stack.length){this.stack[this.stack.length-1]._enqueueClient(e)}},beginHosting(e){this.stack.push(e)},endHosting(e){let t=this.stack.length;t&&this.stack[t-1]==e&&this.stack.pop()}}}(),function(){"use strict";Polymer.PropertiesMixin=Polymer.dedupingMixin(e=>{const t=Polymer.PropertiesChanged(e);function n(e){const t=Object.getPrototypeOf(e);return t.prototype instanceof i?t:null}function r(e){if(!e.hasOwnProperty(JSCompiler_renameProperty("__ownProperties",e))){let t=null;e.hasOwnProperty(JSCompiler_renameProperty("properties",e))&&e.properties&&(t=function(e){const t={};for(let n in e){const r=e[n];t[n]="function"==typeof r?{type:r}:r}return t}(e.properties)),e.__ownProperties=t}return e.__ownProperties}class i extends t{static get observedAttributes(){const e=this._properties;return e?Object.keys(e).map(e=>this.attributeNameForProperty(e)):[]}static finalize(){if(!this.hasOwnProperty(JSCompiler_renameProperty("__finalized",this))){const e=n(this);e&&e.finalize(),this.__finalized=!0,this._finalizeClass()}}static _finalizeClass(){const e=r(this);e&&this.createProperties(e)}static get _properties(){if(!this.hasOwnProperty(JSCompiler_renameProperty("__properties",this))){const e=n(this);this.__properties=Object.assign({},e&&e._properties,r(this))}return this.__properties}static typeForProperty(e){const t=this._properties[e];return t&&t.type}_initializeProperties(){this.constructor.finalize(),super._initializeProperties()}connectedCallback(){super.connectedCallback&&super.connectedCallback(),this._enableProperties()}disconnectedCallback(){super.disconnectedCallback&&super.disconnectedCallback()}}return i})}(),function(){"use strict";Polymer.ElementMixin=Polymer.dedupingMixin(e=>{const t=Polymer.PropertiesMixin(Polymer.PropertyEffects(e));return class extends t{static _finalizeClass(){super._finalizeClass(),this.hasOwnProperty(JSCompiler_renameProperty("is",this))&&this.is&&Polymer.telemetry.register(this.prototype);const e=((t=this).hasOwnProperty(JSCompiler_renameProperty("__ownObservers",t))||(t.__ownObservers=t.hasOwnProperty(JSCompiler_renameProperty("observers",t))?t.observers:null),t.__ownObservers);var t;e&&this.createObservers(e,this._properties);let n=this.template;if(n)if("string"==typeof n){let e=document.createElement("template");e.innerHTML=n,n=e}else n=n.cloneNode(!0);this.prototype._template=n}static createProperties(e){for(let s in e)t=this.prototype,n=s,r=e[s],i=e,r.computed&&(r.readOnly=!0),r.computed&&!t._hasReadOnlyEffect(n)&&t._createComputedProperty(n,r.computed,i),r.readOnly&&!t._hasReadOnlyEffect(n)&&t._createReadOnlyProperty(n,!r.computed),r.reflectToAttribute&&!t._hasReflectEffect(n)&&t._createReflectedProperty(n),r.notify&&!t._hasNotifyEffect(n)&&t._createNotifyingProperty(n),r.observer&&t._createPropertyObserver(n,r.observer,i[r.observer]),t._addPropertyToAttributeMap(n);var t,n,r,i}static createObservers(e,t){const n=this.prototype;for(let r=0;r<e.length;r++)n._createMethodObserver(e[r],t)}static get template(){return this.hasOwnProperty(JSCompiler_renameProperty("_template",this))||(this._template=Polymer.DomModule&&Polymer.DomModule.import(this.is,"template")||Object.getPrototypeOf(this.prototype).constructor.template),this._template}static get importPath(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_importPath",this))){const e=Polymer.DomModule&&Polymer.DomModule.import(this.is);this._importPath=e?e.assetpath:Object.getPrototypeOf(this.prototype).constructor.importPath}return this._importPath}constructor(){super(),this._template,this._importPath,this.rootPath,this.importPath,this.root,this.$}_initializeProperties(){Polymer.telemetry.instanceCount++,this.constructor.finalize();const e=this.constructor.importPath;this.constructor._finalizeTemplate(this.localName),super._initializeProperties(),this.rootPath=Polymer.rootPath,this.importPath=e;let t=function(e){if(!e.hasOwnProperty(JSCompiler_renameProperty("__propertyDefaults",e))){e.__propertyDefaults=null;let t=e._properties;for(let n in t){let r=t[n];"value"in r&&(e.__propertyDefaults=e.__propertyDefaults||{},e.__propertyDefaults[n]=r)}}return e.__propertyDefaults}(this.constructor);if(t)for(let e in t){let n=t[e];if(!this.hasOwnProperty(e)){let t="function"==typeof n.value?n.value.call(this):n.value;this._hasAccessor(e)?this._setPendingProperty(e,t,!0):this[e]=t}}}static _processStyleText(e,t){return Polymer.ResolveUrl.resolveCss(e,t)}static _finalizeTemplate(e){const t=this.prototype._template;if(t&&!t.__polymerFinalized){t.__polymerFinalized=!0;const n=this.importPath;!function(e,t,n,r){const i=t.content.querySelectorAll("style"),s=Polymer.StyleGather.stylesFromTemplate(t),o=Polymer.StyleGather.stylesFromModuleImports(n),a=t.content.firstElementChild;for(let n=0;n<o.length;n++){let i=o[n];i.textContent=e._processStyleText(i.textContent,r),t.content.insertBefore(i,a)}let c=0;for(let t=0;t<s.length;t++){let n=s[t],o=i[c];o!==n?(n=n.cloneNode(!0),o.parentNode.insertBefore(n,o)):c++,n.textContent=e._processStyleText(n.textContent,r)}window.ShadyCSS&&window.ShadyCSS.prepareTemplate(t,n)}(this,t,e,n?Polymer.ResolveUrl.resolveUrl(n):""),this.prototype._bindTemplate(t)}}connectedCallback(){window.ShadyCSS&&this._template&&window.ShadyCSS.styleElement(this),super.connectedCallback()}ready(){this._template&&(this.root=this._stampTemplate(this._template),this.$=this.root.$),super.ready()}_readyClients(){this._template&&(this.root=this._attachDom(this.root)),super._readyClients()}_attachDom(e){if(this.attachShadow)return e?(this.shadowRoot||this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(e),this.shadowRoot):null;throw new Error("ShadowDOM not available. Polymer.Element can create dom as children instead of in ShadowDOM by setting `this.root = this;` before `ready`.")}updateStyles(e){window.ShadyCSS&&window.ShadyCSS.styleSubtree(this,e)}resolveUrl(e,t){return!t&&this.importPath&&(t=Polymer.ResolveUrl.resolveUrl(this.importPath)),Polymer.ResolveUrl.resolveUrl(e,t)}static _parseTemplateContent(e,t,n){return t.dynamicFns=t.dynamicFns||this._properties,super._parseTemplateContent(e,t,n)}}}),Polymer.telemetry={instanceCount:0,registrations:[],_regLog:function(e){console.log("["+e.is+"]: registered")},register:function(e){this.registrations.push(e),Polymer.log&&this._regLog(e)},dumpRegistrations:function(){this.registrations.forEach(this._regLog)}},Polymer.updateStyles=function(e){window.ShadyCSS&&window.ShadyCSS.styleDocument(e)}}(),function(){"use strict";class e{constructor(){this._asyncModule=null,this._callback=null,this._timer=null}setConfig(e,t){this._asyncModule=e,this._callback=t,this._timer=this._asyncModule.run(()=>{this._timer=null,this._callback()})}cancel(){this.isActive()&&(this._asyncModule.cancel(this._timer),this._timer=null)}flush(){this.isActive()&&(this.cancel(),this._callback())}isActive(){return null!=this._timer}static debounce(t,n,r){return t instanceof e?t.cancel():t=new e,t.setConfig(n,r),t}}Polymer.Debouncer=e}(),function(){"use strict";let e="string"==typeof document.head.style.touchAction,t="__polymerGesturesHandled",n="__polymerGesturesTouchAction",r=2500,i=["mousedown","mousemove","mouseup","click"],s=[0,1,4,2],o=function(){try{return 1===new MouseEvent("test",{buttons:1}).buttons}catch(e){return!1}}();function a(e){return i.indexOf(e)>-1}let c=!1;function l(t){if(!a(t)&&"touchend"!==t)return e&&c&&Polymer.passiveTouchGestures?{passive:!0}:void 0}!function(){try{let e=Object.defineProperty({},"passive",{get(){c=!0}});window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch(e){}}();let u=navigator.userAgent.match(/iP(?:[oa]d|hone)|Android/),h=function(){};h.prototype.reset,h.prototype.mousedown,h.prototype.mousemove,h.prototype.mouseup,h.prototype.touchstart,h.prototype.touchmove,h.prototype.touchend,h.prototype.click;const d=[],f={button:!0,input:!0,keygen:!0,meter:!0,output:!0,textarea:!0,progress:!0,select:!0};function _(e){let t=[...e.labels||[]];if(!t.length){t=[];let n=e.getRootNode();if(e.id){let r=n.querySelectorAll(`label[for = ${e.id}]`);for(let e=0;e<r.length;e++)t.push(r[e])}}return t}let p=function(e){let n=e.sourceCapabilities;var r;if((!n||n.firesTouchEvents)&&(e[t]={skip:!0},"click"===e.type)){let t=!1,n=e.composedPath&&e.composedPath();if(n)for(let e=0;e<n.length;e++){if(n[e].nodeType===Node.ELEMENT_NODE)if("label"===n[e].localName)d.push(n[e]);else if(r=n[e],f[r.localName]){let r=_(n[e]);for(let e=0;e<r.length;e++)t=t||d.indexOf(r[e])>-1}if(n[e]===y.mouse.target)return}if(t)return;e.preventDefault(),e.stopPropagation()}};function m(e){let t=u?["click"]:i;for(let n,r=0;r<t.length;r++)n=t[r],e?(d.length=0,document.addEventListener(n,p,!0)):document.removeEventListener(n,p,!0)}function g(e){let t=e.type;if(!a(t))return!1;if("mousemove"===t){let t=void 0===e.buttons?1:e.buttons;return e instanceof window.MouseEvent&&!o&&(t=s[e.which]||0),Boolean(1&t)}return 0===(void 0===e.button?0:e.button)}let y={mouse:{target:null,mouseIgnoreJob:null},touch:{x:0,y:0,id:-1,scrollDecided:!1}};function b(e,t,n){e.movefn=t,e.upfn=n,document.addEventListener("mousemove",t),document.addEventListener("mouseup",n)}function v(e){document.removeEventListener("mousemove",e.movefn),document.removeEventListener("mouseup",e.upfn),e.movefn=null,e.upfn=null}document.addEventListener("touchend",function(e){y.mouse.mouseIgnoreJob||m(!0),y.mouse.target=e.composedPath()[0],y.mouse.mouseIgnoreJob=Polymer.Debouncer.debounce(y.mouse.mouseIgnoreJob,Polymer.Async.timeOut.after(r),function(){m(),y.mouse.target=null,y.mouse.mouseIgnoreJob=null})},!!c&&{passive:!0});const w={gestures:{},recognizers:[],deepTargetFind:function(e,t){let n=document.elementFromPoint(e,t),r=n;for(;r&&r.shadowRoot&&!window.ShadyDOM;){if(r===(r=r.shadowRoot.elementFromPoint(e,t)))break;r&&(n=r)}return n},_findOriginalTarget:function(e){if(e.composedPath){const t=e.composedPath();return t.length>0?t[0]:e.target}return e.target},_handleNative:function(n){let r,i=n.type,s=n.currentTarget.__polymerGestures;if(!s)return;let o=s[i];if(o){if(!n[t]&&(n[t]={},"touch"===i.slice(0,5))){let t=(n=n).changedTouches[0];if("touchstart"===i&&1===n.touches.length&&(y.touch.id=t.identifier),y.touch.id!==t.identifier)return;e||"touchstart"!==i&&"touchmove"!==i||w._handleTouchAction(n)}if(!(r=n[t]).skip){for(let e,t=0;t<w.recognizers.length;t++)o[(e=w.recognizers[t]).name]&&!r[e.name]&&e.flow&&e.flow.start.indexOf(n.type)>-1&&e.reset&&e.reset();for(let e,t=0;t<w.recognizers.length;t++)o[(e=w.recognizers[t]).name]&&!r[e.name]&&(r[e.name]=!0,e[i](n))}}},_handleTouchAction:function(e){let t=e.changedTouches[0],r=e.type;if("touchstart"===r)y.touch.x=t.clientX,y.touch.y=t.clientY,y.touch.scrollDecided=!1;else if("touchmove"===r){if(y.touch.scrollDecided)return;y.touch.scrollDecided=!0;let r=function(e){let t="auto",r=e.composedPath&&e.composedPath();if(r)for(let e,i=0;i<r.length;i++)if((e=r[i])[n]){t=e[n];break}return t}(e),i=!1,s=Math.abs(y.touch.x-t.clientX),o=Math.abs(y.touch.y-t.clientY);e.cancelable&&("none"===r?i=!0:"pan-x"===r?i=o>s:"pan-y"===r&&(i=s>o)),i?e.preventDefault():w.prevent("track")}},addListener:function(e,t,n){return!!this.gestures[t]&&(this._add(e,t,n),!0)},removeListener:function(e,t,n){return!!this.gestures[t]&&(this._remove(e,t,n),!0)},_add:function(e,t,n){let r=this.gestures[t],i=r.deps,s=r.name,o=e.__polymerGestures;o||(e.__polymerGestures=o={});for(let t,n,r=0;r<i.length;r++)t=i[r],u&&a(t)&&"click"!==t||((n=o[t])||(o[t]=n={_count:0}),0===n._count&&e.addEventListener(t,this._handleNative,l(t)),n[s]=(n[s]||0)+1,n._count=(n._count||0)+1);e.addEventListener(t,n),r.touchAction&&this.setTouchAction(e,r.touchAction)},_remove:function(e,t,n){let r=this.gestures[t],i=r.deps,s=r.name,o=e.__polymerGestures;if(o)for(let t,n,r=0;r<i.length;r++)(n=o[t=i[r]])&&n[s]&&(n[s]=(n[s]||1)-1,n._count=(n._count||1)-1,0===n._count&&e.removeEventListener(t,this._handleNative,l(t)));e.removeEventListener(t,n)},register:function(e){this.recognizers.push(e);for(let t=0;t<e.emits.length;t++)this.gestures[e.emits[t]]=e},_findRecognizerByEvent:function(e){for(let t,n=0;n<this.recognizers.length;n++){t=this.recognizers[n];for(let n,r=0;r<t.emits.length;r++)if((n=t.emits[r])===e)return t}return null},setTouchAction:function(t,r){e&&Polymer.Async.microTask.run(()=>{t.style.touchAction=r}),t[n]=r},_fire:function(e,t,n){let r=new Event(t,{bubbles:!0,cancelable:!0,composed:!0});if(r.detail=n,e.dispatchEvent(r),r.defaultPrevented){let e=n.preventer||n.sourceEvent;e&&e.preventDefault&&e.preventDefault()}},prevent:function(e){let t=this._findRecognizerByEvent(e);t.info&&(t.info.prevent=!0)},resetMouseCanceller:function(){y.mouse.mouseIgnoreJob&&y.mouse.mouseIgnoreJob.flush()}};w.register({name:"downup",deps:["mousedown","touchstart","touchend"],flow:{start:["mousedown","touchstart"],end:["mouseup","touchend"]},emits:["down","up"],info:{movefn:null,upfn:null},reset:function(){v(this.info)},mousedown:function(e){if(!g(e))return;let t=w._findOriginalTarget(e),n=this;b(this.info,function(e){g(e)||(n._fire("up",t,e),v(n.info))},function(e){g(e)&&n._fire("up",t,e),v(n.info)}),this._fire("down",t,e)},touchstart:function(e){this._fire("down",w._findOriginalTarget(e),e.changedTouches[0],e)},touchend:function(e){this._fire("up",w._findOriginalTarget(e),e.changedTouches[0],e)},_fire:function(e,t,n,r){w._fire(t,e,{x:n.clientX,y:n.clientY,sourceEvent:n,preventer:r,prevent:function(e){return w.prevent(e)}})}}),w.register({name:"track",touchAction:"none",deps:["mousedown","touchstart","touchmove","touchend"],flow:{start:["mousedown","touchstart"],end:["mouseup","touchend"]},emits:["track"],info:{x:0,y:0,state:"start",started:!1,moves:[],addMove:function(e){this.moves.length>2&&this.moves.shift(),this.moves.push(e)},movefn:null,upfn:null,prevent:!1},reset:function(){this.info.state="start",this.info.started=!1,this.info.moves=[],this.info.x=0,this.info.y=0,this.info.prevent=!1,v(this.info)},hasMovedEnough:function(e,t){if(this.info.prevent)return!1;if(this.info.started)return!0;let n=Math.abs(this.info.x-e),r=Math.abs(this.info.y-t);return n>=5||r>=5},mousedown:function(e){if(!g(e))return;let t=w._findOriginalTarget(e),n=this,r=function(e){let r=e.clientX,i=e.clientY;n.hasMovedEnough(r,i)&&(n.info.state=n.info.started?"mouseup"===e.type?"end":"track":"start","start"===n.info.state&&w.prevent("tap"),n.info.addMove({x:r,y:i}),g(e)||(n.info.state="end",v(n.info)),n._fire(t,e),n.info.started=!0)};b(this.info,r,function(e){n.info.started&&r(e),v(n.info)}),this.info.x=e.clientX,this.info.y=e.clientY},touchstart:function(e){let t=e.changedTouches[0];this.info.x=t.clientX,this.info.y=t.clientY},touchmove:function(e){let t=w._findOriginalTarget(e),n=e.changedTouches[0],r=n.clientX,i=n.clientY;this.hasMovedEnough(r,i)&&("start"===this.info.state&&w.prevent("tap"),this.info.addMove({x:r,y:i}),this._fire(t,n),this.info.state="track",this.info.started=!0)},touchend:function(e){let t=w._findOriginalTarget(e),n=e.changedTouches[0];this.info.started&&(this.info.state="end",this.info.addMove({x:n.clientX,y:n.clientY}),this._fire(t,n,e))},_fire:function(e,t){let n,r=this.info.moves[this.info.moves.length-2],i=this.info.moves[this.info.moves.length-1],s=i.x-this.info.x,o=i.y-this.info.y,a=0;r&&(n=i.x-r.x,a=i.y-r.y),w._fire(e,"track",{state:this.info.state,x:t.clientX,y:t.clientY,dx:s,dy:o,ddx:n,ddy:a,sourceEvent:t,hover:function(){return w.deepTargetFind(t.clientX,t.clientY)}})}}),w.register({name:"tap",deps:["mousedown","click","touchstart","touchend"],flow:{start:["mousedown","touchstart"],end:["click","touchend"]},emits:["tap"],info:{x:NaN,y:NaN,prevent:!1},reset:function(){this.info.x=NaN,this.info.y=NaN,this.info.prevent=!1},save:function(e){this.info.x=e.clientX,this.info.y=e.clientY},mousedown:function(e){g(e)&&this.save(e)},click:function(e){g(e)&&this.forward(e)},touchstart:function(e){this.save(e.changedTouches[0],e)},touchend:function(e){this.forward(e.changedTouches[0],e)},forward:function(e,t){let n=Math.abs(e.clientX-this.info.x),r=Math.abs(e.clientY-this.info.y),i=w._findOriginalTarget(t||e);i&&!i.disabled&&(isNaN(n)||isNaN(r)||n<=25&&r<=25||function(e){if("click"===e.type){if(0===e.detail)return!0;let t=w._findOriginalTarget(e);if(!t.nodeType||t.nodeType!==Node.ELEMENT_NODE)return!0;let n=t.getBoundingClientRect(),r=e.pageX,i=e.pageY;return!(r>=n.left&&r<=n.right&&i>=n.top&&i<=n.bottom)}return!1}(e))&&(this.info.prevent||w._fire(i,"tap",{x:e.clientX,y:e.clientY,sourceEvent:e,preventer:t}))}}),w.findOriginalTarget=w._findOriginalTarget,w.add=w.addListener,w.remove=w.removeListener,Polymer.Gestures=w}(),function(){"use strict";const e=Polymer.Gestures;Polymer.GestureEventListeners=Polymer.dedupingMixin(t=>{return class extends t{_addEventListenerToNode(t,n,r){e.addListener(t,n,r)||super._addEventListenerToNode(t,n,r)}_removeEventListenerFromNode(t,n,r){e.removeListener(t,n,r)||super._removeEventListenerFromNode(t,n,r)}}})}(),function(){"use strict";const e=/:host\(:dir\((ltr|rtl)\)\)/g,t=':host([dir="$1"])',n=/([\s\w-#\.\[\]\*]*):dir\((ltr|rtl)\)/g,r=':host([dir="$2"]) $1',i=[];let s=null,o="";function a(){o=document.documentElement.getAttribute("dir")}function c(e){if(!e.__autoDirOptOut){e.setAttribute("dir",o)}}function l(){a(),o=document.documentElement.getAttribute("dir");for(let e=0;e<i.length;e++)c(i[e])}Polymer.DirMixin=Polymer.dedupingMixin(o=>{s||(a(),(s=new MutationObserver(l)).observe(document.documentElement,{attributes:!0,attributeFilter:["dir"]}));const u=Polymer.PropertyAccessors(o);class h extends u{static _processStyleText(e,t){return e=super._processStyleText(e,t),e=this._replaceDirInCssText(e)}static _replaceDirInCssText(i){let s=i;return i!==(s=(s=s.replace(e,t)).replace(n,r))&&(this.__activateDir=!0),s}constructor(){super(),this.__autoDirOptOut=!1}ready(){super.ready(),this.__autoDirOptOut=this.hasAttribute("dir")}connectedCallback(){u.prototype.connectedCallback&&super.connectedCallback(),this.constructor.__activateDir&&(s&&s.takeRecords().length&&l(),i.push(this),c(this))}disconnectedCallback(){if(u.prototype.disconnectedCallback&&super.disconnectedCallback(),this.constructor.__activateDir){const e=i.indexOf(this);e>-1&&i.splice(e,1)}}}return h.__activateDir=!1,h})}(),function(){"use strict";function e(e){window.HTMLImports?HTMLImports.whenReady(e):e()}Polymer.importHref=function(t,n,r,i){let s=document.head.querySelector('link[href="'+t+'"][import-href]');s||((s=document.createElement("link")).rel="import",s.href=t,s.setAttribute("import-href","")),i&&s.setAttribute("async","");let o=function(){s.removeEventListener("load",a),s.removeEventListener("error",c)},a=function(t){o(),s.__dynamicImportLoaded=!0,n&&e(()=>{n(t)})},c=function(t){o(),s.parentNode&&s.parentNode.removeChild(s),r&&e(()=>{r(t)})};return s.addEventListener("load",a),s.addEventListener("error",c),null==s.parentNode?document.head.appendChild(s):s.__dynamicImportLoaded&&s.dispatchEvent(new Event("load")),s}}(),function(){"use strict";let e=!1,t=[],n=[];function r(){e=!0,requestAnimationFrame(function(){e=!1,i(t),setTimeout(function(){!function(e){for(let t=0,n=e.length;t<n;t++)s(e.shift())}(n)})})}function i(e){for(;e.length;)s(e.shift())}function s(e){const t=e[0],n=e[1],r=e[2];try{n.apply(t,r)}catch(e){setTimeout(()=>{throw e})}}Polymer.RenderStatus={beforeNextRender:function(n,i,s){e||r(),t.push([n,i,s])},afterNextRender:function(t,i,s){e||r(),n.push([t,i,s])},flush:function(){for(;t.length||n.length;)i(t),i(n);e=!1}}}(),function(){"use strict";function e(){document.body.removeAttribute("unresolved")}window.WebComponents?window.addEventListener("WebComponentsReady",e):"interactive"===document.readyState||"complete"===document.readyState?e():window.addEventListener("DOMContentLoaded",e)}(),function(){"use strict";function e(e,t,n){return{index:e,removed:t,addedCount:n}}const t=0,n=1,r=2,i=3;function s(s,a,c,l,u,h){let d,f=0,_=0,p=Math.min(c-a,h-u);if(0==a&&0==u&&(f=function(e,t,n){for(let r=0;r<n;r++)if(!o(e[r],t[r]))return r;return n}(s,l,p)),c==s.length&&h==l.length&&(_=function(e,t,n){let r=e.length,i=t.length,s=0;for(;s<n&&o(e[--r],t[--i]);)s++;return s}(s,l,p-f)),u+=f,h-=_,(c-=_)-(a+=f)==0&&h-u==0)return[];if(a==c){for(d=e(a,[],0);u<h;)d.removed.push(l[u++]);return[d]}if(u==h)return[e(a,[],c-a)];let m=function(e){let s=e.length-1,o=e[0].length-1,a=e[s][o],c=[];for(;s>0||o>0;){if(0==s){c.push(r),o--;continue}if(0==o){c.push(i),s--;continue}let l,u=e[s-1][o-1],h=e[s-1][o],d=e[s][o-1];(l=h<d?h<u?h:u:d<u?d:u)==u?(u==a?c.push(t):(c.push(n),a=u),s--,o--):l==h?(c.push(i),s--,a=h):(c.push(r),o--,a=d)}return c.reverse(),c}(function(e,t,n,r,i,s){let a=s-i+1,c=n-t+1,l=new Array(a);for(let e=0;e<a;e++)l[e]=new Array(c),l[e][0]=e;for(let e=0;e<c;e++)l[0][e]=e;for(let n=1;n<a;n++)for(let s=1;s<c;s++)if(o(e[t+s-1],r[i+n-1]))l[n][s]=l[n-1][s-1];else{let e=l[n-1][s]+1,t=l[n][s-1]+1;l[n][s]=e<t?e:t}return l}(s,a,c,l,u,h));d=void 0;let g=[],y=a,b=u;for(let s=0;s<m.length;s++)switch(m[s]){case t:d&&(g.push(d),d=void 0),y++,b++;break;case n:d||(d=e(y,[],0)),d.addedCount++,y++,d.removed.push(l[b]),b++;break;case r:d||(d=e(y,[],0)),d.addedCount++,y++;break;case i:d||(d=e(y,[],0)),d.removed.push(l[b]),b++}return d&&g.push(d),g}function o(e,t){return e===t}Polymer.ArraySplice={calculateSplices:function(e,t){return s(e,0,e.length,t,0,t.length)}}}(),function(){"use strict";function e(e){return"slot"===e.localName}Polymer.FlattenedNodesObserver=class{static getFlattenedNodes(t){return e(t)?(t=t).assignedNodes({flatten:!0}):Array.from(t.childNodes).map(t=>e(t)?(t=t).assignedNodes({flatten:!0}):[t]).reduce((e,t)=>e.concat(t),[])}constructor(e,t){this._shadyChildrenObserver=null,this._nativeChildrenObserver=null,this._connected=!1,this._target=e,this.callback=t,this._effectiveNodes=[],this._observer=null,this._scheduled=!1,this._boundSchedule=(()=>{this._schedule()}),this.connect(),this._schedule()}connect(){e(this._target)?this._listenSlots([this._target]):this._target.children&&(this._listenSlots(this._target.children),window.ShadyDOM?this._shadyChildrenObserver=ShadyDOM.observeChildren(this._target,e=>{this._processMutations(e)}):(this._nativeChildrenObserver=new MutationObserver(e=>{this._processMutations(e)}),this._nativeChildrenObserver.observe(this._target,{childList:!0}))),this._connected=!0}disconnect(){e(this._target)?this._unlistenSlots([this._target]):this._target.children&&(this._unlistenSlots(this._target.children),window.ShadyDOM&&this._shadyChildrenObserver?(ShadyDOM.unobserveChildren(this._shadyChildrenObserver),this._shadyChildrenObserver=null):this._nativeChildrenObserver&&(this._nativeChildrenObserver.disconnect(),this._nativeChildrenObserver=null)),this._connected=!1}_schedule(){this._scheduled||(this._scheduled=!0,Polymer.Async.microTask.run(()=>this.flush()))}_processMutations(e){this._processSlotMutations(e),this.flush()}_processSlotMutations(e){if(e)for(let t=0;t<e.length;t++){let n=e[t];n.addedNodes&&this._listenSlots(n.addedNodes),n.removedNodes&&this._unlistenSlots(n.removedNodes)}}flush(){if(!this._connected)return!1;window.ShadyDOM&&ShadyDOM.flush(),this._nativeChildrenObserver?this._processSlotMutations(this._nativeChildrenObserver.takeRecords()):this._shadyChildrenObserver&&this._processSlotMutations(this._shadyChildrenObserver.takeRecords()),this._scheduled=!1;let e={target:this._target,addedNodes:[],removedNodes:[]},t=this.constructor.getFlattenedNodes(this._target),n=Polymer.ArraySplice.calculateSplices(t,this._effectiveNodes);for(let t,r=0;r<n.length&&(t=n[r]);r++)for(let n,r=0;r<t.removed.length&&(n=t.removed[r]);r++)e.removedNodes.push(n);for(let r,i=0;i<n.length&&(r=n[i]);i++)for(let n=r.index;n<r.index+r.addedCount;n++)e.addedNodes.push(t[n]);this._effectiveNodes=t;let r=!1;return(e.addedNodes.length||e.removedNodes.length)&&(r=!0,this.callback.call(this._target,e)),r}_listenSlots(t){for(let n=0;n<t.length;n++){let r=t[n];e(r)&&r.addEventListener("slotchange",this._boundSchedule)}}_unlistenSlots(t){for(let n=0;n<t.length;n++){let r=t[n];e(r)&&r.removeEventListener("slotchange",this._boundSchedule)}}}}(),function(){"use strict";let e=[];function t(){const t=Boolean(e.length);for(;e.length;)try{e.shift().flush()}catch(e){setTimeout(()=>{throw e})}return t}Polymer.enqueueDebouncer=function(t){e.push(t)},Polymer.flush=function(){let e,n;do{e=window.ShadyDOM&&ShadyDOM.flush(),window.ShadyCSS&&window.ShadyCSS.ScopingShim&&window.ShadyCSS.ScopingShim.flush(),n=t()}while(e||n)}}(),function(){"use strict";const e=Element.prototype,t=e.matches||e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector,n=function(e,n){return t.call(e,n)};class r{constructor(e){this.node=e}observeNodes(e){return new Polymer.FlattenedNodesObserver(this.node,e)}unobserveNodes(e){e.disconnect()}notifyObserver(){}deepContains(e){if(this.node.contains(e))return!0;let t=e,n=e.ownerDocument;for(;t&&t!==n&&t!==this.node;)t=t.parentNode||t.host;return t===this.node}getOwnerRoot(){return this.node.getRootNode()}getDistributedNodes(){return"slot"===this.node.localName?this.node.assignedNodes({flatten:!0}):[]}getDestinationInsertionPoints(){let e=[],t=this.node.assignedSlot;for(;t;)e.push(t),t=t.assignedSlot;return e}importNode(e,t){return(this.node instanceof Document?this.node:this.node.ownerDocument).importNode(e,t)}getEffectiveChildNodes(){return Polymer.FlattenedNodesObserver.getFlattenedNodes(this.node)}queryDistributedElements(e){let t=this.getEffectiveChildNodes(),r=[];for(let i,s=0,o=t.length;s<o&&(i=t[s]);s++)i.nodeType===Node.ELEMENT_NODE&&n(i,e)&&r.push(i);return r}get activeElement(){let e=this.node;return void 0!==e._activeElement?e._activeElement:e.activeElement}}!function(e,t){for(let n=0;n<t.length;n++){let r=t[n];e[r]=function(){return this.node[r].apply(this.node,arguments)}}}(r.prototype,["cloneNode","appendChild","insertBefore","removeChild","replaceChild","setAttribute","removeAttribute","querySelector","querySelectorAll"]),function(e,t){for(let n=0;n<t.length;n++){let r=t[n];Object.defineProperty(e,r,{get:function(){return this.node[r]},configurable:!0})}}(r.prototype,["parentNode","firstChild","lastChild","nextSibling","previousSibling","firstElementChild","lastElementChild","nextElementSibling","previousElementSibling","childNodes","children","classList"]),function(e,t){for(let n=0;n<t.length;n++){let r=t[n];Object.defineProperty(e,r,{get:function(){return this.node[r]},set:function(e){this.node[r]=e},configurable:!0})}}(r.prototype,["textContent","innerHTML"]);Polymer.DomApi=r,Polymer.DomApi.prototype.cloneNode,Polymer.DomApi.prototype.appendChild,Polymer.DomApi.prototype.insertBefore,Polymer.DomApi.prototype.removeChild,Polymer.DomApi.prototype.replaceChild,Polymer.DomApi.prototype.setAttribute,Polymer.DomApi.prototype.removeAttribute,Polymer.DomApi.prototype.querySelector,Polymer.DomApi.prototype.querySelectorAll,Polymer.dom=function(e){if(!(e=e||document).__domApi){let t;t=e instanceof Event?new class{constructor(e){this.event=e}get rootTarget(){return this.event.composedPath()[0]}get localTarget(){return this.event.target}get path(){return this.event.composedPath()}}(e):new r(e),e.__domApi=t}return e.__domApi},Polymer.dom.matchesSelector=n,Polymer.dom.flush=Polymer.flush,Polymer.dom.addDebouncer=Polymer.enqueueDebouncer}(),function(){"use strict";let e=window.ShadyCSS;Polymer.LegacyElementMixin=Polymer.dedupingMixin(t=>{const n=Polymer.DirMixin(Polymer.GestureEventListeners(Polymer.ElementMixin(t))),r={x:"pan-x",y:"pan-y",none:"none",all:"auto"};class i extends n{constructor(){super(),this.isAttached,this.__boundListeners,this._debouncers,this._applyListeners()}created(){}connectedCallback(){super.connectedCallback(),this.isAttached=!0,this.attached()}attached(){}disconnectedCallback(){super.disconnectedCallback(),this.isAttached=!1,this.detached()}detached(){}attributeChangedCallback(e,t,n){t!==n&&(super.attributeChangedCallback(e,t,n),this.attributeChanged(e,t,n))}attributeChanged(e,t,n){}_initializeProperties(){let e=Object.getPrototypeOf(this);e.hasOwnProperty("__hasRegisterFinished")||(e.__hasRegisterFinished=!0,this._registered()),super._initializeProperties(),this.root=this,this.created()}_registered(){}ready(){this._ensureAttributes(),super.ready()}_ensureAttributes(){}_applyListeners(){}serialize(e){return this._serializeValue(e)}deserialize(e,t){return this._deserializeValue(e,t)}reflectPropertyToAttribute(e,t,n){this._propertyToAttribute(e,t,n)}serializeValueToAttribute(e,t,n){this._valueToNodeAttribute(n||this,e,t)}extend(e,t){if(!e||!t)return e||t;let n=Object.getOwnPropertyNames(t);for(let r,i=0;i<n.length&&(r=n[i]);i++){let n=Object.getOwnPropertyDescriptor(t,r);n&&Object.defineProperty(e,r,n)}return e}mixin(e,t){for(let n in t)e[n]=t[n];return e}chainObject(e,t){return e&&t&&e!==t&&(e.__proto__=t),e}instanceTemplate(e){let t=this.constructor._contentForTemplate(e);return document.importNode(t,!0)}fire(e,t,n){n=n||{},t=null==t?{}:t;let r=new Event(e,{bubbles:void 0===n.bubbles||n.bubbles,cancelable:Boolean(n.cancelable),composed:void 0===n.composed||n.composed});return r.detail=t,(n.node||this).dispatchEvent(r),r}listen(e,t,n){e=e||this;let r=this.__boundListeners||(this.__boundListeners=new WeakMap),i=r.get(e);i||(i={},r.set(e,i));let s=t+n;i[s]||(i[s]=this._addMethodEventListenerToNode(e,t,n,this))}unlisten(e,t,n){e=e||this;let r=this.__boundListeners&&this.__boundListeners.get(e),i=t+n,s=r&&r[i];s&&(this._removeEventListenerFromNode(e,t,s),r[i]=null)}setScrollDirection(e,t){Polymer.Gestures.setTouchAction(t||this,r[e]||"auto")}$$(e){return this.root.querySelector(e)}get domHost(){let e=this.getRootNode();return e instanceof DocumentFragment?e.host:e}distributeContent(){window.ShadyDOM&&this.shadowRoot&&ShadyDOM.flush()}getEffectiveChildNodes(){return Polymer.dom(this).getEffectiveChildNodes()}queryDistributedElements(e){return Polymer.dom(this).queryDistributedElements(e)}getEffectiveChildren(){return this.getEffectiveChildNodes().filter(function(e){return e.nodeType===Node.ELEMENT_NODE})}getEffectiveTextContent(){let e=this.getEffectiveChildNodes(),t=[];for(let n,r=0;n=e[r];r++)n.nodeType!==Node.COMMENT_NODE&&t.push(n.textContent);return t.join("")}queryEffectiveChildren(e){let t=this.queryDistributedElements(e);return t&&t[0]}queryAllEffectiveChildren(e){return this.queryDistributedElements(e)}getContentChildNodes(e){let t=this.root.querySelector(e||"slot");return t?Polymer.dom(t).getDistributedNodes():[]}getContentChildren(e){return this.getContentChildNodes(e).filter(function(e){return e.nodeType===Node.ELEMENT_NODE})}isLightDescendant(e){return this!==e&&this.contains(e)&&this.getRootNode()===e.getRootNode()}isLocalDescendant(e){return this.root===e.getRootNode()}scopeSubtree(e,t){}getComputedStyleValue(t){return e.getComputedStyleValue(this,t)}debounce(e,t,n){return this._debouncers=this._debouncers||{},this._debouncers[e]=Polymer.Debouncer.debounce(this._debouncers[e],n>0?Polymer.Async.timeOut.after(n):Polymer.Async.microTask,t.bind(this))}isDebouncerActive(e){this._debouncers=this._debouncers||{};let t=this._debouncers[e];return!(!t||!t.isActive())}flushDebouncer(e){this._debouncers=this._debouncers||{};let t=this._debouncers[e];t&&t.flush()}cancelDebouncer(e){this._debouncers=this._debouncers||{};let t=this._debouncers[e];t&&t.cancel()}async(e,t){return t>0?Polymer.Async.timeOut.run(e.bind(this),t):~Polymer.Async.microTask.run(e.bind(this))}cancelAsync(e){e<0?Polymer.Async.microTask.cancel(~e):Polymer.Async.timeOut.cancel(e)}create(e,t){let n=document.createElement(e);if(t)if(n.setProperties)n.setProperties(t);else for(let e in t)n[e]=t[e];return n}importHref(e,t,n,r){let i=t?t.bind(this):null,s=n?n.bind(this):null;return Polymer.importHref(e,i,s,r)}elementMatches(e,t){return Polymer.dom.matchesSelector(t||this,e)}toggleAttribute(e,t,n){n=n||this,1==arguments.length&&(t=!n.hasAttribute(e)),t?n.setAttribute(e,""):n.removeAttribute(e)}toggleClass(e,t,n){n=n||this,1==arguments.length&&(t=!n.classList.contains(e)),t?n.classList.add(e):n.classList.remove(e)}transform(e,t){(t=t||this).style.webkitTransform=e,t.style.transform=e}translate3d(e,t,n,r){r=r||this,this.transform("translate3d("+e+","+t+","+n+")",r)}arrayDelete(e,t){let n;if(Array.isArray(e)){if((n=e.indexOf(t))>=0)return e.splice(n,1)}else{if((n=Polymer.Path.get(this,e).indexOf(t))>=0)return this.splice(e,n,1)}return null}_logger(e,t){switch(Array.isArray(t)&&1===t.length&&Array.isArray(t[0])&&(t=t[0]),e){case"log":case"warn":case"error":console[e](...t)}}_log(...e){this._logger("log",e)}_warn(...e){this._logger("warn",e)}_error(...e){this._logger("error",e)}_logf(e,...t){return["[%s::%s]",this.is,e,...t]}}return i.prototype.is="",i})}(),function(){"use strict";let e={attached:!0,detached:!0,ready:!0,created:!0,beforeRegister:!0,registered:!0,attributeChanged:!0,behaviors:!0};function t(e,t){if(!e)return t=t;t=Polymer.LegacyElementMixin(t),Array.isArray(e)||(e=[e]);let r=t.prototype.behaviors;return t=function e(t,r){for(let i=0;i<t.length;i++){let s=t[i];s&&(r=Array.isArray(s)?e(s,r):n(s,r))}return r}(e=function e(t,n,r){n=n||[];for(let i=t.length-1;i>=0;i--){let s=t[i];s?Array.isArray(s)?e(s,n):n.indexOf(s)<0&&(!r||r.indexOf(s)<0)&&n.unshift(s):console.warn("behavior is null, check for missing or 404 import")}return n}(e,null,r),t),r&&(e=r.concat(e)),t.prototype.behaviors=e,t}function n(t,n){class r extends n{static get properties(){return t.properties}static get observers(){return t.observers}static get template(){return t._template||Polymer.DomModule&&Polymer.DomModule.import(this.is,"template")||n.template||this.prototype._template||null}created(){super.created(),t.created&&t.created.call(this)}_registered(){super._registered(),t.beforeRegister&&t.beforeRegister.call(Object.getPrototypeOf(this)),t.registered&&t.registered.call(Object.getPrototypeOf(this))}_applyListeners(){if(super._applyListeners(),t.listeners)for(let e in t.listeners)this._addMethodEventListenerToNode(this,e,t.listeners[e])}_ensureAttributes(){if(t.hostAttributes)for(let e in t.hostAttributes)this._ensureAttribute(e,t.hostAttributes[e]);super._ensureAttributes()}ready(){super.ready(),t.ready&&t.ready.call(this)}attached(){super.attached(),t.attached&&t.attached.call(this)}detached(){super.detached(),t.detached&&t.detached.call(this)}attributeChanged(e,n,r){super.attributeChanged(e,n,r),t.attributeChanged&&t.attributeChanged.call(this,e,n,r)}}r.generatedFrom=t;for(let n in t)if(!(n in e)){let e=Object.getOwnPropertyDescriptor(t,n);e&&Object.defineProperty(r.prototype,n,e)}return r}Polymer.Class=function(e){e||console.warn("Polymer.Class requires `info` argument");let r=n(e,e.behaviors?t(e.behaviors,HTMLElement):Polymer.LegacyElementMixin(HTMLElement));return r.is=e.is,r},Polymer.mixinBehaviors=t}(),function(){"use strict";window.Polymer._polymerFn=function(e){let t;return t="function"==typeof e?e:Polymer.Class(e),customElements.define(t.is,t),t}}(),function(){"use strict";function e(e,t,n,r,i){let s;i&&(s="object"==typeof n&&null!==n)&&(r=e.__dataTemp[t]);let o=r!==n&&(r==r||n==n);return s&&o&&(e.__dataTemp[t]=n),o}Polymer.MutableData=Polymer.dedupingMixin(t=>{return class extends t{_shouldPropertyChange(t,n,r){return e(this,t,n,r,!0)}}}),Polymer.OptionalMutableData=Polymer.dedupingMixin(t=>{return class extends t{static get properties(){return{mutableData:Boolean}}_shouldPropertyChange(t,n,r){return e(this,t,n,r,this.mutableData)}}}),Polymer.MutableData._mutablePropertyChange=e}(),function(){"use strict";let e=null;function t(){return e}t.prototype=Object.create(HTMLTemplateElement.prototype,{constructor:{value:t,writable:!0}});const n=Polymer.PropertyEffects(t),r=Polymer.MutableData(n);const i=Polymer.PropertyEffects(class{});class s extends i{constructor(e){super(),this._configureProperties(e),this.root=this._stampTemplate(this.__dataHost);let t=this.children=[];for(let e=this.root.firstChild;e;e=e.nextSibling)t.push(e),e.__templatizeInstance=this;this.__templatizeOwner&&this.__templatizeOwner.__hideTemplateChildren__&&this._showHideChildren(!0);let n=this.__templatizeOptions;(e&&n.instanceProps||!n.instanceProps)&&this._enableProperties()}_configureProperties(e){if(this.__templatizeOptions.forwardHostProp)for(let e in this.__hostProps)this._setPendingProperty(e,this.__dataHost["_host_"+e]);for(let t in e)this._setPendingProperty(t,e[t])}forwardHostProp(e,t){this._setPendingPropertyOrPath(e,t,!1,!0)&&this.__dataHost._enqueueClient(this)}_addEventListenerToNode(e,t,n){if(this._methodHost&&this.__templatizeOptions.parentModel)this._methodHost._addEventListenerToNode(e,t,e=>{e.model=this,n(e)});else{let r=this.__dataHost.__dataHost;r&&r._addEventListenerToNode(e,t,n)}}_showHideChildren(e){let t=this.children;for(let n=0;n<t.length;n++){let r=t[n];if(Boolean(e)!=Boolean(r.__hideTemplateChildren__))if(r.nodeType===Node.TEXT_NODE)e?(r.__polymerTextContent__=r.textContent,r.textContent=""):r.textContent=r.__polymerTextContent__;else if("slot"===r.localName)if(e)r.__polymerReplaced__=document.createComment("hidden-slot"),r.parentNode.replaceChild(r.__polymerReplaced__,r);else{const e=r.__polymerReplaced__;e&&e.parentNode.replaceChild(r,e)}else r.style&&(e?(r.__polymerDisplay__=r.style.display,r.style.display="none"):r.style.display=r.__polymerDisplay__);r.__hideTemplateChildren__=e,r._showHideChildren&&r._showHideChildren(e)}}_setUnmanagedPropertyToNode(e,t,n){e.__hideTemplateChildren__&&e.nodeType==Node.TEXT_NODE&&"textContent"==t?e.__polymerTextContent__=n:super._setUnmanagedPropertyToNode(e,t,n)}get parentModel(){let e=this.__parentModel;if(!e){let t;e=this;do{e=e.__dataHost.__dataHost}while((t=e.__templatizeOptions)&&!t.parentModel);this.__parentModel=e}return e}dispatchEvent(e){return!0}}s.prototype.__dataHost,s.prototype.__templatizeOptions,s.prototype._methodHost,s.prototype.__templatizeOwner,s.prototype.__hostProps;const o=Polymer.MutableData(s);function a(e,t,n){let r=n.mutableData?o:s,i=class extends r{};return i.prototype.__templatizeOptions=n,i.prototype._bindTemplate(e),function(e,t,n,r){let i=n.hostProps||{};for(let t in r.instanceProps){delete i[t];let n=r.notifyInstanceProp;n&&e.prototype._addPropertyEffect(t,e.prototype.PROPERTY_EFFECT_TYPES.NOTIFY,{fn:u(t,n)})}if(r.forwardHostProp&&t.__dataHost)for(let t in i)e.prototype._addPropertyEffect(t,e.prototype.PROPERTY_EFFECT_TYPES.NOTIFY,{fn:function(e,t,n){e.__dataHost._setPendingPropertyOrPath("_host_"+t,n[t],!0,!0)}})}(i,e,t,n),i}function c(t,i,s){let o=s.forwardHostProp;if(o){let a=i.templatizeTemplateClass;if(!a){let e=s.mutableData?r:n;a=i.templatizeTemplateClass=class extends e{};let t=i.hostProps;for(let e in t)a.prototype._addPropertyEffect("_host_"+e,a.prototype.PROPERTY_EFFECT_TYPES.PROPAGATE,{fn:l(e,o)}),a.prototype._createNotifyingProperty("_host_"+e)}!function(t,n){e=t,Object.setPrototypeOf(t,n.prototype),new n,e=null}(t,a),t.__dataProto&&Object.assign(t.__data,t.__dataProto),t.__dataTemp={},t.__dataPending=null,t.__dataOld=null,t._enableProperties()}}function l(e,t){return function(e,n,r){t.call(e.__templatizeOwner,n.substring("_host_".length),r[n])}}function u(e,t){return function(e,n,r){t.call(e.__templatizeOwner,e,n,r[n])}}Polymer.Templatize={templatize(e,t,n){if(n=n||{},e.__templatizeOwner)throw new Error("A <template> can only be templatized once");e.__templatizeOwner=t;let r=(t?t.constructor:s)._parseTemplate(e),i=r.templatizeInstanceClass;i||(i=a(e,r,n),r.templatizeInstanceClass=i),c(e,r,n);let o=class extends i{};return o.prototype._methodHost=function(e){let t=e.__dataHost;return t&&t._methodHost||t}(e),o.prototype.__dataHost=e,o.prototype.__templatizeOwner=t,o.prototype.__hostProps=r.hostProps,o=o},modelForElement(e,t){let n;for(;t;)if(n=t.__templatizeInstance){if(n.__dataHost==e)return n;t=n.__dataHost}else t=t.parentNode;return null}},Polymer.TemplateInstanceBase=s}(),function(){"use strict";Polymer.TemplateInstanceBase;Polymer.Templatizer={templatize(e,t){this._templatizerTemplate=e,this.ctor=Polymer.Templatize.templatize(e,this,{mutableData:Boolean(t),parentModel:this._parentModel,instanceProps:this._instanceProps,forwardHostProp:this._forwardHostPropV2,notifyInstanceProp:this._notifyInstancePropV2})},stamp(e){return new this.ctor(e)},modelForElement(e){return Polymer.Templatize.modelForElement(this._templatizerTemplate,e)}}}(),function(){"use strict";const e=Polymer.GestureEventListeners(Polymer.OptionalMutableData(Polymer.PropertyEffects(HTMLElement)));class t extends e{static get observedAttributes(){return["mutable-data"]}constructor(){super(),this.root=null,this.$=null,this.__children=null}attributeChangedCallback(){this.mutableData=!0}connectedCallback(){this.style.display="none",this.render()}disconnectedCallback(){this.__removeChildren()}__insertChildren(){this.parentNode.insertBefore(this.root,this)}__removeChildren(){if(this.__children)for(let e=0;e<this.__children.length;e++)this.root.appendChild(this.__children[e])}render(){let e;if(!this.__children){if(!(e=e||this.querySelector("template"))){let t=new MutationObserver(()=>{if(!(e=this.querySelector("template")))throw new Error("dom-bind requires a <template> child");t.disconnect(),this.render()});return void t.observe(this,{childList:!0})}this.root=this._stampTemplate(e),this.$=this.root.$,this.__children=[];for(let e=this.root.firstChild;e;e=e.nextSibling)this.__children[this.__children.length]=e;this._enableProperties()}this.__insertChildren(),this.dispatchEvent(new CustomEvent("dom-change",{bubbles:!0,composed:!0}))}}customElements.define("dom-bind",t),Polymer.DomBind=t}(),function(){"use strict";class e{constructor(e){this.value=e.toString()}toString(){return this.value}}function t(t){if(t instanceof e)return t.value;throw new Error(`non-literal value passed to Polymer.htmlLiteral: ${t}`)}Polymer.html=function(n,...r){const i=document.createElement("template");return i.innerHTML=r.reduce((r,i,s)=>r+function(n){if(n instanceof HTMLTemplateElement)return n.innerHTML;if(n instanceof e)return t(n);throw new Error(`non-template value passed to Polymer.html: ${n}`)}(i)+n[s+1],n[0]),i},Polymer.htmlLiteral=function(n,...r){return new e(r.reduce((e,r,i)=>e+t(r)+n[i+1],n[0]))}}(),function(){"use strict";const e=Polymer.ElementMixin(HTMLElement);Polymer.Element=e,Polymer.html=Polymer.html}(),function(){"use strict";Polymer.TemplateInstanceBase;const e=Polymer.OptionalMutableData(Polymer.Element);class t extends e{static get is(){return"dom-repeat"}static get template(){return null}static get properties(){return{items:{type:Array},as:{type:String,value:"item"},indexAs:{type:String,value:"index"},itemsIndexAs:{type:String,value:"itemsIndex"},sort:{type:Function,observer:"__sortChanged"},filter:{type:Function,observer:"__filterChanged"},observe:{type:String,observer:"__observeChanged"},delay:Number,renderedItemCount:{type:Number,notify:!0,readOnly:!0},initialCount:{type:Number,observer:"__initializeChunking"},targetFramerate:{type:Number,value:20},_targetFrameTime:{type:Number,computed:"__computeFrameTime(targetFramerate)"}}}static get observers(){return["__itemsChanged(items.*)"]}constructor(){super(),this.__instances=[],this.__limit=1/0,this.__pool=[],this.__renderDebouncer=null,this.__itemsIdxToInstIdx={},this.__chunkCount=null,this.__lastChunkTime=null,this.__sortFn=null,this.__filterFn=null,this.__observePaths=null,this.__ctor=null,this.__isDetached=!0,this.template=null}disconnectedCallback(){super.disconnectedCallback(),this.__isDetached=!0;for(let e=0;e<this.__instances.length;e++)this.__detachInstance(e)}connectedCallback(){if(super.connectedCallback(),this.style.display="none",this.__isDetached){this.__isDetached=!1;let e=this.parentNode;for(let t=0;t<this.__instances.length;t++)this.__attachInstance(t,e)}}__ensureTemplatized(){if(!this.__ctor){let e=this.template=this.querySelector("template");if(!e){let e=new MutationObserver(()=>{if(!this.querySelector("template"))throw new Error("dom-repeat requires a <template> child");e.disconnect(),this.__render()});return e.observe(this,{childList:!0}),!1}let t={};t[this.as]=!0,t[this.indexAs]=!0,t[this.itemsIndexAs]=!0,this.__ctor=Polymer.Templatize.templatize(e,this,{mutableData:this.mutableData,parentModel:!0,instanceProps:t,forwardHostProp:function(e,t){let n=this.__instances;for(let r,i=0;i<n.length&&(r=n[i]);i++)r.forwardHostProp(e,t)},notifyInstanceProp:function(e,t,n){if(Polymer.Path.matches(this.as,t)){let r=e[this.itemsIndexAs];t==this.as&&(this.items[r]=n);let i=Polymer.Path.translate(this.as,"items."+r,t);this.notifyPath(i,n)}}})}return!0}__getMethodHost(){return this.__dataHost._methodHost||this.__dataHost}__functionFromPropertyValue(e){if("string"==typeof e){let t=e,n=this.__getMethodHost();return function(){return n[t].apply(n,arguments)}}return e}__sortChanged(e){this.__sortFn=this.__functionFromPropertyValue(e),this.items&&this.__debounceRender(this.__render)}__filterChanged(e){this.__filterFn=this.__functionFromPropertyValue(e),this.items&&this.__debounceRender(this.__render)}__computeFrameTime(e){return Math.ceil(1e3/e)}__initializeChunking(){this.initialCount&&(this.__limit=this.initialCount,this.__chunkCount=this.initialCount,this.__lastChunkTime=performance.now())}__tryRenderChunk(){this.items&&this.__limit<this.items.length&&this.__debounceRender(this.__requestRenderChunk)}__requestRenderChunk(){requestAnimationFrame(()=>this.__renderChunk())}__renderChunk(){let e=performance.now(),t=this._targetFrameTime/(e-this.__lastChunkTime);this.__chunkCount=Math.round(this.__chunkCount*t)||1,this.__limit+=this.__chunkCount,this.__lastChunkTime=e,this.__debounceRender(this.__render)}__observeChanged(){this.__observePaths=this.observe&&this.observe.replace(".*",".").split(" ")}__itemsChanged(e){this.items&&!Array.isArray(this.items)&&console.warn("dom-repeat expected array for `items`, found",this.items),this.__handleItemPath(e.path,e.value)||(this.__initializeChunking(),this.__debounceRender(this.__render))}__handleObservedPaths(e){if(this.__sortFn||this.__filterFn)if(e){if(this.__observePaths){let t=this.__observePaths;for(let n=0;n<t.length;n++)0===e.indexOf(t[n])&&this.__debounceRender(this.__render,this.delay)}}else this.__debounceRender(this.__render,this.delay)}__debounceRender(e,t=0){this.__renderDebouncer=Polymer.Debouncer.debounce(this.__renderDebouncer,t>0?Polymer.Async.timeOut.after(t):Polymer.Async.microTask,e.bind(this)),Polymer.enqueueDebouncer(this.__renderDebouncer)}render(){this.__debounceRender(this.__render),Polymer.flush()}__render(){this.__ensureTemplatized()&&(this.__applyFullRefresh(),this.__pool.length=0,this._setRenderedItemCount(this.__instances.length),this.dispatchEvent(new CustomEvent("dom-change",{bubbles:!0,composed:!0})),this.__tryRenderChunk())}__applyFullRefresh(){let e=this.items||[],t=new Array(e.length);for(let n=0;n<e.length;n++)t[n]=n;this.__filterFn&&(t=t.filter((t,n,r)=>this.__filterFn(e[t],n,r))),this.__sortFn&&t.sort((t,n)=>this.__sortFn(e[t],e[n]));const n=this.__itemsIdxToInstIdx={};let r=0;const i=Math.min(t.length,this.__limit);for(;r<i;r++){let i=this.__instances[r],s=t[r],o=e[s];n[s]=r,i?(i._setPendingProperty(this.as,o),i._setPendingProperty(this.indexAs,r),i._setPendingProperty(this.itemsIndexAs,s),i._flushProperties()):this.__insertInstance(o,r,s)}for(let e=this.__instances.length-1;e>=r;e--)this.__detachAndRemoveInstance(e)}__detachInstance(e){let t=this.__instances[e];for(let e=0;e<t.children.length;e++){let n=t.children[e];t.root.appendChild(n)}return t}__attachInstance(e,t){let n=this.__instances[e];t.insertBefore(n.root,this)}__detachAndRemoveInstance(e){let t=this.__detachInstance(e);t&&this.__pool.push(t),this.__instances.splice(e,1)}__stampInstance(e,t,n){let r={};return r[this.as]=e,r[this.indexAs]=t,r[this.itemsIndexAs]=n,new this.__ctor(r)}__insertInstance(e,t,n){let r=this.__pool.pop();r?(r._setPendingProperty(this.as,e),r._setPendingProperty(this.indexAs,t),r._setPendingProperty(this.itemsIndexAs,n),r._flushProperties()):r=this.__stampInstance(e,t,n);let i=this.__instances[t+1],s=i?i.children[0]:this;return this.parentNode.insertBefore(r.root,s),this.__instances[t]=r,r}_showHideChildren(e){for(let t=0;t<this.__instances.length;t++)this.__instances[t]._showHideChildren(e)}__handleItemPath(e,t){let n=e.slice(6),r=n.indexOf("."),i=r<0?n:n.substring(0,r);if(i==parseInt(i,10)){let e=r<0?"":n.substring(r+1);this.__handleObservedPaths(e);let s=this.__itemsIdxToInstIdx[i],o=this.__instances[s];if(o){let n=this.as+(e?"."+e:"");o._setPendingPropertyOrPath(n,t,!1,!0),o._flushProperties()}return!0}}itemForElement(e){let t=this.modelForElement(e);return t&&t[this.as]}indexForElement(e){let t=this.modelForElement(e);return t&&t[this.indexAs]}modelForElement(e){return Polymer.Templatize.modelForElement(this.template,e)}}customElements.define(t.is,t),Polymer.DomRepeat=t}(),function(){"use strict";class e extends Polymer.Element{static get is(){return"dom-if"}static get template(){return null}static get properties(){return{if:{type:Boolean,observer:"__debounceRender"},restamp:{type:Boolean,observer:"__debounceRender"}}}constructor(){super(),this.__renderDebouncer=null,this.__invalidProps=null,this.__instance=null,this._lastIf=!1,this.__ctor=null}__debounceRender(){this.__renderDebouncer=Polymer.Debouncer.debounce(this.__renderDebouncer,Polymer.Async.microTask,()=>this.__render()),Polymer.enqueueDebouncer(this.__renderDebouncer)}disconnectedCallback(){super.disconnectedCallback(),this.parentNode&&(this.parentNode.nodeType!=Node.DOCUMENT_FRAGMENT_NODE||this.parentNode.host)||this.__teardownInstance()}connectedCallback(){super.connectedCallback(),this.style.display="none",this.if&&this.__debounceRender()}render(){Polymer.flush()}__render(){if(this.if){if(!this.__ensureInstance())return;this._showHideChildren()}else this.restamp&&this.__teardownInstance();!this.restamp&&this.__instance&&this._showHideChildren(),this.if!=this._lastIf&&(this.dispatchEvent(new CustomEvent("dom-change",{bubbles:!0,composed:!0})),this._lastIf=this.if)}__ensureInstance(){let e=this.parentNode;if(e){if(!this.__ctor){let e=this.querySelector("template");if(!e){let e=new MutationObserver(()=>{if(!this.querySelector("template"))throw new Error("dom-if requires a <template> child");e.disconnect(),this.__render()});return e.observe(this,{childList:!0}),!1}this.__ctor=Polymer.Templatize.templatize(e,this,{mutableData:!0,forwardHostProp:function(e,t){this.__instance&&(this.if?this.__instance.forwardHostProp(e,t):(this.__invalidProps=this.__invalidProps||Object.create(null),this.__invalidProps[Polymer.Path.root(e)]=!0))}})}if(this.__instance){this.__syncHostProperties();let t=this.__instance.children;if(t&&t.length){if(this.previousSibling!==t[t.length-1])for(let n,r=0;r<t.length&&(n=t[r]);r++)e.insertBefore(n,this)}}else this.__instance=new this.__ctor,e.insertBefore(this.__instance.root,this)}return!0}__syncHostProperties(){let e=this.__invalidProps;if(e){for(let t in e)this.__instance._setPendingProperty(t,this.__dataHost[t]);this.__invalidProps=null,this.__instance._flushProperties()}}__teardownInstance(){if(this.__instance){let e=this.__instance.children;if(e&&e.length){let t=e[0].parentNode;for(let n,r=0;r<e.length&&(n=e[r]);r++)t.removeChild(n)}this.__instance=null,this.__invalidProps=null}}_showHideChildren(){let e=this.__hideTemplateChildren__||!this.if;this.__instance&&this.__instance._showHideChildren(e)}}customElements.define(e.is,e),Polymer.DomIf=e}(),function(){"use strict";let e=Polymer.dedupingMixin(e=>{let t=Polymer.ElementMixin(e);return class extends t{static get properties(){return{items:{type:Array},multi:{type:Boolean,value:!1},selected:{type:Object,notify:!0},selectedItem:{type:Object,notify:!0},toggle:{type:Boolean,value:!1}}}static get observers(){return["__updateSelection(multi, items.*)"]}constructor(){super(),this.__lastItems=null,this.__lastMulti=null,this.__selectedMap=null}__updateSelection(e,t){let n=t.path;if("items"==n){let n=t.base||[],r=this.__lastItems;if(e!==this.__lastMulti&&this.clearSelection(),r){let e=Polymer.ArraySplice.calculateSplices(n,r);this.__applySplices(e)}this.__lastItems=n,this.__lastMulti=e}else if("items.splices"==t.path)this.__applySplices(t.value.indexSplices);else{let e=n.slice("items.".length),t=parseInt(e,10);e.indexOf(".")<0&&e==t&&this.__deselectChangedIdx(t)}}__applySplices(e){let t=this.__selectedMap;for(let n=0;n<e.length;n++){let r=e[n];t.forEach((e,n)=>{e<r.index||(e>=r.index+r.removed.length?t.set(n,e+r.addedCount-r.removed.length):t.set(n,-1))});for(let e=0;e<r.addedCount;e++){let n=r.index+e;t.has(this.items[n])&&t.set(this.items[n],n)}}this.__updateLinks();let n=0;t.forEach((e,r)=>{e<0?(this.multi?this.splice("selected",n,1):this.selected=this.selectedItem=null,t.delete(r)):n++})}__updateLinks(){if(this.__dataLinkedPaths={},this.multi){let e=0;this.__selectedMap.forEach(t=>{t>=0&&this.linkPaths("items."+t,"selected."+e++)})}else this.__selectedMap.forEach(e=>{this.linkPaths("selected","items."+e),this.linkPaths("selectedItem","items."+e)})}clearSelection(){this.__dataLinkedPaths={},this.__selectedMap=new Map,this.selected=this.multi?[]:null,this.selectedItem=null}isSelected(e){return this.__selectedMap.has(e)}isIndexSelected(e){return this.isSelected(this.items[e])}__deselectChangedIdx(e){let t=this.__selectedIndexForItemIndex(e);if(t>=0){let e=0;this.__selectedMap.forEach((n,r)=>{t==e++&&this.deselect(r)})}}__selectedIndexForItemIndex(e){let t=this.__dataLinkedPaths["items."+e];if(t)return parseInt(t.slice("selected.".length),10)}deselect(e){let t=this.__selectedMap.get(e);if(t>=0){let n;this.__selectedMap.delete(e),this.multi&&(n=this.__selectedIndexForItemIndex(t)),this.__updateLinks(),this.multi?this.splice("selected",n,1):this.selected=this.selectedItem=null}}deselectIndex(e){this.deselect(this.items[e])}select(e){this.selectIndex(this.items.indexOf(e))}selectIndex(e){let t=this.items[e];this.isSelected(t)?this.toggle&&this.deselectIndex(e):(this.multi||this.__selectedMap.clear(),this.__selectedMap.set(t,e),this.__updateLinks(),this.multi?this.push("selected",t):this.selected=this.selectedItem=t)}}});Polymer.ArraySelectorMixin=e;let t=e(Polymer.Element);class n extends t{static get is(){return"array-selector"}}customElements.define(n.is,n),Polymer.ArraySelector=n}(),function(){"use strict";const e="include",t=window.ShadyCSS.CustomStyleInterface;class n extends HTMLElement{constructor(){super(),this._style=null,t.addCustomStyle(this)}getStyle(){if(this._style)return this._style;const t=this.querySelector("style");if(!t)return null;this._style=t;const n=t.getAttribute(e);return n&&(t.removeAttribute(e),t.textContent=Polymer.StyleGather.cssFromModules(n)+t.textContent),this.ownerDocument!==window.document&&window.document.head.appendChild(this),this._style}}window.customElements.define("custom-style",n),Polymer.CustomStyle=n}(),function(){"use strict";let e;e=Polymer.MutableData._mutablePropertyChange,Polymer.MutableDataBehavior={_shouldPropertyChange(t,n,r){return e(this,t,n,r,!0)}},Polymer.OptionalMutableDataBehavior={properties:{mutableData:Boolean},_shouldPropertyChange(t,n,r){return e(this,t,n,r,this.mutableData)}}}(),Polymer.Base=Polymer.LegacyElementMixin(HTMLElement).prototype,Polymer.html=Polymer.html,function(){var e,t,n,r=[].slice,i=Array.from||function(e){return r.call(e)};function s(e,t,n,r,i){var s,o;s=document.createElement("div"),n?(s.innerHTML="<b></b><br>",s.querySelector("b").textContent=t,s.insertAdjacentText("beforeend",n)):s.insertAdjacentText("beforeend",t),o=csw.functions.notify(s,e,"right",r),i&&o.addEventListener("click",i)}function o(t,n,r,i){return new Promise(function(o){var a,c;"number"==typeof r&&(i=r,r=""),document.hasFocus()||!Notification||"denied"===Notification.permission?s(t,n,r,i,o):"default"===Notification.permission?(a||(a=!0,c=e?"Application tried to show you a system notification while was inactive, but you have to grant permission for that first, do that after clicking on this notification":"Website tried to show you a desktop notification while was inactive, but you have to grant permission for that first, do that after clicking on this notification",csw.functions.notify(c,"warning","right").addEventListener("click",function(){Notification.requestPermission().then(function(e){switch(e){case"granted":csw.functions.notify("You will no longer miss important notifications ","success","right",3);break;case"denied":csw.functions.notify("In case you change your mind, desktop notifications can be re-enabled in browser settings ","success","right",5)}})})),s(t,n,r,i,o)):function(e,t,n,r){var i;i=new Notification(e,{body:t}),r&&i.addEventListener("click",r),n&&setTimeout(function(){i.close()},1e3*n)}(n,r,i,o)})}e="?home"===location.search,Polymer.setPassiveTouchGestures(!0),"serviceWorker"in navigator&&window.detox_sw_path&&require(["@detox/chat"]).then(function(t){t[0].ready(function(){navigator.serviceWorker.register(detox_sw_path).then(function(t){t.onupdatefound=function(){var n;(n=t.installing).onstatechange=function(){switch(n.state){case"installed":navigator.serviceWorker.controller?e?detox_chat_app.notify_success("Application was updated in background and new version ready to be used, restart to enjoy it",10):detox_chat_app.notify_success("Website was updated in background and new version ready to be used, refresh page to enjoy it",10):e?detox_chat_app.notify_success("Application is ready to work offline",10):detox_chat_app.notify_success("Website is ready to work offline",10);break;case"redundant":console.error("The installing service worker became redundant")}}},window.detox_service_worker_registration=t}).catch(function(e){console.error("Error during service worker registration:",e)})})}),null!=(t=navigator.storage)&&t.persist?navigator.storage.persisted().then(function(e){e||(console.info("Persistent storage is not yet granted, requesting..."),navigator.storage.persist().then(function(e){e?console.info("Persistent storage granted"):console.warn("Persistent storage denied, data may be lost under storage pressure")}))}):console.warn("Persistent storage not supported, data may be lost under storage pressure"),(n=window.detox_chat_app||(window.detox_chat_app={})).notify_error=function(){return o.apply(null,["error"].concat(i(arguments)))},n.notify=function(){return o.apply(null,[""].concat(i(arguments)))},n.notify_success=function(){return o.apply(null,["success"].concat(i(arguments)))},n.notify_warning=function(){return o.apply(null,["warning"].concat(i(arguments)))},n.simple_modal=function(t){var n,r;return n=+new Date,(r=csw.functions.simple_modal(t)).addEventListener("close",function(){history.state===n&&history.back()}),e&&(history.pushState(n,"","#modal"),window.addEventListener("popstate",function(){r.close()},{once:!0})),r},e&&(history.pushState({loaded:!0},""),addEventListener("popstate",function(){var e;null!=(e=history.state)&&e.loaded||(csw.functions.notify("Press one more time to exit","bottom",2),setTimeout(function(){history.pushState({loaded:!0},"")},2e3))}))}.call(this),function(){window.csw||(window.csw={}),csw.behaviors||(csw.behaviors={}),csw.functions||(csw.functions={})}.call(this),function(){csw.behaviors.button={properties:{active:{notify:!0,reflectToAttribute:!0,type:Boolean},empty:{reflectToAttribute:!0,type:Boolean},iconBefore:{type:String},iconAfter:{type:String},icon:{type:String},primary:{reflectToAttribute:!0,type:Boolean}},ready:function(){var e;this.empty=!this.firstElementChild.childNodes.length,(e=this.iconBefore||this.icon)&&this.firstElementChild.insertAdjacentHTML("afterbegin",'<csw-icon icon="'+e+'" mono></csw-icon> '),this.iconAfter&&this.firstElementChild.insertAdjacentHTML("beforeend",' <csw-icon icon="'+this.iconAfter+'" mono></csw-icon>')}}}.call(this),function(){var e;(e=csw.functions).modal=function(e){var t;return t=document.createElement("csw-modal"),"string"==typeof e||e instanceof Function?t.innerHTML=e:"jquery"in e?e.appendTo(t):t.appendChild(e),document.documentElement.appendChild(t),t},e.simple_modal=function(e){var t;return(t=csw.functions.modal(e)).autoDestroy=!0,t.open(),t},e.alert=function(e){return e instanceof Function&&(e=e.toString()),"string"==typeof e&&-1===e.indexOf("<")&&(e="<h3>"+e+"</h3>"),new Promise(function(t){var n,r,i,s,o,a;(n=r=csw.functions.modal(e)).autoDestroy=!0,n.manualClose=!0,(i=s=document.createElement("csw-button")).innerHTML="<button>OK</button>",i.primary=!0,i.action="close",i.bind=r,(o=s.firstElementChild).addEventListener("click",function(){t(),r.close()}),(a=r).ok=o,a.appendChild(s),a.open(),o.focus()})},e.confirm=function(e,t,n){var r,i,s,o,a,c,l,u;return e instanceof Function&&(e=e.toString()),"string"==typeof e&&-1===e.indexOf("<")&&(e="<h3>"+e+"</h3>"),(r=i=csw.functions.modal(e)).autoDestroy=!0,r.manualClose=!0,(s=o=document.createElement("csw-button")).innerHTML="<button>OK</button>",s.primary=!0,(a=o.firstElementChild).addEventListener("click",function(){"function"==typeof t&&t(),i.close()}),(c=document.createElement("csw-button")).innerHTML="<button>Cancel</button>",(l=c.firstElementChild).addEventListener("click",function(){"function"==typeof n&&n(),i.close()}),(u=i).ok=a,u.cancel=l,u.appendChild(o),u.appendChild(c),u.open(),a.focus(),t?i:new Promise(function(e,t){a.addEventListener("click",function(){e(),i.close()}),l.addEventListener("click",function(){t(),i.close()})})},e.prompt=function(e,t,n){var r,i,s,o;return e instanceof Function&&(e=e.toString()),"string"==typeof e&&-1===e.indexOf("<")&&(e="<h3>"+e+"</h3>"),((r=csw.functions.confirm(e+'\n<p><csw-input-text><input type="text"></csw-input-text></p>',function(){})).input=r.querySelector("input")).focus(),i=r.input,s=r.ok,o=r.cancel,t?(s.addEventListener("click",function(){t(i.value)}),o.addEventListener("click",function(){"function"==typeof n&&n()}),r):new Promise(function(e,t){s.addEventListener("click",function(){e(i.value)}),o.addEventListener("click",function(){t()})})},e.notify=function(e){var t,n,r,i,s,o,a;for(n=[],r=1,i=arguments.length;r<i;++r)n.push(arguments[r]);t=n,s=document.createElement("csw-notify"),"string"==typeof e||e instanceof Function?s.innerHTML=e:"jquery"in e?e.appendTo(s):s.appendChild(e),s.noIcon=!0;for(r=0,o=t.length;r<o;++r)switch(typeof(a=t[r])){case"string":s[a]=!0;break;case"number":s.timeout=a}return document.documentElement.insertBefore(s,document.querySelector(s.is)),s}}.call(this),function(){var e,t;e=new Promise(function(e){var t;window.WebComponents&&window.WebComponents.ready?setTimeout(e):(t=function(){setTimeout(e),document.removeEventListener("WebComponentsReady",t)},document.addEventListener("WebComponentsReady",t))}),t={},csw.behaviors.injectLightStyles=[{attached:function(){var n,r,i=this;this._styles_dom_module_added||(this._styles_dom_module_added=!0,t[this._styles_dom_module]?this.insertAdjacentHTML("beforeend","<style>"+t[this._styles_dom_module]+"</style>"):((n=document.querySelector("head")).insertAdjacentHTML("beforeend",'<custom-style><style include="'+this._styles_dom_module+'"></style></custom-style>'),r=n.lastElementChild,e.then(function(){Polymer.updateStyles(),t[i._styles_dom_module]=r.firstElementChild.textContent.split(":not(.style-scope)").join(""),n.removeChild(r),i.insertAdjacentHTML("beforeend","<style>"+t[i._styles_dom_module]+"</style>")})))}}]}.call(this),function(){csw.behaviors.label={properties:{active:{notify:!0,observer:"_active_changed",reflectToAttribute:!0,type:Boolean},value:{notify:!0,observer:"_value_changed",type:String}},attached:function(){var e,t,n,r,i,s,o=this;for((i=o.nextSibling)&&i.nodeType===Node.TEXT_NODE&&null!=(s=i.nextSibling)&&"function"==typeof s.matches&&s.matches(o.is)&&i.parentNode.removeChild(i),this.local_input=this.querySelector("input"),this.local_input.label=this,this.active=this.local_input.checked,e=this._get_inputs(),void 0!==this.value&&this._value_changed(this.value),t=0,n=e.length;t<n;++t)r=e[t],a.call(this,r);function a(e){var t=this;e.addEventListener("change",function(){"radio"===t.local_input.type?(t.value=e.value,t.active=t.local_input.value==e.value,t.local_input.checked=t.local_input.value==e.value):t.active=!t.active}),e.checked&&(this.value=e.value)}this.local_input.addEventListener("focus",function(){o.focus=!0}),this.local_input.addEventListener("blur",function(){o.focus=!1})},_get_inputs:function(){return this.local_input.name?this.parentNode.querySelectorAll('input[name="'+this.local_input.name+'"]'):this._inputs_around()},_inputs_around:function(){var e,t,n;for((e=[]).push(this.local_input),t=this;(t=t.previousElementSibling)&&t.matches(this.is)&&(n=t.querySelector("input"));)e.push(n);for(t=this;(t=t.nextElementSibling)&&t.matches(this.is)&&(n=t.querySelector("input"));)e.push(n);return e},_active_changed:function(e){void 0!==e&&this.local_input.checked!==e&&("radio"===this.local_input.type?e&&this.click():this.local_input.checked=e)},_value_changed:function(e){var t,n,r,i,s,o;if(void 0!==e&&this.local_input)for(t=0,r=(n=this._get_inputs()).length;t<r;++t)s=(i=n[t]).value==e,i.checked=s,null!=(o=i.label)&&(o.active=s)}}}.call(this),function(){csw.behaviors.ready={_when_ready:function(e){var t;window.WebComponents&&window.WebComponents.ready?setTimeout(e):(t=function(){setTimeout(e),document.removeEventListener("WebComponentsReady",t)},document.addEventListener("WebComponentsReady",t))}}}.call(this),function(){csw.behaviors.size={properties:{compact:{reflectToAttribute:!0,type:Boolean},fullWidth:{reflectToAttribute:!0,type:Boolean}}}}.call(this),function(){csw.behaviors.tight={properties:{tight:Boolean},ready:function(){this.tight&&(null!=this?this.nextSibling.nodeType:void 0)===Node.TEXT_NODE&&this.nextSibling.parentNode.removeChild(this.nextSibling)}}}.call(this),function(){csw.behaviors.this={properties:{this:{notify:!0,readOnly:!0,type:Object}},attached:function(){this.this||this._setThis(this)}}}.call(this),function(){var e;e=null,csw.behaviors.tooltip={properties:{tooltip:{observer:"_tooltip_changed",type:String}},attached:function(){var e=this;this.addEventListener("mouseover",function(){return function t(){e.removeEventListener("mouseover",t),e.tooltip&&e._tooltip_for_element(e)}}())},_tooltip_for_element:function(t){var n,r,i=this;this._tooltip_binding_added||(this._tooltip_binding_added=!0,this._initialize_tooltip(),t.tooltip=t.tooltip||t.getAttribute("tooltip"),n=this._schedule_show.bind(this,t),r=function(){i._cancel_schedule_show(),e._hide(t)},t.addEventListener("mousemove",n),t.addEventListener("pointermove",n),t.addEventListener("mouseleave",r),t.addEventListener("pointerleave",r),document.addEventListener("wheel",r,{passive:!0}),document.addEventListener("touchmove",r,{passive:!0}))},_initialize_tooltip:function(){e||(e=document.createElement("csw-tooltip"),document.documentElement.appendChild(e))},_schedule_show:function(t){this._cancel_schedule_show(),this.show_timeout=setTimeout(e._show.bind(e,t),e._for_element=this,100)},_cancel_schedule_show:function(){this.show_timeout&&clearTimeout(this.show_timeout)},_tooltip_changed:function(t){void 0!==t&&e&&e._for_element===this&&e._update_content(t)}}}.call(this),function(){csw.behaviors.value={ready:function(){var e;(e=this.firstElementChild).addEventListener("change",function(){this.dispatchEvent(new CustomEvent("value-changed"))}),e.addEventListener("input",function(){this.dispatchEvent(new CustomEvent("value-changed"))})}}}.call(this),function(){csw.behaviors.cswButton=[csw.behaviors.button,csw.behaviors.tight,csw.behaviors.tooltip,{properties:{action:String,bind:Object},listeners:{tap:"_tap"},_tap:function(){if(this.bind&&this.action)return this.bind[this.action]()}}]}.call(this),function(){csw.behaviors.cswDropdown=[{hostAttributes:{role:"group"},properties:{align:"left",opened:{reflectToAttribute:!0,type:Boolean},target:Object},created:function(){var e=this;document.addEventListener("keydown",function(t){27===t.keyCode&&e.opened&&(e.opened=!1)}),document.addEventListener("click",function(t){var n,r,i;if(e.opened){for(n=0,i=(r=t.composedPath()).length;n<i;++n)if(r[n]===e.target)return;e.close()}})},attached:function(){!this.target&&this.previousElementSibling.matches("csw-button")&&(this.target=this.previousElementSibling,this.target.action="toggle",this.target.bind=this)},toggle:function(){this.opened?this.close():this.open()},open:function(){var e;!this.opened&&this.target&&(e=this.target.getBoundingClientRect(),"left"===this.align?this.style.left=e.left+"px":this.style.right=document.documentElement.clientWidth-e.right-scrollX+"px",this.style.top=e.top+e.height+"px",this.opened=!0,this.fire("open"))},close:function(){this.opened&&(this.opened=!1,this.fire("close"))}}]}.call(this),function(){csw.behaviors.cswForm=[csw.behaviors.injectLightStyles,{_styles_dom_module:"csw-form-styles"}]}.call(this),function(){csw.behaviors.cswGroup=[{hostAttributes:{role:"group"},properties:{vertical:{reflectToAttribute:!0,type:Boolean}}}]}.call(this),function(){csw.behaviors.cswIcon=[csw.behaviors.tooltip,{observers:["_icon_changed(icon, flipX, flipY, mono, rotate, spin, spinStep)"],properties:{icon:{reflectToAttribute:!0,type:String},flipX:{reflectToAttribute:!0,type:Boolean,value:!1},flipY:{reflectToAttribute:!0,type:Boolean,value:!1},mono:{reflectToAttribute:!0,type:Boolean,value:!1},rotate:{reflectToAttribute:!0,type:Number,value:!1},spin:{reflectToAttribute:!0,type:Boolean,value:!1},spinStep:{reflectToAttribute:!0,type:Boolean,value:!1},multiple:{type:Boolean,value:!1},stacked1:String,stacked2:String,regular:String},_icon_changed:function(e,t,n,r,i,s,o){var a,c;e?(this.hidden&&(this.hidden=!1),a="",t&&(a+="fa-flip-horizontal "),n&&(a+="fa-flip-vertical "),r&&(a+="fa-fw "),i&&(a+="fa-rotate-"+i+" "),s&&(a+="fa-spin "),o&&(a+="fa-pulse "),a+="fa ",c=e.split(" "),this.multiple=c.length>1,this.multiple?(this.stacked1=a+this._full_icon_name(c[0])+" fa-stack-2x",this.stacked2=a+this._full_icon_name(c[1])+" fa-stack-1x fa-inverse"):this.regular=a+this._full_icon_name(c[0])):this.hidden=!0},_full_icon_name:function(e){var t;return"fab"===(t=e.split("-")[0])||"fa"===t||"fas"===t||"far"===t?e:"fab-"+e+" fa-"+e}}]}.call(this),function(){csw.behaviors.cswInputText=[csw.behaviors.size,csw.behaviors.tight,csw.behaviors.tooltip,csw.behaviors.value]}.call(this),function(){csw.behaviors.cswLabelButton=[csw.behaviors.label,csw.behaviors.tooltip,csw.behaviors.injectLightStyles,{_styles_dom_module:"csw-label-button-styles",properties:{first:{reflectToAttribute:!0,type:Boolean},last:{reflectToAttribute:!0,type:Boolean},primary:{reflectToAttribute:!0,type:Boolean}},ready:function(){var e,t;if((null!=(e=this.previousElementSibling)?e.is:void 0)!==this.is&&(this.first=!0),(null!=(t=this.nextElementSibling)?t.is:void 0)!==this.is&&(this.last=!0),this.querySelector("label").setAttribute("role","button"),this.querySelector("input").disabled)return this.querySelector("label").setAttribute("disabled","")}}]}.call(this),function(){csw.behaviors.cswLabelSwitcher=[csw.behaviors.label,csw.behaviors.tooltip,csw.behaviors.injectLightStyles,{_styles_dom_module:"csw-label-switcher-styles",attached:function(){this.querySelector("csw-icon")||(this.querySelector("input").insertAdjacentHTML("afterend",'<csw-icon icon="check" mono></csw-icon>'),this.querySelector("input").disabled&&this.querySelector("label").setAttribute("disabled",""))}}]}.call(this),function(){csw.behaviors.cswLinkButton=[csw.behaviors.button,csw.behaviors.tight,csw.behaviors.tooltip,{ready:function(){return this.querySelector("a").setAttribute("role","button")}}]}.call(this),function(){csw.behaviors.cswModal=[csw.behaviors.this,{properties:{asIs:{reflectToAttribute:!0,type:Boolean},autoDestroy:Boolean,autoOpen:Boolean,manualClose:Boolean,opened:{observer:"_opened_changed",type:Boolean}},listeners:{transitionend:"_transitionend"},_esc_handler:function(e){27!==e.keyCode||this.manualClose||this.close()},ready:function(){this._esc_handler=this._esc_handler.bind(this)},attached:function(){var e;null!=(e=this.previousElementSibling)&&e.matches("csw-button")&&!this.previousElementSibling.action&&(this.previousElementSibling.action="open",this.previousElementSibling.bind=this),this.autoOpen&&(this.autoOpen=!1,this.open())},_transitionend:function(){var e;!this.opened&&this.autoDestroy&&null!=(e=this.parentNode)&&e.removeChild(this)},_overlay_tap:function(){this.manualClose||this.close()},_opened_changed:function(e){var t,n,r=this;void 0!==e&&(null!=(t=this.parentNode)&&t.matches("html")||document.documentElement.appendChild(this),this.distributeContent(!0),Polymer.dom.flush(),(n=document.body).modalOpened=n.modalOpened||0,e?(document.addEventListener("keydown",this._esc_handler),this.content&&(this.innerHTML=this.content,this.content=null),++n.modalOpened,this.fire("open"),n.setAttribute("modal-opened",""),setTimeout(function(){r.setAttribute("opened","")},100)):(document.removeEventListener("keydown",this._esc_handler),--n.modalOpened,this.fire("close"),this.removeAttribute("opened"),n.modalOpened||n.removeAttribute("modal-opened")))},open:function(){return this.opened||(this.opened=!0),this},close:function(){return this.opened&&(this.opened=!1),this}}]}.call(this),function(){var e;e=new Promise(csw.behaviors.ready._when_ready),csw.behaviors.cswNotify=[csw.behaviors.ready,{properties:{bottom:{reflectToAttribute:!0,type:Boolean},content:String,error:{reflectToAttribute:!0,type:Boolean},left:{reflectToAttribute:!0,type:Boolean},noIcon:{reflectToAttribute:!0,type:Boolean},right:{reflectToAttribute:!0,type:Boolean},selectable:{reflectToAttribute:!0,type:Boolean},show:{reflectToAttribute:!0,type:Boolean},success:{reflectToAttribute:!0,type:Boolean},timeout:Number,top:{reflectToAttribute:!0,type:Boolean},warning:{reflectToAttribute:!0,type:Boolean}},attached:function(){this.last_node=this.parentNode,this.parentNode.matches("html")?(this.bottom||this.top||(this.top=!0),this.offsetLeft,this._show()):document.documentElement.insertBefore(this,document.querySelector(this.is))},_tap:function(e){this.selectable&&e.target!==this.$.content&&e.target!==this.$.icon||this._hide()},_show:function(){var t=this;e=e.then(function(){return t.content&&(t.innerHTML=t.content),t.show=!0,t._update_position(),t.fire("show"),new Promise(function(e){setTimeout(function(){t.timeout&&setTimeout(t._hide.bind(t),1e3*t.timeout),e()},t._transition_duration())})})},_hide:function(){var t=this;e=e.then(function(){return t.show=!1,t._update_position(),t.fire("hide"),new Promise(function(e){setTimeout(function(){var n;null!=(n=t.parentNode)&&n.removeChild(t),e()},t._transition_duration())})})},_get_similar:function(){var e,t,n,r,i;return e=this.is,t=this.bottom,n=this.left,r=this.right,i=this.top,Array.from(document.querySelector("html").children).filter(function(s){return s.is===e&&s.bottom===t&&s.left===n&&s.right===r&&s.top===i&&s.show})},_update_position:function(e){var t,n,r,i,s,o;for(n=0,r=(t=this._get_similar()).length;n<r;++n)i=n,s=t[n],o=t[i-1],s._update_own_position(o)},_update_own_position:function(e){var t,n,r;e?(t=parseFloat(e.style.marginBottom||0),n=parseFloat(getComputedStyle(e).height),r=parseFloat(e.style.marginTop||0)):(t=0,n=0,r=0),this.top?this.style.marginTop=r+n+"px":this.style.marginBottom=t+n+"px"},_transition_duration:function(){var e;return"ms"===(e=getComputedStyle(this).transitionDuration).substr(-2)?parseFloat(e):1e3*parseFloat(e)}}]}.call(this),function(){csw.behaviors.cswPagination=[{hostAttributes:{role:"group"},properties:{page:{notify:!0,reflectToAttribute:!0,type:Number},pages:{reflectToAttribute:!0,type:Number},pages_list:Array},_pages_list:function(e,t){var n,r,i,s;if(e&&t){if(n=[],r=this._render_one.bind(this,n,e),t<=11)for(i=1;i<=t;++i)r(i);else if(e<=6){for(i=1;i<=7;++i)r(i);for(r(0,"..."),i=t-2;i<=t;++i)r(i)}else if(e>=t-5){for(i=1;i<=3;++i)r(i);for(r(0,"..."),i=t-6;i<=t;++i)r(i)}else{for(i=1;i<=2;++i)r(i);for(r(0,"..."),i=e-2,s=e+2;i<=s;++i)r(i);for(r(0,"..."),i=t-1;i<=t;++i)r(i)}return n[0].first=!0,n[n.length-1].last=!0,n}},_render_one:function(e,t,n,r){e.push({text:r||n,active:n===t,disabled:!n})},_set_page:function(e){this.page=e.model.item.text},next:function(){this.page<this.pages&&this.page++},prev:function(){this.page>1&&this.page--}}]}.call(this),function(){csw.behaviors.cswProgress=[csw.behaviors.size,csw.behaviors.tight,csw.behaviors.tooltip,csw.behaviors.injectLightStyles,{_styles_dom_module:"csw-progress-styles",properties:{infinite:Boolean,primary:{reflectToAttribute:!0,type:Boolean},textProgress:{type:Boolean,value:!1},value:{observer:"_value_changed",reflectToAttribute:!0,type:Number}},attached:function(){var e,t,n=this;this.firstElementChild.getAttribute("max")||(this.firstElementChild.max=100),e=this.firstElementChild.getAttribute("value"),this.value?this.firstElementChild.setAttribute("value",this.value):this.value=e||0,this.infinite&&(t=function(){n.parentNode&&(n.value=(n.value+9)%n.firstElementChild.max,n.firstElementChild.value=n.value,setTimeout(t,200))})()},_value_changed:function(e){var t;void 0!==e&&null!=(t=this.firstElementChild)&&(t.value=e)}}]}.call(this),function(){csw.behaviors.cswSelect=[csw.behaviors.ready,csw.behaviors.size,csw.behaviors.tight,csw.behaviors.tooltip,csw.behaviors.value,csw.behaviors.injectLightStyles,{_styles_dom_module:"csw-select-styles",properties:{selected:{notify:!0,observer:"_selected_changed",type:Object}},ready:function(){var e,t=this;e=function(){var n,r,i,s,o,a;if(t._select=t.firstElementChild,t._select.addEventListener("value-changed",(s=t,o="_value_changed",function(){return(a||s)[o].apply(s,arguments)})),void 0===t.selected&&(t.selected=t._select.value),clearTimeout(n),n=setTimeout(function(){t.removeEventListener("dom-change",e),void 0!==t.selected&&t._selected_changed(t.selected)},100),!t._height_updated)if(t._select.size<=1)t._height_updated=!0;else{if(t.querySelectorAll("option").length){if(0===(r=t.querySelector("option").getBoundingClientRect().height*t._select.size))return;t._height_updated=!0,i=parseFloat(getComputedStyle(t._select).fontSize),t._select.style.height="calc("+r+"em / "+i+")"}t._scroll_to_selected()}},this.addEventListener("dom-change",e)},_scroll_to_selected:function(){var e,t;(e=this.querySelector("option"))&&(t=e.getBoundingClientRect().height,this._select.size>1&&this._select.selectedOptions[0]&&(this._select.scrollTop=t*(this._select.selectedIndex-Math.floor(this._select.size/2))+this._number_of_optgroups()),this._select.getBoundingClientRect().height>=t*(this.querySelectorAll("option").length+this.querySelectorAll("optgroup").length)&&(this._select.style.overflowY="auto"))},_number_of_optgroups:function(){var e,t;if(t=0,(e=this._select.selectedOptions[0].parentNode).matches("optgroup"))for(;e;)++t,e=e.previousElementSibling;return t},_value_changed:function(){var e;e=[],Array.prototype.forEach.call(this._select.selectedOptions,function(t){return e.push(t.value)}),this._select.multiple||(e=e[0]),this.set("selected",e)},_selected_changed:function(e){void 0!==e&&(e=e instanceof Array?e.map(String):String(e),Array.prototype.forEach.call(this.querySelectorAll("option"),function(t){return t.selected=e===t.value||e instanceof Array&&-1!==e.indexOf(t.value)}),this.fire("selected"))}}]}.call(this),function(){csw.behaviors.cswSwitcher=[{properties:{selected:{notify:!0,observer:"_selected_changed",type:Number}},ready:function(){var e,t,n;for(e=0,n=(t=this.children).length;e<n;++e)if(t[e].active)return;this.selected||(this.selected=0)},_selected_changed:function(e){var t,n,r,i,s;if(void 0!==e)for(t=0,r=(n=this.children).length;t<r;++t)i=t,(s=n[t]).matches("template")||(s.active=i===e,i===e?s.setAttribute("active",""):s.removeAttribute("active"))}}]}.call(this),function(){csw.behaviors.cswTabs=[{hostAttributes:{role:"group"},properties:{selected:{notify:!0,observer:"_selected_changed",type:Number}},listeners:{tap:"_tap"},ready:function(){var e,t,n;for(e=0,n=(t=this.children).length;e<n;++e)if(t[e].active)return;this.selected||(this.selected=0)},_tap:function(e){var t,n,r,i,s,o,a=this;if(t=function(){var t,n,r,i;for(t=0,r=(n=e.composedPath()).length;t<r;++t)if(i=t,n[t]===a)return e.composedPath()[i-3]}())for(n=0,i=(r=this.children).length;n<i;++n)s=n,(o=r[n]).matches("template")||(o===t?(this.selected=s,o.setAttribute("active","")):o.removeAttribute("active"))},_selected_changed:function(e){var t,n,r,i,s;if(void 0!==e){for(t=0,r=(n=this.children).length;t<r;++t)i=t,(s=n[t]).matches("template")||(s.active=i===e,i===e?s.setAttribute("active",""):s.removeAttribute("active"));null!=(n=this.nextElementSibling)&&"function"==typeof n.matches&&n.matches("csw-switcher")&&(this.nextElementSibling.selected=e)}}}]}.call(this),function(){function e(e,t,n){return function(){return(n||e)[t].apply(e,arguments)}}csw.behaviors.cswTextarea=[csw.behaviors.ready,csw.behaviors.size,csw.behaviors.tooltip,csw.behaviors.value,{properties:{autosize:{observer:"_autosize_changed",reflectToAttribute:!0,type:Boolean},initialized:Boolean},attached:function(){this.initialized=!0,this._when_ready(e(this,"_do_autosizing"))},_autosize_changed:function(){this._do_autosizing()},_do_autosizing:function(){this.initialized&&void 0!==this.autosize&&(window.autosize?this._do_autosizing_callback(autosize):window.require&&require(["autosize"],e(this,"_do_autosizing_callback")))},_do_autosizing_callback:function(e){void 0!==e&&(e?(e(this.firstElementChild),e.update(this.firstElementChild)):e.destroy(this.firstElementChild))}}]}.call(this),function(){csw.behaviors.cswTooltip=[csw.behaviors.tooltip,{properties:{selectable:{reflectToAttribute:!0,type:Boolean},show:{reflectToAttribute:!0,type:Boolean},showQuick:{reflectToAttribute:!0,type:Boolean},top:{reflectToAttribute:!0,type:Boolean}},listeners:{mouseenter:"_self_show",pointerenter:"_self_show",mouseleave:"_self_hide",pointerleave:"_self_hide"},attached:function(){var e,t=this;(e=this.parentNode).matches("html")?document.addEventListener("keydown",function(e){27===e.keyCode&&t.show&&(t.show=!1)}):(e.removeChild(this),e.addEventListener("mouseover",function(){return function n(){e.removeEventListener("mouseover",n),t._tooltip_for_element(e)}}()))},_self_show:function(){this.selectable&&(this.show=!0)},_self_hide:function(){this.selectable&&this._hide()},_show:function(e){var t,n,r;e.tooltip&&!this.show&&(this._update_content(e.tooltip),t=this._get_tooltip_position(e),(n=this.style).top=t.top+"px",n.left=t.left+"px",this.top=t.arrow_top,(r=this.$.arrow.style).left=-t.arrow_left_offset+"px",r.right=t.arrow_left_offset+"px",this.show=!0)},_hide:function(){this.show=!1},_get_tooltip_position:function(e){var t,n,r,i,s;return this.showQuick=!0,Polymer.flush(),t=this.getBoundingClientRect(),n=e.getBoundingClientRect(),r={top:scrollY,left:scrollX,arrow_top:!1,arrow_left_offset:0},i=document.documentElement.clientWidth,this.showQuick=!1,n.top>t.height?r.top+=n.top-t.height:(r.arrow_top=!0,r.top+=n.bottom),(s=n.left+n.width/2-t.width/2)>=0?s+t.width<=i?r.left+=s:(r.left+=i-t.width,r.arrow_left_offset=i-t.width/2-n.left-n.width/2):r.arrow_left_offset=t.width/2-n.left-n.width/2,r},_update_content:function(e){this.innerHTML!==e&&(this.innerHTML=e)}}]}.call(this),function(){Polymer({is:"csw-button",behaviors:csw.behaviors.cswButton})}.call(this),function(){Polymer({is:"csw-dropdown",behaviors:csw.behaviors.cswDropdown})}.call(this),function(){Polymer({is:"csw-form",behaviors:csw.behaviors.cswForm})}.call(this),function(){Polymer({is:"csw-group",behaviors:csw.behaviors.cswGroup})}.call(this),function(){Polymer({is:"csw-icon",behaviors:csw.behaviors.cswIcon})}.call(this),function(){Polymer({is:"csw-input-text",behaviors:csw.behaviors.cswInputText})}.call(this),function(){Polymer({is:"csw-label-button",behaviors:csw.behaviors.cswLabelButton})}.call(this),function(){Polymer({is:"csw-label-switcher",behaviors:csw.behaviors.cswLabelSwitcher})}.call(this),function(){Polymer({is:"csw-link-button",behaviors:csw.behaviors.cswLinkButton})}.call(this),function(){Polymer({is:"csw-modal",behaviors:csw.behaviors.cswModal})}.call(this),function(){Polymer({is:"csw-notify",behaviors:csw.behaviors.cswNotify})}.call(this),function(){Polymer({is:"csw-pagination",behaviors:csw.behaviors.cswPagination})}.call(this),function(){Polymer({is:"csw-progress",behaviors:csw.behaviors.cswProgress})}.call(this),function(){Polymer({is:"csw-select",behaviors:csw.behaviors.cswSelect})}.call(this),function(){Polymer({is:"csw-switcher",behaviors:csw.behaviors.cswSwitcher})}.call(this),function(){Polymer({is:"csw-tabs",behaviors:csw.behaviors.cswTabs})}.call(this),function(){Polymer({is:"csw-textarea",behaviors:csw.behaviors.cswTextarea})}.call(this),function(){Polymer({is:"csw-tooltip",behaviors:csw.behaviors.cswTooltip})}.call(this),function(){require(["@detox/chat","@detox/core","@detox/utils","swipe-listener","js/behaviors"]).then(function(e){var t,n,r,i,s,o,a,c;t=e[0],n=e[1],r=e[2],i=e[3],s=e[4],o=r.are_arrays_equal,a=r.timeoutSet,c=r.ArrayMap,Polymer({is:"detox-chat-app",behaviors:[s.state_instance],properties:{sidebar_shown:{type:Boolean,value:!1}},created:function(){this.state.get_settings_online()&&this._connect_to_the_network()},ready:function(){var e,t=this;e=this.state,this.sidebar_shown=e.get_ui_sidebar_shown(),e.on("ui_sidebar_shown_changed",function(e){t.sidebar_shown=e}),i(this),this.addEventListener("swipe",function(e){var t;(t=e.detail.directions).left&&this.state.set_ui_sidebar_shown(!1),t.right&&e.detail.x[0]<=document.documentElement.clientWidth/8&&this.state.set_ui_sidebar_shown(!0)})},_connect_to_the_network:function(){var e=this;t.ready(function(){var r,i,s,l,u,h;function d(e){var t,n;(t=r.get(e)).received&&t.sent&&(l.add_online_contact(e),(n=l.get_nickname())&&h.nickname(e,n),l.get_contact_messages_to_be_sent(e).then(function(t){var n,r,i;for(n=0,r=t.length;n<r;++n)i=t[n],f(e,i)}))}function f(e,t){var n;n=h.text_message(e,t.date_written,t.text),i.has(e)||i.set(e,new Map),i.get(e).set(n,t.id)}function _(e){var t;(t=l.get_contact(e))&&l.get_contact_messages_to_be_sent(e).then(function(n){var r,i,o,c,u,d,f;if(n.length&&t.local_secret&&(s.has(e)||s.set(e,{trial:0,timeout:null}),!(r=s.get(e)).timeout))for(++r.trial,i=0,c=(o=l.get_settings_reconnects_intervals()).length;i<c;++i)if(d=(u=o[i])[0],f=u[1],r.trial<=d){r.timeout=a(f,_);break}function _(){r.timeout=null,h.connect_to(e,t.remote_secret)}})}r=c(),i=c(),s=c(),l=e.state,u=n.Core(n.generate_seed(),l.get_settings_bootstrap_nodes(),l.get_settings_ice_servers(),l.get_settings_packets_per_second(),l.get_settings_bucket_size()),h=t.Chat(u,l.get_seed(),l.get_settings_number_of_introduction_nodes(),l.get_settings_number_of_intermediate_nodes()),u.once("ready",function(){var e,t,n;for(l.set_online(!0),l.get_settings_announce()&&h.announce(),e=0,n=(t=l.get_contacts()).length;e<n;++e)_(t[e].id)}).on("connected_nodes_count",function(e){l.set_connected_nodes_count(e)}).on("aware_of_nodes_count",function(e){l.set_aware_of_nodes_count(e)}).on("routing_paths_count",function(e){l.set_routing_paths_count(e)}).on("application_connections_count",function(e){l.set_application_connections_count(e)}),h.once("announced",function(){l.set_announced(!0)}).on("introduction",function(e,t){var n,r,i,s,a,c,u;if(n=l.get_contact(e))return!!(!n.local_secret||o(t,n.local_secret)||n.old_local_contact&&o(t,n.old_local_secret));if(!l.has_contact_request_blocked(e)){for(r=t.length,i=0,a=(s=l.get_secrets()).length;i<a;++i)if(c=s[i],(u=new Uint8Array(r)).set(c.secret),o(t,u)&&!l.has_contact_request(e)){l.add_contact_request(e,c.secret);break}return!1}}).on("connected",function(e){var n,i;s.has(e)&&((n=s.get(e)).timeout&&clearTimeout(n.timeout),s.delete(e)),l.has_contact(e)&&(r.set(e,{received:!1,sent:!1}),i=t.generate_secret(),l.set_contact_local_secret(e,i),h.secret(e,i))}).on("connection_failed",function(e){_(e)}).on("secret",function(e,t){var n;return n=l.get_contact(e),!o(t,n.remote_secret)&&(l.set_contact_remote_secret(e,t),r.get(e).received=!0,d(e),!0)}).on("secret_received",function(e){l.del_contact_old_local_secret(e),r.get(e).sent=!0,d(e)}).on("nickname",function(e,t){(t=t.trimLeft())&&l.set_contact_nickname(e,t)}).on("text_message",function(e,t,n,r){(r=r.trim())&&l.get_contact_messages(e).then(function(i){var s,o,a;for(s=i.length-1;s>=0;--s)if((o=i[s]).origin===l.MESSAGE_ORIGIN_RECEIVED){a=o;break}a&&(a.date_sent>n||a.date_written>=t)||l.add_contact_message(e,l.MESSAGE_ORIGIN_RECEIVED,t,n,r)})}).on("text_message_received",function(e,t){var n,r;(n=null!=(r=i.get(e))?r.get(t):void 0)&&(i.get(e).delete(t),l.set_contact_message_sent(e,n,t))}).on("disconnected",function(e){r.delete(e),i.delete(e),l.del_online_contact(e),_(e)}),l.on("contact_added",function(e){h.connect_to(e.id,e.remote_secret)}).on("contact_message_added",function(e,t){var n;if(t.origin===l.MESSAGE_ORIGIN_RECEIVED||!l.has_online_contact(e))return n=l.get_contact(e),void h.connect_to(e,n.remote_secret);f(e,t)}).on("nickname_changed",function(e){var t,n,r,i;if(e=e.trim())for(t=0,r=(n=l.get_online_contacts()).length;t<r;++t)i=n[t],h.nickname(i,e)}),e._core_instance=u,e._chat_instance=h})},_hide_sidebar:function(){this.state.set_ui_sidebar_shown(!1)},_sidebar_click:function(e){e.clientX>this.$.sidebar.clientWidth&&this._hide_sidebar()}})})}.call(this),function(){require(["@detox/utils","hotkeys-js","js/behaviors","js/markdown"]).then(function(e){var t,n,r,i;t=e[0],n=e[1],r=e[2],i=e[3],Polymer({is:"detox-chat-app-dialogs",behaviors:[r.state_instance,Polymer.MutableDataBehavior],properties:{active_contact:{type:Boolean,value:!1},contact:Object,messages:Array,send_ctrl_enter:Boolean,text_message:{type:String,value:""},unread_messages:Boolean},created:function(){this._ctrl_enter_handler=this._ctrl_enter_handler.bind(this),this._enter_handler=this._enter_handler.bind(this)},ready:function(){var e,n,r,i,s=this;e=t.are_arrays_equal,n=t.ArrayMap,r=n(),i=this.state,this.active_contact=!!i.get_ui_active_contact(),this.send_ctrl_enter=i.get_settings_send_ctrl_enter(),this._update_unread_messages(),i.on("contact_message_added",function(t,n){var r,s,o,a;r=i.get_ui_active_contact(),n.origin!==i.MESSAGE_ORIGIN_RECEIVED||document.hasFocus()&&r&&e(t,r)||(s=i.get_contact(t),(o=document.createElement("div")).innerHTML=n.text,a=function e(t){var n;return(n=t.childNodes).length?function(){var r,i,s,o=[];for(r=0,s=(i=n).length;r<s;++r)t=i[r],o.push(e(t));return o}().map(function(e){return e.trim()}).filter(Boolean).join(" "):t.textContent.trim()}(o),detox_chat_app.notify(s.nickname,a.length>60?a.substr(0,60)+"...":a,7).then(function(){i.set_ui_active_contact(t)}))}).on("contact_messages_changed",function(t){var n,r,o;(n=i.get_ui_active_contact())&&e(t,n)&&(r=s.$["messages-list"],o=r.scrollHeight-r.offsetHeight===r.scrollTop,i.get_contact_messages(t).then(function(e){s.messages=e,s.notifyPath("messages"),o&&(s.$["messages-list-template"].render(),r.scrollTop=r.scrollHeight-r.offsetHeight)}))}).on("contact_changed",function(t){var n;null!=(n=s.contact)&&n.id&&e(s.contact.id,t.id)&&(s.contact=t)}).on("contact_deleted",function(e){r.delete(e.id)}).on("contacts_with_unread_messages_changed",function(){s._update_unread_messages()}).on("ui_active_contact_changed",function(e,t){var n;if((n=s.text_message.trim())&&t&&(r.set(t,n),s.text_message=""),e&&r.has(e)&&(s.text_message=r.get(e),r.delete(e)),!e)return s.active_contact=!1,s.contact={},void(s.messages=[]);s.active_contact=!0,s.contact=i.get_contact(e),i.get_contact_messages(e).then(function(e){var t;s.messages=e,s.notifyPath("messages"),s.$["messages-list-template"].render(),(t=s.$["messages-list"]).scrollTop=t.scrollHeight-t.offsetHeight,s._update_unread_messages()})}).on("settings_send_ctrl_enter_changed",function(e){s.send_ctrl_enter=e})},attached:function(){n("Ctrl+Enter",this._ctrl_enter_handler),n("Enter",this._enter_handler)},detached:function(){n.unbind("Ctrl+Enter",this._ctrl_enter_handler),n.unbind("Enter",this._enter_handler)},_ctrl_enter_handler:function(e){e.composedPath()[0]===this.$.textarea&&(this._send(),e.preventDefault())},_enter_handler:function(e){e.composedPath()[0]!==this.$.textarea||this.send_ctrl_enter||(this._send(),e.preventDefault())},_update_unread_messages:function(){var e;e=this.state,this.unread_messages=!!e.get_contacts_with_unread_messages().filter(function(t){return t!==e.get_ui_active_contact()}).length},_show_sidebar:function(){this.state.set_ui_sidebar_shown(!0)},_send_placeholder:function(e){return"Type you message here, Markdown (GFM) supported!\n"+(e?"Enter for new line, Ctrl+Enter for sending":"Shift+Enter for new line, Enter for sending")},_send:function(){var e,t,n;(e=this.text_message.trim())&&(this.text_message="",n=(t=this.state).get_ui_active_contact(),t.add_contact_message(n,t.MESSAGE_ORIGIN_SENT,+new Date,0,e))},_markdown_renderer:function(e){return i(e)},_format_date:function(e){return e?e-new Date<864e5?new Date(e).toLocaleTimeString():new Date(e).toLocaleString():"Not yet"},_message_origin:function(e){switch(e.origin){case this.state.MESSAGE_ORIGIN_SENT:return"sent";case this.state.MESSAGE_ORIGIN_RECEIVED:return"received";case this.state.MESSAGE_ORIGIN_SERVICE:return"service"}},_help_insecure:function(){detox_chat_app.simple_modal("<p>Don't get this message wrong, Detox Chat in particular and Detox network in general are built with security and anonymity in mind from the beginning.</p>\n<p>However, until independent security audit is conducted and proved that the application is indeed secure, you shouldn't trust it critical data.</p>")},_not_implemented:function(){csw.functions.alert("Yeah, I'd like to use this too, but it is not yet implemented, get back in future updates")}})})}.call(this),function(){require(["@detox/chat","@detox/crypto","@detox/utils","js/behaviors"]).then(function(e){var t,n,r,i;t=e[0],n=e[1],r=e[2],i=e[3],Polymer({is:"detox-chat-app-sidebar-contacts",behaviors:[i.experience_level,i.help,i.state_instance],properties:{add_contact:{type:Boolean,value:!1},contacts:{type:Array,value:[]},contacts_requests:{type:Array,value:[]},contacts_with_pending_messages:Object,contacts_with_unread_messages:Object,new_contact_id:{type:String,value:""},new_contact_name:{type:String,value:""},online_contacts:{type:Object},ui_active_contact:{type:Object}},ready:function(){var e,t,n,i,s,o=this;e=r.ArraySet,t=this.state,this.contacts=t.get_contacts(),this.online_contacts=e(t.get_online_contacts()),this.contacts_requests=t.get_contacts_requests(),this.contacts_with_pending_messages=e(t.get_contacts_with_pending_messages()),this.contacts_with_unread_messages=e(t.get_contacts_with_unread_messages()),this.ui_active_contact=e([t.get_ui_active_contact()||new Uint8Array(0)]),t.on("contacts_changed",function(){o.contacts=t.get_contacts()}).on("online_contacts_changed",function(){o.online_contacts=e(t.get_online_contacts())}).on("contact_request_added",function(){detox_chat_app.notify_warning("Incoming contact request received",7)}).on("contacts_requests_changed",function(){var e;e=t.get_contacts_requests(),o.contacts_requests=e}).on("contacts_with_pending_messages_changed",function(){o.contacts_with_pending_messages=e(t.get_contacts_with_pending_messages())}).on("contacts_with_unread_messages_changed",function(){o.contacts_with_unread_messages=e(t.get_contacts_with_unread_messages())}).on("ui_active_contact_changed",function(){o.ui_active_contact=e([t.get_ui_active_contact()||new Uint8Array(0)])}),navigator.registerProtocolHandler&&(n=location.href.split("?")[0],navigator.registerProtocolHandler("web+detoxchat",n+"?contact=%s","Detox Chat")),location.search&&(i=new URL(location.href).searchParams.get("contact"))&&i.startsWith("web+detoxchat:")&&(s=i.substr("web+detoxchat".length+1).split("+"),this.add_contact=!0,this.new_contact_id=s[0],this.new_contact_name=decodeURIComponent(s.slice(1).join(" ")),detox_chat_app.notify_success("Contact addition form is filled, confirm if you want to proceed",5))},_hide_header:function(e,t){return!e.length||t},_add_contact:function(){this.add_contact=!0},_add_contact_confirm:function(){var e=this;t.ready(function(){var i,s,o,a,c;try{if(s=(i=t.id_decode(e.new_contact_id))[0],o=i[1],a=n.create_keypair(e.state.get_seed()).ed25519.public,r.are_arrays_equal(s,a))return void detox_chat_app.notify_error("Adding yourself to contacts is not supported",3);if(c=e.state.get_contact(s))return void detox_chat_app.notify_warning('Not added: this contact is already in contacts list under nickname "'+c.nickname+'"',3);e.state.add_contact(s,e.new_contact_name||e.new_contact_id,o),detox_chat_app.notify_success("Contact added","You can already send messages and they will be delivered when/if contact request is accepted",5),e.add_contact=!1,e.new_contact_id="",e.new_contact_name=""}catch(e){e,detox_chat_app.notify_error("Incorrect ID, check for typos and try again",3)}})},_add_contact_cancel:function(){this.add_contact=!1},_help:function(){var e;e=this.advanced_user?"<p>You need to add contact using their ID in order to communicate.</p>\n<p>There are 2 kinds of IDs: without secrets and with secrets. Look at <i>Profile</i> tab for more details on those.</p>\n<p>Each contact in the list might have some of the corners highlighted, which indicates some information about its state.</p>\n<p>Top left corner is highlighted when there is an active connection to contact right now.<br>\nBottom left corner is highlighted means that there was never an active connection, for instance you've added someone to contacts, but they didn't accept request (yet).<br>\nTop right corner is highlighted when there are unread messages from that contact.<br>\nBottom right corner is highlighted when your last message to contact was not yet received (just received, there is no indication if it was read by contact).</p>":"<p>You need to add contact using their ID in order to communicate.</p>\n<p>Your ID can be found in <i>Profile</i> tab.</p>\n<p>Each contact in the list might have some of the corners highlighted, which indicates some information about its state.</p>\n<p>Top left corner is highlighted when there is an active connection to contact right now.<br>\nBottom left corner is highlighted means that there was never an active connection, for instance you've added someone to contacts, but they didn't accept request (yet).<br>\nTop right corner is highlighted when there are unread messages from that contact.<br>\nBottom right corner is highlighted when your last message to contact was not yet received (just received, there is no indication if it was read by contact).</p>",detox_chat_app.simple_modal(e)},_set_active_contact:function(e){var t;(t=this.state).set_ui_active_contact(e.model.item.id),t.set_ui_sidebar_shown(!1)},_rename_contact:function(e){var t=this;csw.functions.prompt("New nickname:",function(n){t.state.set_contact_nickname(e.model.item.id,n),detox_chat_app.notify_success("Nickname updated",3)}).input.value=e.model.item.nickname,e.stopPropagation()},_del_contact:function(e){var t=this;csw.functions.confirm("<h3>Are you sure you want to delete contact <i>"+e.model.item.nickname+"</i>?</h3>",function(){t.state.del_contact(e.model.item.id)}),e.stopPropagation()},_accept_contact_request:function(e){var t,n,r,i;t=this.state,n=e.model.item,r=this.advanced_user?"<h3>What do you want to do with contact request?</h3>\n<p>ID: <i>"+n.name+"</i></p>\n<p>Secret used: <i>"+n.secret_name+'</i></p>\n<csw-group>\n\t<csw-button primary><button id="accept">Accept</button></csw-button>\n\t<csw-button><button id="reject">Reject</button></csw-button>\n\t<csw-button><button id="cancel">Cancel</button></csw-button>\n</csw-group>':"<h3>What do you want to do with contact request?</h3>\n<p>ID: <i>"+n.name+'</i></p>\n<csw-group>\n\t<csw-button primary><button id="accept">Accept</button></csw-button>\n\t<csw-button><button id="reject">Reject</button></csw-button>\n\t<csw-button><button id="cancel">Cancel</button></csw-button>\n</csw-group>',(i=csw.functions.simple_modal(r)).querySelector("#accept").addEventListener("click",function(){t.add_contact(n.id,n.name,new Uint8Array(0)),t.del_contact_request(n.id),i.close(),detox_chat_app.notify_success("Contact added",3)}),i.querySelector("#reject").addEventListener("click",function(){t.del_contact_request(n.id),i.close(),detox_chat_app.notify_warning("Contact request rejected",3)}),i.querySelector("#cancel").addEventListener("click",function(){i.close()})},_online:function(e,t){return t.has(e.id)},_selected:function(e,t){return t.has(e.id)},_unconfirmed:function(e){return!e.local_secret},_unread:function(e,t){return t.has(e.id)},_pending:function(e,t){return t.has(e.id)}})})}.call(this),function(){require(["@detox/chat","@detox/crypto","js/behaviors"]).then(function(e){var t,n,r;t=e[0],n=e[1],r=e[2],Polymer({is:"detox-chat-app-sidebar-profile",behaviors:[r.experience_level,r.help,r.state_instance],properties:{add_secret:{type:Boolean,value:!1},id_base58:String,id_default_secret:String,new_secret_name:String,new_secret_length:{type:Number,value:4},nickname:String},ready:function(){var e=this;t.ready(function(){var r,i,s;function o(){var t,n,o,a,c;for(t=i.get_secrets(),e.id_default_secret=r(s,t[0].secret),n=[],o=0,a=t.length;o<a;++o)c=t[o],n.push({secret:c.secret,id:r(s,c.secret),name:c.name});e.secrets=n}r=t.id_encode,i=e.state,s=n.create_keypair(i.get_seed()).ed25519.public,e.id_base58=r(s,new Uint8Array(0)),e.nickname=i.get_nickname(),o(),i.on("nickname_changed",function(t){e.nickname!==t&&(e.nickname=t)}).on("secrets_changed",o)})},_nickname_blur:function(){this.nickname!==this.state.get_nickname()&&(this.state.set_nickname(this.nickname),detox_chat_app.notify_success("Nickname updated",3))},_id_click:function(e){e.target.select(),document.execCommand("copy"),detox_chat_app.notify_success("ID copied to clipboard",3)},_add_secret:function(){this.add_secret=!0},_add_secret_confirm:function(){var e,n;(e=this.new_secret_name.trim())?(n=t.generate_secret().slice(0,this.new_secret_length),this.state.add_secret(n,e),detox_chat_app.notify_success("Secret added",3),this.add_secret=!1,this.new_secret_name="",this.new_secret_length=4):detox_chat_app.notify_error("Secret name is required",3)},_add_secret_cancel:function(){this.add_secret=!1},_help_id:function(){detox_chat_app.simple_modal("<p>ID is an identifier that represents you in the network.<br>\nIf you share this ID with someone, they'll be able to send contact request to you.</p>")},_help_secrets:function(){detox_chat_app.simple_modal("<p>Secrets are used as anti-spam system. You can create different secrets for different purposes.<br>\nEach time you have incoming contact request, you'll see which secret was used.<br>\nFor instance, you can create a secret for conference and know who is connecting to you before you accept contact request.</p>\n\n<p>For contact requests you need to share ID with secret.<br>\nPlain ID without secret will not result in visible contact request, but if you and your interlocutor add each other to contacts list explicitly, you'll be connected and able to communicate.</p>")},_rename_secret:function(e){var t=this;csw.functions.prompt("New secret name:",function(n){(n=n.trim())?(t.state.set_secret_name(e.model.item.secret,n),detox_chat_app.notify_success("Secret name updated",3)):detox_chat_app.notify_error("Secret name is required",3)}).input.value=e.model.item.name,e.preventDefault()},_del_secret:function(e){var t=this;csw.functions.confirm("<h3>Are you sure you want to delete secret <i>"+e.model.item.name+"</i>?</h3>",function(){t.state.del_secret(e.model.item.secret)}),e.preventDefault()}})})}.call(this),function(){require(["js/behaviors"]).then(function(e){var t;t=e[0],Polymer({is:"detox-chat-app-sidebar-settings",behaviors:[t.experience_level,t.help,t.state_instance],properties:{settings_announce:{observer:"_settings_announce_changed",type:String},settings_block_contact_requests_for:{observer:"_settings_block_contact_requests_for_changed",type:Number},settings_bootstrap_nodes:{observer:"_settings_bootstrap_nodes_changed",type:Object},settings_bootstrap_nodes_string:String,settings_bucket_size:{observer:"_settings_bucket_size_changed",type:Number},settings_experience:{observer:"_settings_experience_changed",type:Number},settings_help:{observer:"_settings_help_changed",type:String},settings_ice_servers:{observer:"_settings_ice_servers_changed",type:Object},settings_ice_servers_string:String,settings_max_pending_segments:{observer:"_settings_max_pending_segments_changed",type:Number},settings_number_of_intermediate_nodes:{observer:"_settings_number_of_intermediate_nodes_changed",type:Number},settings_number_of_introduction_nodes:{observer:"_settings_number_of_introduction_nodes_changed",type:Number},settings_online:{observer:"_settings_online_changed",type:String},settings_packets_per_second:{observer:"_settings_packets_per_second_changed",type:Number},settings_reconnects_intervals:{observer:"_settings_reconnects_intervals_changed",type:Object},settings_reconnects_intervals_string:String,settings_send_ctrl_enter:{observer:"_settings_send_ctrl_enter_changed",type:String}},ready:function(){var e,t=this;e=this.state,this.settings_announce=this._bool_to_string(e.get_settings_announce()),this.settings_block_contact_requests_for=e.get_settings_block_contact_requests_for()/60/60/24,this.settings_bootstrap_nodes=e.get_settings_bootstrap_nodes(),this.settings_bucket_size=e.get_settings_bucket_size(),this.settings_experience=e.get_settings_experience(),this.settings_help=this._bool_to_string(e.get_settings_help()),this.settings_ice_servers=e.get_settings_ice_servers(),this.settings_max_pending_segments=e.get_settings_max_pending_segments(),this.settings_number_of_intermediate_nodes=e.get_settings_number_of_intermediate_nodes(),this.settings_number_of_introduction_nodes=e.get_settings_number_of_introduction_nodes(),this.settings_online=this._bool_to_string(e.get_settings_online()),this.settings_packets_per_second=e.get_settings_packets_per_second(),this.settings_reconnects_intervals=e.get_settings_reconnects_intervals(),this.settings_send_ctrl_enter=this._bool_to_string(e.get_settings_send_ctrl_enter()),e.on("settings_announce_changed",function(e){e=t._bool_to_string(e)}).on("settings_block_contact_requests_for_changed",function(e){t.block_contact_requests_for=e/60/60/24}).on("settings_bootstrap_nodes_changed",function(e){t.settings_bootstrap_nodes=e}).on("settings_bucket_size_changed",function(e){t.settings_bucket_size=e}).on("settings_experience_changed",function(e){t.settings_experience=e}).on("settings_help_changed",function(e){e=t._bool_to_string(e)}).on("settings_ice_servers_changed",function(e){t.settings_ice_servers=e}).on("settings_max_pending_segments_changed",function(e){t.settings_max_pending_segments=e}).on("settings_number_of_intermediate_nodes_changed",function(e){t.settings_number_of_intermediate_nodes=e}).on("settings_number_of_introduction_nodes_changed",function(e){t.settings_number_of_introduction_nodes=e}).on("settings_online_changed",function(e){e=t._bool_to_string(e)}).on("settings_packets_per_second_changed",function(e){t.settings_packets_per_second=e}).on("settings_reconnects_intervals_changed",function(e){t.settings_reconnects_intervals=e}).on("settings_send_ctrl_enter_changed",function(e){e=t._bool_to_string(e)})},_bool_to_string:function(e){return e?"1":"0"},_settings_announce_changed:function(){this.settings_announce!==this._bool_to_string(this.state.get_settings_announce())&&(this.state.set_settings_announce("1"===this.settings_announce),detox_chat_app.notify_success("Saved changes to announcement setting, but restart is needed for changes to take effect",3))},_help_settings_announce:function(){detox_chat_app.simple_modal("<p>Announcement is a process of publishing own contact information to the network, so that contacts can find and connect to you.</p>\n<p>When turned off, you'll be in stealth mode, meaning that no one will be able to see if you're online, send messages or interact in any other way unless you initiate such interaction first.</p>")},_settings_block_contact_requests_for_changed:function(){var e;(e=60*this.settings_block_contact_requests_for*60*24)!==this.state.get_settings_block_contact_requests_for()&&(this.state.set_settings_block_contact_requests_for(e),detox_chat_app.notify_success("Saved changes to block contacts request for setting",3))},_help_settings_block_contact_requests_for:function(){detox_chat_app.simple_modal("<p>When you reject contact request, nothing is sent back to that contact.<br>\nThis results in subsequent contacts requests being received even after rejection.</p>\n<p>This option makes your life better by blocking subsequent contacts requests after first rejection for some time, so that you're not annoyed by the same contact request all the time.<br>\nChanging this option will not affect already blocked contacts requests.</p>")},_settings_bootstrap_nodes_changed:function(e){this.settings_bootstrap_nodes_string=JSON.stringify(e,null,"  ")},_settings_bootstrap_nodes_blur:function(){var e;try{if(e=JSON.parse(this.settings_bootstrap_nodes_string),JSON.stringify(this.settings_bootstrap_nodes)===JSON.stringify(e))return;this.state.set_settings_bootstrap_nodes(e),detox_chat_app.notify_success("Saved changes to bootstrap nodes setting, but restart is needed for changes to take effect",3)}catch(e){e,detox_chat_app.notify_error("Bootstrap nodes syntax error, changes were not saved",3)}},_help_settings_bootstrap_nodes:function(){detox_chat_app.simple_modal("<p>Bootstrap nodes are special kind of nodes used during application startup in order to get information about other nodes in the network and establish initial connections with them.<br>\nThese nodes are crucial for operation and should be selected carefully.<br>\nBootstrap nodes that return misleading information cause anything from drastic reduction of anonymity to being unable to communicate with other nodes in the network.<br>\nDo not change this setting unless you know what you're doing.</p>")},_settings_bucket_size_changed:function(e){(e=parseInt(e))!==this.state.get_settings_bucket_size()&&(this.state.set_settings_bucket_size(e),detox_chat_app.notify_success("Saved changes to bucket size setting, but restart is needed for changes to take effect",3))},_help_settings_bucket_size:function(){detox_chat_app.simple_modal("<p>Bucket size is a data structure used in underlying Distributed Hash Table (DHT) implementation used in Detox network.</p>\n<p>Bigger number means more nodes will be stored, but this will also increase communication overhead.<br>\nDo not change this setting unless you know what you're doing.</p>")},_settings_experience_changed:function(e){(e=parseInt(e))!==this.state.get_settings_experience()&&(this.state.set_settings_experience(e),detox_chat_app.notify_success("Saved changes to user experience level setting",3))},_help_settings_experience:function(){detox_chat_app.simple_modal("<p>Regular makes UI as simple as possible. Advanced enables more features and settings. Developer mode gives most control.</p>")},_settings_help_changed:function(){this.settings_help!==this._bool_to_string(this.state.get_settings_help())&&(this.state.set_settings_help("1"===this.settings_help),detox_chat_app.notify_success("Saved changes to help setting",3))},_help_settings_help:function(){detox_chat_app.simple_modal("<p>Help buttons, one of which you've just clicked, are useful when you just started using Detox Chat, but may annoy later.<br>\nUse this option to hide them if needed.</p>")},_settings_ice_servers_changed:function(e){this.settings_ice_servers_string=JSON.stringify(e,null,"  ")},_settings_ice_servers_blur:function(){var e;try{if(e=JSON.parse(this.settings_ice_servers_string),JSON.stringify(this.settings_ice_servers)===JSON.stringify(e))return;this.state.set_settings_ice_servers(e),detox_chat_app.notify_success("Saved changes to ICE servers setting, but restart is needed for changes to take effect",3)}catch(e){e,detox_chat_app.notify_error("ICE servers syntax error, changes were not saved",3)}},_help_settings_ice_servers:function(){detox_chat_app.simple_modal("<p>ICE servers are used during connections to other nodes in the network.</p>\n<p>There are two kinds of ICE servers: STUN and TURN.<br>\nSTUN helps to figure out how to connect to this node from the outside if it is behind Network Address Translation (NAT) or firewall.<br>\nIf connection is not possible, TURN server can act as relay to enable communication even behind restricted NAT or firewall.</p>\n<p>Most of the time ICE servers are crucial for operation and should be selected carefully.<br>\nDo not change this setting unless you know what you're doing.</p>")},_settings_max_pending_segments_changed:function(e){(e=parseInt(e))!==this.state.get_settings_max_pending_segments()&&(this.state.set_settings_max_pending_segments(e),detox_chat_app.notify_success("Saved changes to max pending segments setting, but restart is needed for changes to take effect",3))},_help_settings_max_pending_segments:function(){detox_chat_app.simple_modal("<p>Pending segments is a low-level state of segments from transport layer of Detox network implementation that appear during routing paths construction.</p>\n<p>Do not change this setting unless you know what you're doing.</p>")},_settings_number_of_intermediate_nodes_changed:function(e){(e=parseInt(e))!==this.state.get_settings_number_of_intermediate_nodes()&&(this.state.set_settings_number_of_intermediate_nodes(e),detox_chat_app.notify_success("Saved changes to number of intermediate nodes setting, but restart is needed for changes to take effect",3))},_help_settings_number_of_intermediate_nodes:function(){detox_chat_app.simple_modal("<p>Intermediate nodes are nodes between this node and interested target node, used for routing paths creation in transport layer of Detox network implementation.</p>\n<p>More intermediate nodes means longer routing path and slower its creation. Lower numbers decrease anonymity, numbers higher than 3 are generally considered to be redundant.<br>\nDo not change this setting unless you know what you're doing.</p>")},_settings_number_of_introduction_nodes_changed:function(e){(e=parseInt(e))!==this.state.get_settings_number_of_introduction_nodes()&&(this.state.set_settings_number_of_introduction_nodes(e),detox_chat_app.notify_success("Saved changes to number of introduction nodes setting, but restart is needed for changes to take effect",3))},_help_settings_number_of_introduction_nodes:function(){detox_chat_app.simple_modal("<p>Introduction nodes are nodes to which announcement is made.</p>\n<p>More than one node is recommended to ensure good reliability of incoming connections, but very high numbers are redundant.<br>\nDo not change this setting unless you know what you're doing.</p>")},_settings_online_changed:function(){this.settings_online!==this._bool_to_string(this.state.get_settings_online())&&(this.state.set_settings_online("1"===this.settings_online),detox_chat_app.notify_success("Saved changes to online setting, but restart is needed for changes to take effect",3))},_help_settings_online:function(){detox_chat_app.simple_modal("<p>If not online then on next start application will not try to connect to Detox network and related functionality will not work properly.</p>")},_settings_packets_per_second_changed:function(e){(e=parseInt(e))!==this.state.get_settings_packets_per_second()&&(this.state.set_settings_packets_per_second(e),detox_chat_app.notify_success("Saved changes to packets per second setting, but restart is needed for changes to take effect",3))},_help_settings_packets_per_second:function(){detox_chat_app.simple_modal("<p>Detox network sends data at fixed rate on each opened connection regardless of how much bandwidth is actually utilized, this option specifies how may packets of 512 bytes will be sent on each link during one second.</p>\n<p>Bigger number means higher peak throughput and lower latencies (to some degree, as these can be bottlenecked by other nodes in particular routing path), but significantly increases requirements to Internet connection.<br>\nYou may increase or decrease this option slightly, but don't go too far unless you know what you're doing.</p>")},_settings_reconnects_intervals_changed:function(e){this.settings_reconnects_intervals_string=JSON.stringify(e,null,"  ")},_settings_reconnects_intervals_blur:function(){var e;try{if(e=JSON.parse(this.settings_reconnects_intervals_string),JSON.stringify(this.settings_reconnects_intervals)===JSON.stringify(e))return;this.state.set_settings_reconnects_intervals(e),detox_chat_app.notify_success("Saved changes to reconnects intervals setting",3)}catch(e){e,detox_chat_app.notify_error("Reconnects intervals syntax error, changes were not saved",3)}},_help_settings_reconnects_intervals:function(){detox_chat_app.simple_modal("<p>When you need to connect to one of your contacts, connection will not always succeed.</p>\n<p>This option controls time intervals (in seconds) between connection attempts.</p>\n<p>First number is max number of attempts and second is number is delay for it. More attempts is made, larger delays become.<br>\nDo not change this setting unless you know what you're doing.</p>")},_settings_send_ctrl_enter_changed:function(){this.settings_send_ctrl_enter!==this._bool_to_string(this.state.get_settings_send_ctrl_enter())&&(this.state.set_settings_send_ctrl_enter("1"===this.settings_send_ctrl_enter),detox_chat_app.notify_success("Saved changes to send message with setting",3))},_help_settings_send_ctrl_enter:function(){detox_chat_app.simple_modal("<p>Either send message with Ctrl+Enter and use Enter for new line or use Enter to send message and Shift+Enter for new line.</p>")},_backup:function(){this.state.get_as_blob().then(function(e){var t,n;t=[(t=new Date).getFullYear(),t.getMonth()+1,t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds()].join("-"),n='<p>Your backup is ready: <a href="'+URL.createObjectURL(e)+'" download="'+("detox-chat-backup-"+t+".bin")+'">Download</a></p>',detox_chat_app.simple_modal(n)})},_restore:function(){var e,t=this;(e=document.createElement("input")).type="file",e.accept=".bin",e.addEventListener("change",function(e){t.state.set_from_blob(e.target.files[0])}),e.click()},_help_backup_restore_data:function(){detox_chat_app.simple_modal("<p>This will backup your contacts, settings and messages history.</p>\n<p>If you're migrating from one browser to another or one machine to another, this will allow you to backup your data here and restore them somewhere else.</p>\n<p>NOTE: You can't have the same account on 2 machines/browsers yet (this will not work properly or at all, don't try or you'll be very disappointed with consequences).</p>\n<p>Always have only one instance and always use fresh backup or you're risking not being able to connect with some of your contacts.</p>")},_remove_all_of_the_data:function(){var e=this;csw.functions.confirm("<p>Are really, REALLY sure you want to proceed with deletion?</p>\n<p>WARNING: This operation can't be undone!</p>",function(){e.state.delete_data(),window.detox_service_worker_registration?caches.keys().then(function(e){var t;return Promise.all(function(){var n,r,i,s=[];for(n=0,i=(r=e).length;n<i;++n)t=r[n],s.push(caches.delete(t));return s}())}).then(function(){return detox_service_worker_registration.unregister()}).then(function(){detox_chat_app.notify_success("All of the data removed successfully, you can exit now")}):detox_chat_app.notify_success("All of the data removed successfully, you can exit now")})},_help_remove_all_of_the_data:function(){detox_chat_app.simple_modal("<p>WARNING: This operation can't be undone!</p>\n<p>This will remove all of the contacts, messages history, settings and any other data stored by this application (including unregistering Service Worker and cleaning its caches), after which application will close itself.</p>\n<p>Make sure to backup any useful data stored in this application before you proceed with deletion!</p>")}})})}.call(this),function(){require(["js/behaviors"]).then(function(e){var t;t=e[0],Polymer({is:"detox-chat-app-sidebar-status",behaviors:[t.state_instance],properties:{online:{type:Boolean,value:!1},announced:{type:Boolean,value:!1},connected_nodes_count:{type:Number,value:0},aware_of_nodes_count:{type:Number,value:0},routing_paths_count:{type:Number,value:0},application_connections_count:{type:Number,value:0}},ready:function(){var e=this;this.state.on("online_changed",function(t){e.online=t}).on("announced_changed",function(t){e.announced=t}).on("connected_nodes_count_changed",function(t){e.connected_nodes_count=t}).on("aware_of_nodes_count_changed",function(t){e.aware_of_nodes_count=t}).on("routing_paths_count_changed",function(t){e.routing_paths_count=t}).on("application_connections_count_changed",function(t){e.application_connections_count=t})},_online:function(e,t){return e&&t?"online":"offline"},_announced:function(e){return e?"announced":"not announced"}})})}.call(this),function(){Polymer({is:"detox-chat-icon-button",behaviors:csw.behaviors.cswButton})}.call(this)}),define("dist/script.js",function(){});var __supercopwasm=function(e){var t;e=e||{},t||(t=void 0!==e?e:{});var n,r={};for(n in t)t.hasOwnProperty(n)&&(r[n]=t[n]);t.arguments=[],t.thisProgram="./this.program",t.quit=function(e,t){throw t},t.preRun=[],t.postRun=[];var i,s,o=!1,a=!1,c=!1,l=!1;if(t.ENVIRONMENT)if("WEB"===t.ENVIRONMENT)o=!0;else if("WORKER"===t.ENVIRONMENT)a=!0;else if("NODE"===t.ENVIRONMENT)c=!0;else{if("SHELL"!==t.ENVIRONMENT)throw Error("Module['ENVIRONMENT'] value is not valid. must be one of: WEB|WORKER|NODE|SHELL.");l=!0}else o="object"==typeof window,a="function"==typeof importScripts,c="object"==typeof process&&"function"==typeof require&&!o&&!a,l=!o&&!c&&!a;if(!t.scriptDirectory)if(t.scriptDirectory="",c)t.scriptDirectory=__dirname+"/";else if(o){var u=this._currentScript||document.currentScript;0!==u.src.indexOf("blob:")&&(t.scriptDirectory=u.src.split("/").slice(0,-1).join("/")+"/")}else a&&(t.scriptDirectory=(this._selfLocation||self.location).href.split("/").slice(0,-1).join("/")+"/");(t.memoryInitializerPrefixURL||(t.memoryInitializerPrefixURL=t.scriptDirectory),t.pthreadMainPrefixURL||(t.pthreadMainPrefixURL=t.scriptDirectory),t.cdInitializerPrefixURL||(t.cdInitializerPrefixURL=t.scriptDirectory),t.filePackagePrefixURL||(t.filePackagePrefixURL=t.scriptDirectory),c)?(t.read=function(e,t){return i||(i=require("fs")),s||(s=require("path")),e=s.normalize(e),e=i.readFileSync(e),t?e:e.toString()},t.readBinary=function(e){return(e=t.read(e,!0)).buffer||(e=new Uint8Array(e)),E(e.buffer),e},1<process.argv.length&&(t.thisProgram=process.argv[1].replace(/\\/g,"/")),t.arguments=process.argv.slice(2),process.on("uncaughtException",function(e){if(!(e instanceof j))throw e}),process.on("unhandledRejection",function(){process.exit(1)}),t.inspect=function(){return"[Emscripten Module object]"}):l?("undefined"!=typeof read&&(t.read=function(e){return read(e)}),t.readBinary=function(e){return"function"==typeof readbuffer?new Uint8Array(readbuffer(e)):(E("object"==typeof(e=read(e,"binary"))),e)},"undefined"!=typeof scriptArgs?t.arguments=scriptArgs:void 0!==arguments&&(t.arguments=arguments),"function"==typeof quit&&(t.quit=function(e){quit(e)})):(o||a)&&(t.read=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},a&&(t.readBinary=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),t.readAsync=function(e,t,n){var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.onload=function(){200==r.status||0==r.status&&r.response?t(r.response):n()},r.onerror=n,r.send(null)},void 0!==arguments&&(t.arguments=arguments),t.setWindowTitle=function(e){document.title=e});for(n in t.print="undefined"!=typeof console?console.log.bind(console):"undefined"!=typeof print?print:null,t.printErr="undefined"!=typeof printErr?printErr:"undefined"!=typeof console&&console.warn.bind(console)||t.print,t.print=t.print,t.printErr=t.printErr,r)r.hasOwnProperty(n)&&(t[n]=r[n]);function h(e){var t;return t||(t=16),Math.ceil(e/t)*t}r=void 0;var d,f,_,p,m,g,y,b,v,w=0;function E(e,t){e||W("Assertion failed: "+t)}function k(){t.HEAP8=new Int8Array(d),t.HEAP16=_=new Int16Array(d),t.HEAP32=p=new Int32Array(d),t.HEAPU8=f=new Uint8Array(d),t.HEAPU16=new Uint16Array(d),t.HEAPU32=new Uint32Array(d),t.HEAPF32=new Float32Array(d),t.HEAPF64=new Float64Array(d)}function x(){W("Cannot enlarge memory arrays. Either (1) compile with  -s TOTAL_MEMORY=X  with X higher than the current value "+S+", (2) compile with  -s ALLOW_MEMORY_GROWTH=1  which allows increasing the size at runtime, or (3) if you want malloc to return NULL (0) instead of this abort, compile with  -s ABORTING_MALLOC=0 ")}"undefined"!=typeof TextDecoder&&new TextDecoder("utf8"),"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le"),m=y=0,g=!1;var A=t.TOTAL_STACK||5242880,S=t.TOTAL_MEMORY||16777216;if(S<A&&t.printErr("TOTAL_MEMORY should be larger than TOTAL_STACK, was "+S+"! (TOTAL_STACK="+A+")"),t.buffer?d=t.buffer:("object"==typeof WebAssembly&&"function"==typeof WebAssembly.Memory?(t.wasmMemory=new WebAssembly.Memory({initial:S/65536,maximum:S/65536}),d=t.wasmMemory.buffer):d=new ArrayBuffer(S),t.buffer=d),k(),p[0]=1668509029,_[1]=25459,115!==f[2]||99!==f[3])throw"Runtime error: expected the system to be little-endian!";function P(e){for(;0<e.length;){var n=e.shift();if("function"==typeof n)n();else{var r=n.f;"number"==typeof r?void 0===n.a?t.dynCall_v(r):t.dynCall_vi(r,n.a):r(void 0===n.a?null:n.a)}}}var T=[],C=[],O=[],N=[],R=[],I=!1;function M(){var e=t.preRun.shift();T.unshift(e)}var L=0,D=null,B=null;function z(e){return String.prototype.startsWith?e.startsWith("data:application/octet-stream;base64,"):0===e.indexOf("data:application/octet-stream;base64,")}t.preloadedImages={},t.preloadedAudios={},function(){function e(){try{if(t.wasmBinary)return new Uint8Array(t.wasmBinary);if(t.readBinary)return t.readBinary(s);throw"on the web, we need the wasm binary to be preloaded and set on Module['wasmBinary']. emcc.py will do that for you when generating HTML (but not JS)"}catch(e){W(e)}}function n(){return t.wasmBinary||!o&&!a||"function"!=typeof fetch?new Promise(function(t){t(e())}):fetch(s,{credentials:"same-origin"}).then(function(e){if(!e.ok)throw"failed to load wasm binary file at '"+s+"'";return e.arrayBuffer()}).catch(function(){return e()})}function r(e){function r(e){if((u=e.exports).memory){e=u.memory;var n=t.buffer;e.byteLength<n.byteLength&&t.printErr("the new buffer in mergeMemory is smaller than the previous one. in native wasm, we should grow memory here"),n=new Int8Array(n),new Int8Array(e).set(n),t.buffer=d=e,k()}t.asm=u,t.usingWasm=!0,L--,t.monitorRunDependencies&&t.monitorRunDependencies(L),0==L&&(null!==D&&(clearInterval(D),D=null),B&&(e=B,B=null,e()))}function i(e){r(e.instance)}function o(e){n().then(function(e){return WebAssembly.instantiate(e,l)}).then(e).catch(function(e){t.printErr("failed to asynchronously prepare wasm: "+e),W(e)})}if("object"!=typeof WebAssembly)return t.printErr("no native wasm support detected"),!1;if(!(t.wasmMemory instanceof WebAssembly.Memory))return t.printErr("no native wasm Memory in use"),!1;if(e.memory=t.wasmMemory,l.global={NaN:NaN,Infinity:1/0},l["global.Math"]=Math,l.env=e,L++,t.monitorRunDependencies&&t.monitorRunDependencies(L),t.instantiateWasm)try{return t.instantiateWasm(l,r)}catch(e){return t.printErr("Module.instantiateWasm callback failed with error: "+e),!1}return t.wasmBinary||"function"!=typeof WebAssembly.instantiateStreaming||z(s)||"function"!=typeof fetch?o(i):WebAssembly.instantiateStreaming(fetch(s,{credentials:"same-origin"}),l).then(i).catch(function(e){t.printErr("wasm streaming compile failed: "+e),t.printErr("falling back to ArrayBuffer instantiation"),o(i)}),{}}var i="supercop.wast",s="supercop.wasm?ed96f",c="supercop.temp.asm.js";"function"==typeof t.locateFile?(z(i)||(i=t.locateFile(i)),z(s)||(s=t.locateFile(s)),z(c)||(c=t.locateFile(c))):(z(i)||(i=t.scriptDirectory+i),z(s)||(s=t.scriptDirectory+s),z(c)||(c=t.scriptDirectory+c));var l={global:null,env:null,asm2wasm:{"f64-rem":function(e,t){return e%t},debugger:function(){}},parent:t},u=null;t.asmPreload=t.asm;var h=t.reallocBuffer;t.reallocBuffer=function(e){if("asmjs"===f)var n=h(e);else e:{var r=t.usingWasm?65536:16777216;if(0<e%r&&(e+=r-e%r),r=t.buffer.byteLength,t.usingWasm)try{n=-1!==t.wasmMemory.grow((e-r)/65536)?t.buffer=t.wasmMemory.buffer:null;break e}catch(e){n=null;break e}n=void 0}return n};var f="";t.asm=function(e,n){if(!n.table){void 0===(e=t.wasmTableSize)&&(e=1024);var i=t.wasmMaxTableSize;n.table="object"==typeof WebAssembly&&"function"==typeof WebAssembly.Table?void 0!==i?new WebAssembly.Table({initial:e,maximum:i,element:"anyfunc"}):new WebAssembly.Table({initial:e,element:"anyfunc"}):Array(e),t.wasmTable=n.table}return n.memoryBase||(n.memoryBase=t.STATIC_BASE),n.tableBase||(n.tableBase=0),(n=r(n))||W("no binaryen method succeeded. consider enabling more options, like interpreting, if you want that: https://github.com/kripken/emscripten/wiki/WebAssembly#binaryen-methods"),n}}(),m=34992,C.push(),t.STATIC_BASE=1024,t.STATIC_BUMP=33968,m+=16,E(!g),v=m,b=h((y=h(m=m+4+15&-16))+A),p[v>>2]=b,g=!0,t.wasmTableSize=0,t.wasmMaxTableSize=0,t.b={},t.c={enlargeMemory:function(){x()},getTotalMemory:function(){return S},abortOnCannotGrowMemory:x,___setErrNo:function(e){return t.___errno_location&&(p[t.___errno_location()>>2]=e),e},DYNAMICTOP_PTR:v,STACKTOP:y};var U=t.asm(t.b,t.c,d);t.asm=U,t._ed25519_create_keypair=function(){return t.asm._ed25519_create_keypair.apply(null,arguments)},t._ed25519_sign=function(){return t.asm._ed25519_sign.apply(null,arguments)},t._ed25519_verify=function(){return t.asm._ed25519_verify.apply(null,arguments)};var q=t._free=function(){return t.asm._free.apply(null,arguments)},F=t._malloc=function(){return t.asm._malloc.apply(null,arguments)};function j(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function H(){function e(){if(!t.calledRun&&(t.calledRun=!0,!w)){if(I||(I=!0,P(C)),P(O),t.onRuntimeInitialized&&t.onRuntimeInitialized(),t.postRun)for("function"==typeof t.postRun&&(t.postRun=[t.postRun]);t.postRun.length;){var e=t.postRun.shift();R.unshift(e)}P(R)}}if(!(0<L)){if(t.preRun)for("function"==typeof t.preRun&&(t.preRun=[t.preRun]);t.preRun.length;)M();P(T),0<L||t.calledRun||(t.setStatus?(t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1),e()},1)):e())}}function W(e){throw t.onAbort&&t.onAbort(e),void 0!==e?(t.print(e),t.printErr(e),e=JSON.stringify(e)):e="",w=!0,"abort("+e+"). Build with -s ASSERTIONS=1 for more info."}if(t.asm=U,t.then=function(e){if(t.calledRun)e(t);else{var n=t.onRuntimeInitialized;t.onRuntimeInitialized=function(){n&&n(),e(t)}}return t},j.prototype=Error(),j.prototype.constructor=j,B=function e(){t.calledRun||H(),t.calledRun||(B=e)},t.run=H,t.exit=function(e,n){n&&t.noExitRuntime&&0===e||(!t.noExitRuntime&&(w=!0,y=void 0,P(N),t.onExit)&&t.onExit(e),c&&process.exit(e),t.quit(e,new j(e)))},t.abort=W,t.preInit)for("function"==typeof t.preInit&&(t.preInit=[t.preInit]);0<t.preInit.length;)t.preInit.pop()();return t.noExitRuntime=!0,H(),function(){function e(e){if(e&&e.buffer instanceof ArrayBuffer)e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength);else if("string"==typeof e){for(var t=e.length,n=new Uint8Array(t+1),r=0;r<t;++r)n[r]=e.charCodeAt(r);return n}return e}function n(t,r){var s=new Number(t);return s.length=r,s.get=function(e){return new(e=e||Uint8Array)(d,s,r/e.BYTES_PER_ELEMENT).slice()},s.dereference=function(e){return e=e||4,n(s.get(Uint32Array)[0],e)},s.set=function(t){if((t=e(t)).length>r)throw RangeError("invalid array length");f.set(t,s)},s.free=function(){q(s),i.splice(i.indexOf(s),1)},i.push(s),s}function r(t,r){r=e(r),0===t&&(t=r.length);var i=n(F(t),t);return void 0!==r?(i.set(r),r.length<t&&f.fill(0,i+r.length,i+t)):f.fill(0,i,i+t),i}var i=[];t.createPointer=n,t.allocatePointer=function(e){return e&&(e=Uint32Array.of(e)),r(4,e)},t.allocateBytes=r,t.freeBytes=function(){for(var e=0,t=i.length;e<t;++e)q(i[e]);i=[]}}(),e};__supercopwasm=__supercopwasm.bind({_currentScript:"undefined"!=typeof document?document.currentScript:void 0,_selfLocation:"undefined"!=typeof self?self.location:void 0}),"object"==typeof exports&&"object"==typeof module?module.exports=__supercopwasm:"function"==typeof define&&define.amd?define("supercop.wasm/src/supercop",[],function(){return __supercopwasm}):"object"==typeof exports&&(exports.__supercopwasm=__supercopwasm),function(){function e(e){var n,r;return e=e(),n=e.allocateBytes,r=e.freeBytes,{ready:e.then,createSeed:function(){return t(32)},createKeyPair:function(t){var i,s;if(!(t instanceof Uint8Array))throw new Error("not Uint8Array!");return t=n(0,t),i=n(32),s=n(64),e._ed25519_create_keypair(i,s,t),i=i.get(),s=s.get(),r(),{publicKey:i,secretKey:s}},sign:function(t,i,s){var o;if(!(t instanceof Uint8Array&&i instanceof Uint8Array&&s instanceof Uint8Array))throw new Error("not Uint8Arrays!");return t=n(0,t),i=n(0,i),s=n(0,s),o=n(64),e._ed25519_sign(o,t,t.length,i,s),o=o.get(),r(),o},verify:function(t,i,s){var o;if(!(t instanceof Uint8Array&&i instanceof Uint8Array&&s instanceof Uint8Array))throw new Error("not Uint8Arrays!");return i=n(0,i),s=n(0,s),t=n(0,t),o=1===e._ed25519_verify(t,i,i.length,s),r(),o}}}var t;t="undefined"!=typeof crypto?function(e){var t;return t=new Uint8Array(e),crypto.getRandomValues(t),t}:require("crypto").randomBytes,"function"==typeof define&&define.amd?define("supercop.wasm/src/index.min",["./supercop"],e):"object"==typeof exports?module.exports=e(require("./supercop")):this.supercop_wasm=e(this.__supercopwasm)}.call(this),define("supercop.wasm",["supercop.wasm/src/index.min"],function(e){return e});var __ed25519_to_x25519_wasm=function(e){var t;e=e||{},t||(t=void 0!==e?e:{});var n,r={};for(n in t)t.hasOwnProperty(n)&&(r[n]=t[n]);t.arguments=[],t.thisProgram="./this.program",t.quit=function(e,t){throw t},t.preRun=[],t.postRun=[];var i,s,o=!1,a=!1,c=!1,l=!1;if(t.ENVIRONMENT)if("WEB"===t.ENVIRONMENT)o=!0;else if("WORKER"===t.ENVIRONMENT)a=!0;else if("NODE"===t.ENVIRONMENT)c=!0;else{if("SHELL"!==t.ENVIRONMENT)throw Error("Module['ENVIRONMENT'] value is not valid. must be one of: WEB|WORKER|NODE|SHELL.");l=!0}else o="object"==typeof window,a="function"==typeof importScripts,c="object"==typeof process&&"function"==typeof require&&!o&&!a,l=!o&&!c&&!a;if(!t.scriptDirectory)if(t.scriptDirectory="",c)t.scriptDirectory=__dirname+"/";else if(o){var u=this._currentScript||document.currentScript;0!==u.src.indexOf("blob:")&&(t.scriptDirectory=u.src.split("/").slice(0,-1).join("/")+"/")}else a&&(t.scriptDirectory=(this._selfLocation||self.location).href.split("/").slice(0,-1).join("/")+"/");(t.memoryInitializerPrefixURL||(t.memoryInitializerPrefixURL=t.scriptDirectory),t.pthreadMainPrefixURL||(t.pthreadMainPrefixURL=t.scriptDirectory),t.cdInitializerPrefixURL||(t.cdInitializerPrefixURL=t.scriptDirectory),t.filePackagePrefixURL||(t.filePackagePrefixURL=t.scriptDirectory),c)?(t.read=function(e,t){return i||(i=require("fs")),s||(s=require("path")),e=s.normalize(e),e=i.readFileSync(e),t?e:e.toString()},t.readBinary=function(e){return(e=t.read(e,!0)).buffer||(e=new Uint8Array(e)),E(e.buffer),e},1<process.argv.length&&(t.thisProgram=process.argv[1].replace(/\\/g,"/")),t.arguments=process.argv.slice(2),process.on("uncaughtException",function(e){if(!(e instanceof j))throw e}),process.on("unhandledRejection",function(){process.exit(1)}),t.inspect=function(){return"[Emscripten Module object]"}):l?("undefined"!=typeof read&&(t.read=function(e){return read(e)}),t.readBinary=function(e){return"function"==typeof readbuffer?new Uint8Array(readbuffer(e)):(E("object"==typeof(e=read(e,"binary"))),e)},"undefined"!=typeof scriptArgs?t.arguments=scriptArgs:void 0!==arguments&&(t.arguments=arguments),"function"==typeof quit&&(t.quit=function(e){quit(e)})):(o||a)&&(t.read=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},a&&(t.readBinary=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),t.readAsync=function(e,t,n){var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.onload=function(){200==r.status||0==r.status&&r.response?t(r.response):n()},r.onerror=n,r.send(null)},void 0!==arguments&&(t.arguments=arguments),t.setWindowTitle=function(e){document.title=e});for(n in t.print="undefined"!=typeof console?console.log.bind(console):"undefined"!=typeof print?print:null,t.printErr="undefined"!=typeof printErr?printErr:"undefined"!=typeof console&&console.warn.bind(console)||t.print,t.print=t.print,t.printErr=t.printErr,r)r.hasOwnProperty(n)&&(t[n]=r[n]);function h(e){var t;return t||(t=16),Math.ceil(e/t)*t}r=void 0;var d,f,_,p,m,g,y,b,v,w=0;function E(e,t){e||W("Assertion failed: "+t)}function k(){t.HEAP8=new Int8Array(d),t.HEAP16=_=new Int16Array(d),t.HEAP32=p=new Int32Array(d),t.HEAPU8=f=new Uint8Array(d),t.HEAPU16=new Uint16Array(d),t.HEAPU32=new Uint32Array(d),t.HEAPF32=new Float32Array(d),t.HEAPF64=new Float64Array(d)}function x(){W("Cannot enlarge memory arrays. Either (1) compile with  -s TOTAL_MEMORY=X  with X higher than the current value "+S+", (2) compile with  -s ALLOW_MEMORY_GROWTH=1  which allows increasing the size at runtime, or (3) if you want malloc to return NULL (0) instead of this abort, compile with  -s ABORTING_MALLOC=0 ")}"undefined"!=typeof TextDecoder&&new TextDecoder("utf8"),"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le"),m=y=0,g=!1;var A=t.TOTAL_STACK||5242880,S=t.TOTAL_MEMORY||16777216;if(S<A&&t.printErr("TOTAL_MEMORY should be larger than TOTAL_STACK, was "+S+"! (TOTAL_STACK="+A+")"),t.buffer?d=t.buffer:("object"==typeof WebAssembly&&"function"==typeof WebAssembly.Memory?(t.wasmMemory=new WebAssembly.Memory({initial:S/65536,maximum:S/65536}),d=t.wasmMemory.buffer):d=new ArrayBuffer(S),t.buffer=d),k(),p[0]=1668509029,_[1]=25459,115!==f[2]||99!==f[3])throw"Runtime error: expected the system to be little-endian!";function P(e){for(;0<e.length;){var n=e.shift();if("function"==typeof n)n();else{var r=n.f;"number"==typeof r?void 0===n.a?t.dynCall_v(r):t.dynCall_vi(r,n.a):r(void 0===n.a?null:n.a)}}}var T=[],C=[],O=[],N=[],R=[],I=!1;function M(){var e=t.preRun.shift();T.unshift(e)}var L=0,D=null,B=null;function z(e){return String.prototype.startsWith?e.startsWith("data:application/octet-stream;base64,"):0===e.indexOf("data:application/octet-stream;base64,")}t.preloadedImages={},t.preloadedAudios={},function(){function e(){try{if(t.wasmBinary)return new Uint8Array(t.wasmBinary);if(t.readBinary)return t.readBinary(s);throw"on the web, we need the wasm binary to be preloaded and set on Module['wasmBinary']. emcc.py will do that for you when generating HTML (but not JS)"}catch(e){W(e)}}function n(){return t.wasmBinary||!o&&!a||"function"!=typeof fetch?new Promise(function(t){t(e())}):fetch(s,{credentials:"same-origin"}).then(function(e){if(!e.ok)throw"failed to load wasm binary file at '"+s+"'";return e.arrayBuffer()}).catch(function(){return e()})}function r(e){function r(e){if((u=e.exports).memory){e=u.memory;var n=t.buffer;e.byteLength<n.byteLength&&t.printErr("the new buffer in mergeMemory is smaller than the previous one. in native wasm, we should grow memory here"),n=new Int8Array(n),new Int8Array(e).set(n),t.buffer=d=e,k()}t.asm=u,t.usingWasm=!0,L--,t.monitorRunDependencies&&t.monitorRunDependencies(L),0==L&&(null!==D&&(clearInterval(D),D=null),B&&(e=B,B=null,e()))}function i(e){r(e.instance)}function o(e){n().then(function(e){return WebAssembly.instantiate(e,l)}).then(e).catch(function(e){t.printErr("failed to asynchronously prepare wasm: "+e),W(e)})}if("object"!=typeof WebAssembly)return t.printErr("no native wasm support detected"),!1;if(!(t.wasmMemory instanceof WebAssembly.Memory))return t.printErr("no native wasm Memory in use"),!1;if(e.memory=t.wasmMemory,l.global={NaN:NaN,Infinity:1/0},l["global.Math"]=Math,l.env=e,L++,t.monitorRunDependencies&&t.monitorRunDependencies(L),t.instantiateWasm)try{return t.instantiateWasm(l,r)}catch(e){return t.printErr("Module.instantiateWasm callback failed with error: "+e),!1}return t.wasmBinary||"function"!=typeof WebAssembly.instantiateStreaming||z(s)||"function"!=typeof fetch?o(i):WebAssembly.instantiateStreaming(fetch(s,{credentials:"same-origin"}),l).then(i).catch(function(e){t.printErr("wasm streaming compile failed: "+e),t.printErr("falling back to ArrayBuffer instantiation"),o(i)}),{}}var i="ed25519-to-x25519.wast",s="ed25519-to-x25519.wasm?006dd",c="ed25519-to-x25519.temp.asm.js";"function"==typeof t.locateFile?(z(i)||(i=t.locateFile(i)),z(s)||(s=t.locateFile(s)),z(c)||(c=t.locateFile(c))):(z(i)||(i=t.scriptDirectory+i),z(s)||(s=t.scriptDirectory+s),z(c)||(c=t.scriptDirectory+c));var l={global:null,env:null,asm2wasm:{"f64-rem":function(e,t){return e%t},debugger:function(){}},parent:t},u=null;t.asmPreload=t.asm;var h=t.reallocBuffer;t.reallocBuffer=function(e){if("asmjs"===f)var n=h(e);else e:{var r=t.usingWasm?65536:16777216;if(0<e%r&&(e+=r-e%r),r=t.buffer.byteLength,t.usingWasm)try{n=-1!==t.wasmMemory.grow((e-r)/65536)?t.buffer=t.wasmMemory.buffer:null;break e}catch(e){n=null;break e}n=void 0}return n};var f="";t.asm=function(e,n){if(!n.table){void 0===(e=t.wasmTableSize)&&(e=1024);var i=t.wasmMaxTableSize;n.table="object"==typeof WebAssembly&&"function"==typeof WebAssembly.Table?void 0!==i?new WebAssembly.Table({initial:e,maximum:i,element:"anyfunc"}):new WebAssembly.Table({initial:e,element:"anyfunc"}):Array(e),t.wasmTable=n.table}return n.memoryBase||(n.memoryBase=t.STATIC_BASE),n.tableBase||(n.tableBase=0),(n=r(n))||W("no binaryen method succeeded. consider enabling more options, like interpreting, if you want that: https://github.com/kripken/emscripten/wiki/WebAssembly#binaryen-methods"),n}}(),m=3984,C.push(),t.STATIC_BASE=1024,t.STATIC_BUMP=2960,m+=16,E(!g),v=m,b=h((y=h(m=m+4+15&-16))+A),p[v>>2]=b,g=!0,t.wasmTableSize=0,t.wasmMaxTableSize=0,t.b={},t.c={enlargeMemory:function(){x()},getTotalMemory:function(){return S},abortOnCannotGrowMemory:x,___setErrNo:function(e){return t.___errno_location&&(p[t.___errno_location()>>2]=e),e},DYNAMICTOP_PTR:v,STACKTOP:y};var U=t.asm(t.b,t.c,d);t.asm=U,t._crypto_sign_ed25519_pk_to_curve25519=function(){return t.asm._crypto_sign_ed25519_pk_to_curve25519.apply(null,arguments)},t._crypto_sign_ed25519_sk_to_curve25519=function(){return t.asm._crypto_sign_ed25519_sk_to_curve25519.apply(null,arguments)};var q=t._free=function(){return t.asm._free.apply(null,arguments)},F=t._malloc=function(){return t.asm._malloc.apply(null,arguments)};function j(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function H(){function e(){if(!t.calledRun&&(t.calledRun=!0,!w)){if(I||(I=!0,P(C)),P(O),t.onRuntimeInitialized&&t.onRuntimeInitialized(),t.postRun)for("function"==typeof t.postRun&&(t.postRun=[t.postRun]);t.postRun.length;){var e=t.postRun.shift();R.unshift(e)}P(R)}}if(!(0<L)){if(t.preRun)for("function"==typeof t.preRun&&(t.preRun=[t.preRun]);t.preRun.length;)M();P(T),0<L||t.calledRun||(t.setStatus?(t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1),e()},1)):e())}}function W(e){throw t.onAbort&&t.onAbort(e),void 0!==e?(t.print(e),t.printErr(e),e=JSON.stringify(e)):e="",w=!0,"abort("+e+"). Build with -s ASSERTIONS=1 for more info."}if(t.asm=U,t.then=function(e){if(t.calledRun)e(t);else{var n=t.onRuntimeInitialized;t.onRuntimeInitialized=function(){n&&n(),e(t)}}return t},j.prototype=Error(),j.prototype.constructor=j,B=function e(){t.calledRun||H(),t.calledRun||(B=e)},t.run=H,t.exit=function(e,n){n&&t.noExitRuntime&&0===e||(!t.noExitRuntime&&(w=!0,y=void 0,P(N),t.onExit)&&t.onExit(e),c&&process.exit(e),t.quit(e,new j(e)))},t.abort=W,t.preInit)for("function"==typeof t.preInit&&(t.preInit=[t.preInit]);0<t.preInit.length;)t.preInit.pop()();return t.noExitRuntime=!0,H(),function(){function e(e){if(e&&e.buffer instanceof ArrayBuffer)e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength);else if("string"==typeof e){for(var t=e.length,n=new Uint8Array(t+1),r=0;r<t;++r)n[r]=e.charCodeAt(r);return n}return e}function n(t,r){var s=new Number(t);return s.length=r,s.get=function(e){return new(e=e||Uint8Array)(d,s,r/e.BYTES_PER_ELEMENT).slice()},s.dereference=function(e){return e=e||4,n(s.get(Uint32Array)[0],e)},s.set=function(t){if((t=e(t)).length>r)throw RangeError("invalid array length");f.set(t,s)},s.free=function(){q(s),i.splice(i.indexOf(s),1)},i.push(s),s}function r(t,r){r=e(r),0===t&&(t=r.length);var i=n(F(t),t);return void 0!==r?(i.set(r),r.length<t&&f.fill(0,i+r.length,i+t)):f.fill(0,i,i+t),i}var i=[];t.createPointer=n,t.allocatePointer=function(e){return e&&(e=Uint32Array.of(e)),r(4,e)},t.allocateBytes=r,t.freeBytes=function(){for(var e=0,t=i.length;e<t;++e)q(i[e]);i=[]}}(),e};__ed25519_to_x25519_wasm=__ed25519_to_x25519_wasm.bind({_currentScript:"undefined"!=typeof document?document.currentScript:void 0,_selfLocation:"undefined"!=typeof self?self.location:void 0}),"object"==typeof exports&&"object"==typeof module?module.exports=__ed25519_to_x25519_wasm:"function"==typeof define&&define.amd?define("ed25519-to-x25519.wasm/src/ed25519-to-x25519",[],function(){return __ed25519_to_x25519_wasm}):"object"==typeof exports&&(exports.__ed25519_to_x25519_wasm=__ed25519_to_x25519_wasm),function(){function e(e){var t,n;return e=e(),t=e.allocateBytes,n=e.freeBytes,{ready:e.then,convert_public_key:function(r){var i;return i=t(32),r=t(0,r),0!==e._crypto_sign_ed25519_pk_to_curve25519(i,r)?null:(i=i.get(),n(),i)},convert_private_key:function(r){var i;return i=t(32),r=t(0,r),e._crypto_sign_ed25519_sk_to_curve25519(i,r),i=i.get(),n(),i}}}"function"==typeof define&&define.amd?define("ed25519-to-x25519.wasm/src/index.min",["./ed25519-to-x25519"],e):"object"==typeof exports?module.exports=e(require("./ed25519-to-x25519")):this.ed25519_to_x25519_wasm=e(this.__ed25519_to_x25519_wasm)}.call(this),define("ed25519-to-x25519.wasm",["ed25519-to-x25519.wasm/src/index.min"],function(e){return e});var __aez_wasm=function(e){var t;e=e||{},t||(t=void 0!==e?e:{});var n,r={};for(n in t)t.hasOwnProperty(n)&&(r[n]=t[n]);t.arguments=[],t.thisProgram="./this.program",t.quit=function(e,t){throw t},t.preRun=[],t.postRun=[];var i,s,o=!1,a=!1,c=!1,l=!1;if(t.ENVIRONMENT)if("WEB"===t.ENVIRONMENT)o=!0;else if("WORKER"===t.ENVIRONMENT)a=!0;else if("NODE"===t.ENVIRONMENT)c=!0;else{if("SHELL"!==t.ENVIRONMENT)throw Error("Module['ENVIRONMENT'] value is not valid. must be one of: WEB|WORKER|NODE|SHELL.");l=!0}else o="object"==typeof window,a="function"==typeof importScripts,c="object"==typeof process&&"function"==typeof require&&!o&&!a,l=!o&&!c&&!a;if(!t.scriptDirectory)if(t.scriptDirectory="",c)t.scriptDirectory=__dirname+"/";else if(o){var u=this._currentScript||document.currentScript;0!==u.src.indexOf("blob:")&&(t.scriptDirectory=u.src.split("/").slice(0,-1).join("/")+"/")}else a&&(t.scriptDirectory=(this._selfLocation||self.location).href.split("/").slice(0,-1).join("/")+"/");(t.memoryInitializerPrefixURL||(t.memoryInitializerPrefixURL=t.scriptDirectory),t.pthreadMainPrefixURL||(t.pthreadMainPrefixURL=t.scriptDirectory),t.cdInitializerPrefixURL||(t.cdInitializerPrefixURL=t.scriptDirectory),t.filePackagePrefixURL||(t.filePackagePrefixURL=t.scriptDirectory),c)?(t.read=function(e,t){return i||(i=require("fs")),s||(s=require("path")),e=s.normalize(e),e=i.readFileSync(e),t?e:e.toString()},t.readBinary=function(e){return(e=t.read(e,!0)).buffer||(e=new Uint8Array(e)),E(e.buffer),e},1<process.argv.length&&(t.thisProgram=process.argv[1].replace(/\\/g,"/")),t.arguments=process.argv.slice(2),process.on("uncaughtException",function(e){if(!(e instanceof j))throw e}),process.on("unhandledRejection",function(){process.exit(1)}),t.inspect=function(){return"[Emscripten Module object]"}):l?("undefined"!=typeof read&&(t.read=function(e){return read(e)}),t.readBinary=function(e){return"function"==typeof readbuffer?new Uint8Array(readbuffer(e)):(E("object"==typeof(e=read(e,"binary"))),e)},"undefined"!=typeof scriptArgs?t.arguments=scriptArgs:void 0!==arguments&&(t.arguments=arguments),"function"==typeof quit&&(t.quit=function(e){quit(e)})):(o||a)&&(t.read=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},a&&(t.readBinary=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),t.readAsync=function(e,t,n){var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.onload=function(){200==r.status||0==r.status&&r.response?t(r.response):n()},r.onerror=n,r.send(null)},void 0!==arguments&&(t.arguments=arguments),t.setWindowTitle=function(e){document.title=e});for(n in t.print="undefined"!=typeof console?console.log.bind(console):"undefined"!=typeof print?print:null,t.printErr="undefined"!=typeof printErr?printErr:"undefined"!=typeof console&&console.warn.bind(console)||t.print,t.print=t.print,t.printErr=t.printErr,r)r.hasOwnProperty(n)&&(t[n]=r[n]);function h(e){var t;return t||(t=16),Math.ceil(e/t)*t}r=void 0;var d,f,_,p,m,g,y,b,v,w=0;function E(e,t){e||W("Assertion failed: "+t)}function k(){t.HEAP8=new Int8Array(d),t.HEAP16=_=new Int16Array(d),t.HEAP32=p=new Int32Array(d),t.HEAPU8=f=new Uint8Array(d),t.HEAPU16=new Uint16Array(d),t.HEAPU32=new Uint32Array(d),t.HEAPF32=new Float32Array(d),t.HEAPF64=new Float64Array(d)}function x(){W("Cannot enlarge memory arrays. Either (1) compile with  -s TOTAL_MEMORY=X  with X higher than the current value "+S+", (2) compile with  -s ALLOW_MEMORY_GROWTH=1  which allows increasing the size at runtime, or (3) if you want malloc to return NULL (0) instead of this abort, compile with  -s ABORTING_MALLOC=0 ")}"undefined"!=typeof TextDecoder&&new TextDecoder("utf8"),"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le"),m=y=0,g=!1;var A=t.TOTAL_STACK||5242880,S=t.TOTAL_MEMORY||16777216;if(S<A&&t.printErr("TOTAL_MEMORY should be larger than TOTAL_STACK, was "+S+"! (TOTAL_STACK="+A+")"),t.buffer?d=t.buffer:("object"==typeof WebAssembly&&"function"==typeof WebAssembly.Memory?(t.wasmMemory=new WebAssembly.Memory({initial:S/65536,maximum:S/65536}),d=t.wasmMemory.buffer):d=new ArrayBuffer(S),t.buffer=d),k(),p[0]=1668509029,_[1]=25459,115!==f[2]||99!==f[3])throw"Runtime error: expected the system to be little-endian!";function P(e){for(;0<e.length;){var n=e.shift();if("function"==typeof n)n();else{var r=n.f;"number"==typeof r?void 0===n.a?t.dynCall_v(r):t.dynCall_vi(r,n.a):r(void 0===n.a?null:n.a)}}}var T=[],C=[],O=[],N=[],R=[],I=!1;function M(){var e=t.preRun.shift();T.unshift(e)}var L=0,D=null,B=null;function z(e){return String.prototype.startsWith?e.startsWith("data:application/octet-stream;base64,"):0===e.indexOf("data:application/octet-stream;base64,")}t.preloadedImages={},t.preloadedAudios={},function(){function e(){try{if(t.wasmBinary)return new Uint8Array(t.wasmBinary);if(t.readBinary)return t.readBinary(s);throw"on the web, we need the wasm binary to be preloaded and set on Module['wasmBinary']. emcc.py will do that for you when generating HTML (but not JS)"}catch(e){W(e)}}function n(){return t.wasmBinary||!o&&!a||"function"!=typeof fetch?new Promise(function(t){t(e())}):fetch(s,{credentials:"same-origin"}).then(function(e){if(!e.ok)throw"failed to load wasm binary file at '"+s+"'";return e.arrayBuffer()}).catch(function(){return e()})}function r(e){function r(e){if((u=e.exports).memory){e=u.memory;var n=t.buffer;e.byteLength<n.byteLength&&t.printErr("the new buffer in mergeMemory is smaller than the previous one. in native wasm, we should grow memory here"),n=new Int8Array(n),new Int8Array(e).set(n),t.buffer=d=e,k()}t.asm=u,t.usingWasm=!0,L--,t.monitorRunDependencies&&t.monitorRunDependencies(L),0==L&&(null!==D&&(clearInterval(D),D=null),B&&(e=B,B=null,e()))}function i(e){r(e.instance)}function o(e){n().then(function(e){return WebAssembly.instantiate(e,l)}).then(e).catch(function(e){t.printErr("failed to asynchronously prepare wasm: "+e),W(e)})}if("object"!=typeof WebAssembly)return t.printErr("no native wasm support detected"),!1;if(!(t.wasmMemory instanceof WebAssembly.Memory))return t.printErr("no native wasm Memory in use"),!1;if(e.memory=t.wasmMemory,l.global={NaN:NaN,Infinity:1/0},l["global.Math"]=Math,l.env=e,L++,t.monitorRunDependencies&&t.monitorRunDependencies(L),t.instantiateWasm)try{return t.instantiateWasm(l,r)}catch(e){return t.printErr("Module.instantiateWasm callback failed with error: "+e),!1}return t.wasmBinary||"function"!=typeof WebAssembly.instantiateStreaming||z(s)||"function"!=typeof fetch?o(i):WebAssembly.instantiateStreaming(fetch(s,{credentials:"same-origin"}),l).then(i).catch(function(e){t.printErr("wasm streaming compile failed: "+e),t.printErr("falling back to ArrayBuffer instantiation"),o(i)}),{}}var i="aez.wast",s="aez.wasm?a2fe3",c="aez.temp.asm.js";"function"==typeof t.locateFile?(z(i)||(i=t.locateFile(i)),z(s)||(s=t.locateFile(s)),z(c)||(c=t.locateFile(c))):(z(i)||(i=t.scriptDirectory+i),z(s)||(s=t.scriptDirectory+s),z(c)||(c=t.scriptDirectory+c));var l={global:null,env:null,asm2wasm:{"f64-rem":function(e,t){return e%t},debugger:function(){}},parent:t},u=null;t.asmPreload=t.asm;var h=t.reallocBuffer;t.reallocBuffer=function(e){if("asmjs"===f)var n=h(e);else e:{var r=t.usingWasm?65536:16777216;if(0<e%r&&(e+=r-e%r),r=t.buffer.byteLength,t.usingWasm)try{n=-1!==t.wasmMemory.grow((e-r)/65536)?t.buffer=t.wasmMemory.buffer:null;break e}catch(e){n=null;break e}n=void 0}return n};var f="";t.asm=function(e,n){if(!n.table){void 0===(e=t.wasmTableSize)&&(e=1024);var i=t.wasmMaxTableSize;n.table="object"==typeof WebAssembly&&"function"==typeof WebAssembly.Table?void 0!==i?new WebAssembly.Table({initial:e,maximum:i,element:"anyfunc"}):new WebAssembly.Table({initial:e,element:"anyfunc"}):Array(e),t.wasmTable=n.table}return n.memoryBase||(n.memoryBase=t.STATIC_BASE),n.tableBase||(n.tableBase=0),(n=r(n))||W("no binaryen method succeeded. consider enabling more options, like interpreting, if you want that: https://github.com/kripken/emscripten/wiki/WebAssembly#binaryen-methods"),n}}(),m=7920,C.push(),t.STATIC_BASE=1024,t.STATIC_BUMP=6896,m+=16,E(!g),v=m,b=h((y=h(m=m+4+15&-16))+A),p[v>>2]=b,g=!0,t.wasmTableSize=0,t.wasmMaxTableSize=0,t.b={},t.c={enlargeMemory:function(){x()},getTotalMemory:function(){return S},abortOnCannotGrowMemory:x,___setErrNo:function(e){return t.___errno_location&&(p[t.___errno_location()>>2]=e),e},_emscripten_memcpy_big:function(e,t,n){return f.set(f.subarray(t,t+n),e),e},DYNAMICTOP_PTR:v,STACKTOP:y};var U=t.asm(t.b,t.c,d);t.asm=U,t._aez_decrypt=function(){return t.asm._aez_decrypt.apply(null,arguments)},t._aez_encrypt=function(){return t.asm._aez_encrypt.apply(null,arguments)};var q=t._free=function(){return t.asm._free.apply(null,arguments)},F=t._malloc=function(){return t.asm._malloc.apply(null,arguments)};function j(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function H(){function e(){if(!t.calledRun&&(t.calledRun=!0,!w)){if(I||(I=!0,P(C)),P(O),t.onRuntimeInitialized&&t.onRuntimeInitialized(),t.postRun)for("function"==typeof t.postRun&&(t.postRun=[t.postRun]);t.postRun.length;){var e=t.postRun.shift();R.unshift(e)}P(R)}}if(!(0<L)){if(t.preRun)for("function"==typeof t.preRun&&(t.preRun=[t.preRun]);t.preRun.length;)M();P(T),0<L||t.calledRun||(t.setStatus?(t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1),e()},1)):e())}}function W(e){throw t.onAbort&&t.onAbort(e),void 0!==e?(t.print(e),t.printErr(e),e=JSON.stringify(e)):e="",w=!0,"abort("+e+"). Build with -s ASSERTIONS=1 for more info."}if(t.asm=U,t.then=function(e){if(t.calledRun)e(t);else{var n=t.onRuntimeInitialized;t.onRuntimeInitialized=function(){n&&n(),e(t)}}return t},j.prototype=Error(),j.prototype.constructor=j,B=function e(){t.calledRun||H(),t.calledRun||(B=e)},t.run=H,t.exit=function(e,n){n&&t.noExitRuntime&&0===e||(!t.noExitRuntime&&(w=!0,y=void 0,P(N),t.onExit)&&t.onExit(e),c&&process.exit(e),t.quit(e,new j(e)))},t.abort=W,t.preInit)for("function"==typeof t.preInit&&(t.preInit=[t.preInit]);0<t.preInit.length;)t.preInit.pop()();return t.noExitRuntime=!0,H(),function(){function e(e){if(e&&e.buffer instanceof ArrayBuffer)e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength);else if("string"==typeof e){for(var t=e.length,n=new Uint8Array(t+1),r=0;r<t;++r)n[r]=e.charCodeAt(r);return n}return e}function n(t,r){var s=new Number(t);return s.length=r,s.get=function(e){return new(e=e||Uint8Array)(d,s,r/e.BYTES_PER_ELEMENT).slice()},s.dereference=function(e){return e=e||4,n(s.get(Uint32Array)[0],e)},s.set=function(t){if((t=e(t)).length>r)throw RangeError("invalid array length");f.set(t,s)},s.free=function(){q(s),i.splice(i.indexOf(s),1)},i.push(s),s}function r(t,r){r=e(r),0===t&&(t=r.length);var i=n(F(t),t);return void 0!==r?(i.set(r),r.length<t&&f.fill(0,i+r.length,i+t)):f.fill(0,i,i+t),i}var i=[];t.createPointer=n,t.allocatePointer=function(e){return e&&(e=Uint32Array.of(e)),r(4,e)},t.allocateBytes=r,t.freeBytes=function(){for(var e=0,t=i.length;e<t;++e)q(i[e]);i=[]}}(),e};__aez_wasm=__aez_wasm.bind({_currentScript:"undefined"!=typeof document?document.currentScript:void 0,_selfLocation:"undefined"!=typeof self?self.location:void 0}),"object"==typeof exports&&"object"==typeof module?module.exports=__aez_wasm:"function"==typeof define&&define.amd?define("aez.wasm/src/aez",[],function(){return __aez_wasm}):"object"==typeof exports&&(exports.__aez_wasm=__aez_wasm),function(){function e(e){var t,n;function r(e){return e&&e.length?[e.length,t(0,e)]:[0,null]}return e=e(),t=e.allocateBytes,n=e.freeBytes,{ready:e.then,encrypt:function(i,s,o,a,c){var l,u,h,d,f;if(u=(l=r(i))[0],i=l[1],h=(l=r(s))[0],s=l[1],d=(l=r(o))[0],o=l[1],a=t(0,a),u+c===0)throw new Error("Can't encrypt empty plaintext without ciphertext expansion");return f=t(u+c),e._aez_encrypt(f,i,u,s,h,o,d,a,a.length,c),f=f.get(),n(),f},decrypt:function(i,s,o,a,c){var l,u,h,d,f;if(u=(l=r(i))[0],i=l[1],h=(l=r(s))[0],s=l[1],d=(l=r(o))[0],o=l[1],a=t(0,a),f=u-c>0?t(u-c):null,0!==e._aez_decrypt(f,i,u,s,h,o,d,a,a.length,c))throw n(),new Error("Decryption failed");return f?(f=f.get(),n(),f):(n(),new Uint8Array(0))}}}"function"==typeof define&&define.amd?define("aez.wasm/src/index.min",["./aez"],e):"object"==typeof exports?module.exports=e(require("./aez")):this.aez_wasm=e(this.__aez_wasm)}.call(this),define("aez.wasm",["aez.wasm/src/index.min"],function(e){return e});var __noise_c_wasm=function(e){var t;e=e||{},t||(t=void 0!==e?e:{});var n,r={};for(n in t)t.hasOwnProperty(n)&&(r[n]=t[n]);t.arguments=[],t.thisProgram="./this.program",t.quit=function(e,t){throw t},t.preRun=[],t.postRun=[];var i,s,o=!1,a=!1,c=!1,l=!1;if(t.ENVIRONMENT)if("WEB"===t.ENVIRONMENT)o=!0;else if("WORKER"===t.ENVIRONMENT)a=!0;else if("NODE"===t.ENVIRONMENT)c=!0;else{if("SHELL"!==t.ENVIRONMENT)throw Error("Module['ENVIRONMENT'] value is not valid. must be one of: WEB|WORKER|NODE|SHELL.");l=!0}else o="object"==typeof window,a="function"==typeof importScripts,c="object"==typeof process&&"function"==typeof require&&!o&&!a,l=!o&&!c&&!a;if(!t.scriptDirectory)if(t.scriptDirectory="",c)t.scriptDirectory=__dirname+"/";else if(o){var u=this._currentScript||document.currentScript;0!==u.src.indexOf("blob:")&&(t.scriptDirectory=u.src.split("/").slice(0,-1).join("/")+"/")}else a&&(t.scriptDirectory=(this._selfLocation||self.location).href.split("/").slice(0,-1).join("/")+"/");(t.memoryInitializerPrefixURL||(t.memoryInitializerPrefixURL=t.scriptDirectory),t.pthreadMainPrefixURL||(t.pthreadMainPrefixURL=t.scriptDirectory),t.cdInitializerPrefixURL||(t.cdInitializerPrefixURL=t.scriptDirectory),t.filePackagePrefixURL||(t.filePackagePrefixURL=t.scriptDirectory),c)?(t.read=function(e,t){return i||(i=require("fs")),s||(s=require("path")),e=s.normalize(e),e=i.readFileSync(e),t?e:e.toString()},t.readBinary=function(e){return(e=t.read(e,!0)).buffer||(e=new Uint8Array(e)),f(e.buffer),e},1<process.argv.length&&(t.thisProgram=process.argv[1].replace(/\\/g,"/")),t.arguments=process.argv.slice(2),process.on("uncaughtException",function(e){if(!(e instanceof Y))throw e}),process.on("unhandledRejection",function(){process.exit(1)}),t.inspect=function(){return"[Emscripten Module object]"}):l?("undefined"!=typeof read&&(t.read=function(e){return read(e)}),t.readBinary=function(e){return"function"==typeof readbuffer?new Uint8Array(readbuffer(e)):(f("object"==typeof(e=read(e,"binary"))),e)},"undefined"!=typeof scriptArgs?t.arguments=scriptArgs:void 0!==arguments&&(t.arguments=arguments),"function"==typeof quit&&(t.quit=function(e){quit(e)})):(o||a)&&(t.read=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},a&&(t.readBinary=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),t.readAsync=function(e,t,n){var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.onload=function(){200==r.status||0==r.status&&r.response?t(r.response):n()},r.onerror=n,r.send(null)},void 0!==arguments&&(t.arguments=arguments),t.setWindowTitle=function(e){document.title=e});for(n in t.print="undefined"!=typeof console?console.log.bind(console):"undefined"!=typeof print?print:null,t.printErr="undefined"!=typeof printErr?printErr:"undefined"!=typeof console&&console.warn.bind(console)||t.print,t.print=t.print,t.printErr=t.printErr,r)r.hasOwnProperty(n)&&(t[n]=r[n]);function h(e){var t;return t||(t=16),Math.ceil(e/t)*t}r=void 0;var d=0;function f(e,t){e||X("Assertion failed: "+t)}function _(e){var t;if(0===t||!e)return"";for(var n,r=0,i=0;(r|=n=m[e+i>>0],0!=n||t)&&(i++,!t||i!=t););if(t||(t=i),n="",128>r){for(;0<t;)r=String.fromCharCode.apply(String,m.subarray(e,e+Math.min(t,1024))),n=n?n+r:r,e+=1024,t-=1024;return n}e:{for(t=m,r=e;t[r];)++r;if(16<r-e&&t.subarray&&x)e=x.decode(t.subarray(e,r));else for(r="";;){if(!(n=t[e++])){e=r;break e}if(128&n)if(i=63&t[e++],192==(224&n))r+=String.fromCharCode((31&n)<<6|i);else{var s=63&t[e++];if(224==(240&n))n=(15&n)<<12|i<<6|s;else{var o=63&t[e++];if(240==(248&n))n=(7&n)<<18|i<<12|s<<6|o;else{var a=63&t[e++];if(248==(252&n))n=(3&n)<<24|i<<18|s<<12|o<<6|a;else n=(1&n)<<30|i<<24|s<<18|o<<12|a<<6|63&t[e++]}}65536>n?r+=String.fromCharCode(n):(n-=65536,r+=String.fromCharCode(55296|n>>10,56320|1023&n))}else r+=String.fromCharCode(n)}}return e}var p,m,g,y,b,v,w,E,k,x="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function A(){t.HEAP8=new Int8Array(p),t.HEAP16=g=new Int16Array(p),t.HEAP32=y=new Int32Array(p),t.HEAPU8=m=new Uint8Array(p),t.HEAPU16=new Uint16Array(p),t.HEAPU32=new Uint32Array(p),t.HEAPF32=new Float32Array(p),t.HEAPF64=new Float64Array(p)}function S(){X("Cannot enlarge memory arrays. Either (1) compile with  -s TOTAL_MEMORY=X  with X higher than the current value "+T+", (2) compile with  -s ALLOW_MEMORY_GROWTH=1  which allows increasing the size at runtime, or (3) if you want malloc to return NULL (0) instead of this abort, compile with  -s ABORTING_MALLOC=0 ")}"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le"),b=w=0,v=!1;var P=t.TOTAL_STACK||5242880,T=t.TOTAL_MEMORY||16777216;if(T<P&&t.printErr("TOTAL_MEMORY should be larger than TOTAL_STACK, was "+T+"! (TOTAL_STACK="+P+")"),t.buffer?p=t.buffer:("object"==typeof WebAssembly&&"function"==typeof WebAssembly.Memory?(t.wasmMemory=new WebAssembly.Memory({initial:T/65536,maximum:T/65536}),p=t.wasmMemory.buffer):p=new ArrayBuffer(T),t.buffer=p),A(),y[0]=1668509029,g[1]=25459,115!==m[2]||99!==m[3])throw"Runtime error: expected the system to be little-endian!";function C(e){for(;0<e.length;){var n=e.shift();if("function"==typeof n)n();else{var r=n.g;"number"==typeof r?void 0===n.b?t.dynCall_v(r):t.dynCall_vi(r,n.b):r(void 0===n.b?null:n.b)}}}var O=[],N=[],R=[],I=[],M=[],L=!1;function D(){var e=t.preRun.shift();O.unshift(e)}var B=0,z=null,U=null;function q(e){return String.prototype.startsWith?e.startsWith("data:application/octet-stream;base64,"):0===e.indexOf("data:application/octet-stream;base64,")}function F(){return F.a||(F.a=[]),F.a.push(G()),F.a.length-1}t.preloadedImages={},t.preloadedAudios={},function(){function e(){try{if(t.wasmBinary)return new Uint8Array(t.wasmBinary);if(t.readBinary)return t.readBinary(s);throw"on the web, we need the wasm binary to be preloaded and set on Module['wasmBinary']. emcc.py will do that for you when generating HTML (but not JS)"}catch(e){X(e)}}function n(){return t.wasmBinary||!o&&!a||"function"!=typeof fetch?new Promise(function(t){t(e())}):fetch(s,{credentials:"same-origin"}).then(function(e){if(!e.ok)throw"failed to load wasm binary file at '"+s+"'";return e.arrayBuffer()}).catch(function(){return e()})}function r(e){function r(e){if((u=e.exports).memory){e=u.memory;var n=t.buffer;e.byteLength<n.byteLength&&t.printErr("the new buffer in mergeMemory is smaller than the previous one. in native wasm, we should grow memory here"),n=new Int8Array(n),new Int8Array(e).set(n),t.buffer=p=e,A()}t.asm=u,t.usingWasm=!0,B--,t.monitorRunDependencies&&t.monitorRunDependencies(B),0==B&&(null!==z&&(clearInterval(z),z=null),U&&(e=U,U=null,e()))}function i(e){r(e.instance)}function o(e){n().then(function(e){return WebAssembly.instantiate(e,l)}).then(e).catch(function(e){t.printErr("failed to asynchronously prepare wasm: "+e),X(e)})}if("object"!=typeof WebAssembly)return t.printErr("no native wasm support detected"),!1;if(!(t.wasmMemory instanceof WebAssembly.Memory))return t.printErr("no native wasm Memory in use"),!1;if(e.memory=t.wasmMemory,l.global={NaN:NaN,Infinity:1/0},l["global.Math"]=Math,l.env=e,B++,t.monitorRunDependencies&&t.monitorRunDependencies(B),t.instantiateWasm)try{return t.instantiateWasm(l,r)}catch(e){return t.printErr("Module.instantiateWasm callback failed with error: "+e),!1}return t.wasmBinary||"function"!=typeof WebAssembly.instantiateStreaming||q(s)||"function"!=typeof fetch?o(i):WebAssembly.instantiateStreaming(fetch(s,{credentials:"same-origin"}),l).then(i).catch(function(e){t.printErr("wasm streaming compile failed: "+e),t.printErr("falling back to ArrayBuffer instantiation"),o(i)}),{}}var i="noise-c.wast",s="noise-c.wasm?4f6d8",c="noise-c.temp.asm.js";"function"==typeof t.locateFile?(q(i)||(i=t.locateFile(i)),q(s)||(s=t.locateFile(s)),q(c)||(c=t.locateFile(c))):(q(i)||(i=t.scriptDirectory+i),q(s)||(s=t.scriptDirectory+s),q(c)||(c=t.scriptDirectory+c));var l={global:null,env:null,asm2wasm:{"f64-rem":function(e,t){return e%t},debugger:function(){}},parent:t},u=null;t.asmPreload=t.asm;var h=t.reallocBuffer;t.reallocBuffer=function(e){if("asmjs"===d)var n=h(e);else e:{var r=t.usingWasm?65536:16777216;if(0<e%r&&(e+=r-e%r),r=t.buffer.byteLength,t.usingWasm)try{n=-1!==t.wasmMemory.grow((e-r)/65536)?t.buffer=t.wasmMemory.buffer:null;break e}catch(e){n=null;break e}n=void 0}return n};var d="";t.asm=function(e,n){if(!n.table){void 0===(e=t.wasmTableSize)&&(e=1024);var i=t.wasmMaxTableSize;n.table="object"==typeof WebAssembly&&"function"==typeof WebAssembly.Table?void 0!==i?new WebAssembly.Table({initial:e,maximum:i,element:"anyfunc"}):new WebAssembly.Table({initial:e,element:"anyfunc"}):Array(e),t.wasmTable=n.table}return n.memoryBase||(n.memoryBase=t.STATIC_BASE),n.tableBase||(n.tableBase=0),(n=r(n))||X("no binaryen method succeeded. consider enabling more options, like interpreting, if you want that: https://github.com/kripken/emscripten/wiki/WebAssembly#binaryen-methods"),n}}(),b=43712,N.push(),t.STATIC_BASE=1024,t.STATIC_BUMP=42688,b+=16,f(!v),k=b,E=h((w=h(b=b+4+15&-16))+P),y[k>>2]=E,v=!0,t.wasmTableSize=68,t.wasmMaxTableSize=68,t.c={},t.f={abort:X,enlargeMemory:function(){S()},getTotalMemory:function(){return T},abortOnCannotGrowMemory:S,___assert_fail:function(e,t,n,r){X("Assertion failed: "+_(e)+", at: "+[t?_(t):"unknown filename",n,r?_(r):"unknown function"])},___setErrNo:function(e){return t.___errno_location&&(y[t.___errno_location()>>2]=e),e},_emscripten_memcpy_big:function(e,t,n){return m.set(m.subarray(t,t+n),e),e},_llvm_stackrestore:function(e){var t=F.a[e];F.a.splice(e,1),V(t)},_llvm_stacksave:F,_noise_rand_bytes:function(e,n){m.set(t._random_bytes(n),e)},DYNAMICTOP_PTR:k,STACKTOP:w};var j=t.asm(t.c,t.f,p);t.asm=j,t._NoiseBuffer_create=function(){return t.asm._NoiseBuffer_create.apply(null,arguments)},t._NoiseBuffer_get_size=function(){return t.asm._NoiseBuffer_get_size.apply(null,arguments)},t._SymmetricState_get_ck=function(){return t.asm._SymmetricState_get_ck.apply(null,arguments)};var H=t._free=function(){return t.asm._free.apply(null,arguments)},W=t._malloc=function(){return t.asm._malloc.apply(null,arguments)};t._noise_cipherstate_decrypt_with_ad=function(){return t.asm._noise_cipherstate_decrypt_with_ad.apply(null,arguments)},t._noise_cipherstate_encrypt_with_ad=function(){return t.asm._noise_cipherstate_encrypt_with_ad.apply(null,arguments)},t._noise_cipherstate_free=function(){return t.asm._noise_cipherstate_free.apply(null,arguments)},t._noise_cipherstate_get_mac_length=function(){return t.asm._noise_cipherstate_get_mac_length.apply(null,arguments)},t._noise_cipherstate_has_key=function(){return t.asm._noise_cipherstate_has_key.apply(null,arguments)},t._noise_cipherstate_init_key=function(){return t.asm._noise_cipherstate_init_key.apply(null,arguments)},t._noise_cipherstate_new_by_id=function(){return t.asm._noise_cipherstate_new_by_id.apply(null,arguments)},t._noise_dhstate_set_keypair_private=function(){return t.asm._noise_dhstate_set_keypair_private.apply(null,arguments)},t._noise_dhstate_set_public_key=function(){return t.asm._noise_dhstate_set_public_key.apply(null,arguments)},t._noise_handshakestate_fallback_to=function(){return t.asm._noise_handshakestate_fallback_to.apply(null,arguments)},t._noise_handshakestate_free=function(){return t.asm._noise_handshakestate_free.apply(null,arguments)},t._noise_handshakestate_get_action=function(){return t.asm._noise_handshakestate_get_action.apply(null,arguments)},t._noise_handshakestate_get_fixed_ephemeral_dh=function(){return t.asm._noise_handshakestate_get_fixed_ephemeral_dh.apply(null,arguments)},t._noise_handshakestate_get_fixed_hybrid_dh=function(){return t.asm._noise_handshakestate_get_fixed_hybrid_dh.apply(null,arguments)},t._noise_handshakestate_get_handshake_hash=function(){return t.asm._noise_handshakestate_get_handshake_hash.apply(null,arguments)},t._noise_handshakestate_get_local_keypair_dh=function(){return t.asm._noise_handshakestate_get_local_keypair_dh.apply(null,arguments)},t._noise_handshakestate_get_remote_public_key_dh=function(){return t.asm._noise_handshakestate_get_remote_public_key_dh.apply(null,arguments)},t._noise_handshakestate_needs_local_keypair=function(){return t.asm._noise_handshakestate_needs_local_keypair.apply(null,arguments)},t._noise_handshakestate_needs_pre_shared_key=function(){return t.asm._noise_handshakestate_needs_pre_shared_key.apply(null,arguments)},t._noise_handshakestate_needs_remote_public_key=function(){return t.asm._noise_handshakestate_needs_remote_public_key.apply(null,arguments)},t._noise_handshakestate_new_by_name=function(){return t.asm._noise_handshakestate_new_by_name.apply(null,arguments)},t._noise_handshakestate_read_message=function(){return t.asm._noise_handshakestate_read_message.apply(null,arguments)},t._noise_handshakestate_set_pre_shared_key=function(){return t.asm._noise_handshakestate_set_pre_shared_key.apply(null,arguments)},t._noise_handshakestate_set_prologue=function(){return t.asm._noise_handshakestate_set_prologue.apply(null,arguments)},t._noise_handshakestate_split=function(){return t.asm._noise_handshakestate_split.apply(null,arguments)},t._noise_handshakestate_start=function(){return t.asm._noise_handshakestate_start.apply(null,arguments)},t._noise_handshakestate_write_message=function(){return t.asm._noise_handshakestate_write_message.apply(null,arguments)},t._noise_symmetricstate_decrypt_and_hash=function(){return t.asm._noise_symmetricstate_decrypt_and_hash.apply(null,arguments)},t._noise_symmetricstate_encrypt_and_hash=function(){return t.asm._noise_symmetricstate_encrypt_and_hash.apply(null,arguments)},t._noise_symmetricstate_free=function(){return t.asm._noise_symmetricstate_free.apply(null,arguments)},t._noise_symmetricstate_get_mac_length=function(){return t.asm._noise_symmetricstate_get_mac_length.apply(null,arguments)},t._noise_symmetricstate_mix_hash=function(){return t.asm._noise_symmetricstate_mix_hash.apply(null,arguments)},t._noise_symmetricstate_mix_key=function(){return t.asm._noise_symmetricstate_mix_key.apply(null,arguments)},t._noise_symmetricstate_new_by_name=function(){return t.asm._noise_symmetricstate_new_by_name.apply(null,arguments)},t._noise_symmetricstate_split=function(){return t.asm._noise_symmetricstate_split.apply(null,arguments)};var V=t.stackRestore=function(){return t.asm.stackRestore.apply(null,arguments)},G=t.stackSave=function(){return t.asm.stackSave.apply(null,arguments)};function Y(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function $(){function e(){if(!t.calledRun&&(t.calledRun=!0,!d)){if(L||(L=!0,C(N)),C(R),t.onRuntimeInitialized&&t.onRuntimeInitialized(),t.postRun)for("function"==typeof t.postRun&&(t.postRun=[t.postRun]);t.postRun.length;){var e=t.postRun.shift();M.unshift(e)}C(M)}}if(!(0<B)){if(t.preRun)for("function"==typeof t.preRun&&(t.preRun=[t.preRun]);t.preRun.length;)D();C(O),0<B||t.calledRun||(t.setStatus?(t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1),e()},1)):e())}}function X(e){throw t.onAbort&&t.onAbort(e),void 0!==e?(t.print(e),t.printErr(e),e=JSON.stringify(e)):e="",d=!0,"abort("+e+"). Build with -s ASSERTIONS=1 for more info."}if(t.dynCall_vi=function(){return t.asm.dynCall_vi.apply(null,arguments)},t.asm=j,t.then=function(e){if(t.calledRun)e(t);else{var n=t.onRuntimeInitialized;t.onRuntimeInitialized=function(){n&&n(),e(t)}}return t},Y.prototype=Error(),Y.prototype.constructor=Y,U=function e(){t.calledRun||$(),t.calledRun||(U=e)},t.run=$,t.exit=function(e,n){n&&t.noExitRuntime&&0===e||(!t.noExitRuntime&&(d=!0,w=void 0,C(I),t.onExit)&&t.onExit(e),c&&process.exit(e),t.quit(e,new Y(e)))},t.abort=X,t.preInit)for("function"==typeof t.preInit&&(t.preInit=[t.preInit]);0<t.preInit.length;)t.preInit.pop()();return t.noExitRuntime=!0,$(),function(){function e(e){if(e&&e.buffer instanceof ArrayBuffer)e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength);else if("string"==typeof e){for(var t=e.length,n=new Uint8Array(t+1),r=0;r<t;++r)n[r]=e.charCodeAt(r);return n}return e}function n(t,r){var s=new Number(t);return s.length=r,s.get=function(e){return new(e=e||Uint8Array)(p,s,r/e.BYTES_PER_ELEMENT).slice()},s.dereference=function(e){return e=e||4,n(s.get(Uint32Array)[0],e)},s.set=function(t){if((t=e(t)).length>r)throw RangeError("invalid array length");m.set(t,s)},s.free=function(){H(s),i.splice(i.indexOf(s),1)},i.push(s),s}function r(t,r){r=e(r),0===t&&(t=r.length);var i=n(W(t),t);return void 0!==r?(i.set(r),r.length<t&&m.fill(0,i+r.length,i+t)):m.fill(0,i,i+t),i}var i=[];t.createPointer=n,t.allocatePointer=function(e){return e&&(e=Uint32Array.of(e)),r(4,e)},t.allocateBytes=r,t.freeBytes=function(){for(var e=0,t=i.length;e<t;++e)H(i[e]);i=[]}}(),e};__noise_c_wasm=__noise_c_wasm.bind({_currentScript:"undefined"!=typeof document?document.currentScript:void 0,_selfLocation:"undefined"!=typeof self?self.location:void 0}),"object"==typeof exports&&"object"==typeof module?module.exports=__noise_c_wasm:"function"==typeof define&&define.amd?define("noise-c.wasm/src/noise-c",[],function(){return __noise_c_wasm}):"object"==typeof exports&&(exports.__noise_c_wasm=__noise_c_wasm),function(){var e;e={NOISE_CIPHER_NONE:0,NOISE_CIPHER_CHACHAPOLY:17153,NOISE_CIPHER_AESGCM:17154,NOISE_PATTERN_XX_FALLBACK:20496,NOISE_PATTERN_XX_FALLBACK_HFS:20540,NOISE_ROLE_INITIATOR:20993,NOISE_ROLE_RESPONDER:20994,NOISE_ACTION_NONE:0,NOISE_ACTION_WRITE_MESSAGE:16641,NOISE_ACTION_READ_MESSAGE:16642,NOISE_ACTION_FAILED:16643,NOISE_ACTION_SPLIT:16644,NOISE_ERROR_NONE:0,NOISE_ERROR_NO_MEMORY:17665,NOISE_ERROR_UNKNOWN_ID:17666,NOISE_ERROR_UNKNOWN_NAME:17667,NOISE_ERROR_MAC_FAILURE:17668,NOISE_ERROR_NOT_APPLICABLE:17669,NOISE_ERROR_SYSTEM:17670,NOISE_ERROR_REMOTE_KEY_REQUIRED:17671,NOISE_ERROR_LOCAL_KEY_REQUIRED:17672,NOISE_ERROR_PSK_REQUIRED:17673,NOISE_ERROR_INVALID_LENGTH:17674,NOISE_ERROR_INVALID_PARAM:17675,NOISE_ERROR_INVALID_STATE:17676,NOISE_ERROR_INVALID_NONCE:17677,NOISE_ERROR_INVALID_PRIVATE_KEY:17678,NOISE_ERROR_INVALID_PUBLIC_KEY:17679,NOISE_ERROR_INVALID_FORMAT:17680,NOISE_ERROR_INVALID_SIGNATURE:17681,NOISE_MAX_PAYLOAD_LEN:65535},"function"==typeof define&&define.amd?define("noise-c.wasm/src/constants",[],function(){return e}):"object"==typeof exports?module.exports=e:this.__noise_c_wasm_constants=e}.call(this),function(){var e;function t(t,n){var r,i;function s(e,n){var r,s;return r=i(),t._NoiseBuffer_create(r,e,n,e.length),s=r.dereference(),r.free(),s}function o(e,t){var r,i;if(e!==n.NOISE_ERROR_NONE)for(r in i=n)if(i[r]===e){if(t)try{t.free()}catch(e){}throw new Error(r)}}function a(e){var n;if(!(this instanceof a))return new a(e);n=i(),o(t._noise_cipherstate_new_by_id(n,e),n),this._state=n.dereference(),this._mac_length=t._noise_cipherstate_get_mac_length(this._state),n.free()}function c(e){this._state=e,this._mac_length=t._noise_cipherstate_get_mac_length(this._state)}function l(e){var n,s=this;if(!(this instanceof l))return new l(e);n=i(),e=r(0,e),o(t._noise_symmetricstate_new_by_name(n,e),n),this._state=n.dereference(),n.free(),e.free(),Object.defineProperty(this,"_mac_length",{configurable:!0,get:function(){var e;return(e=t._noise_symmetricstate_get_mac_length(s._state))>0&&(s._mac_length=e),e}})}function u(e,n){var s,a;if(!(this instanceof u))return new u(e,n);s=i(),e=r(0,e),a=t._noise_handshakestate_new_by_name(s,e,n),e.free(),o(a,s),this._state=s.dereference(),s.free()}return(t=t())._random_bytes=e,r=t.allocateBytes,i=t.allocatePointer,a.prototype={InitializeKey:function(e){var n;e=r(0,e),n=t._noise_cipherstate_init_key(this._state,e,e.length),e.free(),o(n,this)},HasKey:function(){return 1===t._noise_cipherstate_has_key(this._state)},EncryptWithAd:function(e,n){var i,a,c;return e=r(0,e),i=s(n=r(n.length+this._mac_length,n),n.length-this._mac_length),a=t._noise_cipherstate_encrypt_with_ad(this._state,e,e.length,i),c=n.get(),e.free(),n.free(),i.free(),o(a),c},DecryptWithAd:function(e,n){var i,a,c;return e=r(0,e),i=s(n=r(0,n),n.length),a=t._noise_cipherstate_decrypt_with_ad(this._state,e,e.length,i),c=n.get().slice(0,n.length-this._mac_length),e.free(),n.free(),i.free(),o(a),c},Rekey:function(){throw"Not implemented"},free:function(){var e;e=t._noise_cipherstate_free(this._state),delete this._state,delete this._mac_length,o(e)}},Object.defineProperty(a.prototype,"constructor",{enumerable:!1,value:a}),c.prototype=Object.create(a.prototype),Object.defineProperty(c.prototype,"constructor",{enumerable:!1,value:c}),l.prototype={MixKey:function(e){var n;e=r(0,e),n=t._noise_symmetricstate_mix_key(this._state,e,e.length),e.free(),o(n,this)},MixHash:function(e){var n;e=r(0,e),n=t._noise_symmetricstate_mix_hash(this._state,e,e.length),e.free(),o(n,this)},MixKeyAndHash:function(e){var n,r,s,o;this.MixKey(e),n=i(),r=t._SymmetricState_get_ck(this._state,n),s=n.dereference(r),n.free(),o=s.get(),s.free(),this.MixHash(o)},EncryptAndHash:function(e){var n,i,a;return n=s(e=r(e.length+this._mac_length,e),e.length-this._mac_length),i=t._noise_symmetricstate_encrypt_and_hash(this._state,n),a=e.get(),e.free(),n.free(),o(i,this),a},DecryptAndHash:function(e){var n,i,a;return n=s(e=r(0,e),e.length),i=t._noise_symmetricstate_decrypt_and_hash(this._state,n),a=e.get().slice(0,e.length-this._mac_length),e.free(),n.free(),o(i,this),a},Split:function(){var e,n,r,s,a,l;e=i(),n=i(),r=t._noise_symmetricstate_split(this._state,e,n);try{o(r)}catch(t){throw s=t,e.free(),n.free(),s}a=new c(e.dereference()),l=new c(n.dereference()),e.free(),n.free();try{this.free()}catch(e){s=e;try{a.free()}catch(e){}try{l.free()}catch(e){}throw s}return[a,l]},free:function(){var e;e=t._noise_symmetricstate_free(this._state),delete this._state,delete this._mac_length,o(e)}},Object.defineProperty(l.prototype,"constructor",{enumerable:!1,value:l}),u.prototype={Initialize:function(e,n,i,s){var a,c;if(null==e&&(e=null),null==n&&(n=null),null==i&&(i=null),null==s&&(s=null),e&&(e=r(0,e),a=t._noise_handshakestate_set_prologue(this._state,e,e.length),e.free(),o(a,this)),s&&1===t._noise_handshakestate_needs_pre_shared_key(this._state)&&(s=r(0,s),a=t._noise_handshakestate_set_pre_shared_key(this._state,s,s.length),s.free(),o(a,this)),1===t._noise_handshakestate_needs_local_keypair(this._state)){if(!n)throw new Error("Local static private key (s) required, but not provided");c=t._noise_handshakestate_get_local_keypair_dh(this._state),n=r(0,n),a=t._noise_dhstate_set_keypair_private(c,n,n.length),n.free(),o(a,this)}if(1===t._noise_handshakestate_needs_remote_public_key(this._state)){if(!i)throw new Error("Remote static public key (rs) required, but not provided");c=t._noise_handshakestate_get_remote_public_key_dh(this._state),i=r(0,i),a=t._noise_dhstate_set_public_key(c,i,i.length),i.free(),o(a,this)}o(a=t._noise_handshakestate_start(this._state),this)},GetAction:function(){return t._noise_handshakestate_get_action(this._state)},FallbackTo:function(e){null==e&&(e=n.NOISE_PATTERN_XX_FALLBACK),o(t._noise_handshakestate_fallback_to(this._state,e),this)},WriteMessage:function(e){var i,a,c,l,u,h,d;null==e&&(e=null),a=s(i=r(n.NOISE_MAX_PAYLOAD_LEN),0),c=null,e&&(c=s(e=r(0,e),e.length)),l=t._noise_handshakestate_write_message(this._state,a,c),e&&(e.free(),c.free());try{o(l,this)}catch(e){throw u=e,i.free(),a.free(),u}return h=t._NoiseBuffer_get_size(a),d=i.get().slice(0,h),i.free(),a.free(),d},ReadMessage:function(e,i,a){var c,l,u,h,d,f,_;null==i&&(i=!1),null==a&&(a=!1),c=s(e=r(0,e),e.length),l=null,i&&(l=s(u=r(n.NOISE_MAX_PAYLOAD_LEN),u.length)),h=t._noise_handshakestate_read_message(this._state,c,l),e.free(),c.free();try{o(h,a?void 0:this)}catch(e){throw d=e,i&&(u.free(),l.free()),d}return f=null,i&&(_=t._NoiseBuffer_get_size(l),f=u.get().slice(0,_),u.free(),l.free()),f},Split:function(){var e,n,r,s,a,l;e=i(),n=i(),r=t._noise_handshakestate_split(this._state,e,n);try{o(r,this)}catch(t){throw s=t,e.free(),n.free(),s}a=new c(e.dereference()),l=new c(n.dereference()),e.free(),n.free();try{this.free()}catch(e){s=e;try{a.free()}catch(e){}try{l.free()}catch(e){}throw s}return[a,l]},free:function(){var e;e=t._noise_handshakestate_free(this._state),delete this._state,o(e)}},Object.defineProperty(u.prototype,"constructor",{enumerable:!1,value:u}),{ready:t.then,constants:n,CipherState:a,SymmetricState:l,HandshakeState:u,_lib_internal:t}}e="undefined"!=typeof crypto?function(e){var t;return t=new Uint8Array(e),crypto.getRandomValues(t),t}:require("crypto").randomBytes,"function"==typeof define&&define.amd?define("noise-c.wasm/src/index.min",["./noise-c","./constants"],t):"object"==typeof exports?module.exports=t(require("./noise-c"),require("./constants")):this.noise_c_wasm=t(this.__noise_c_wasm,this.__noise_c_wasm_constants)}.call(this),define("noise-c.wasm",["noise-c.wasm/src/index.min"],function(e){return e});var __blake2_wasm=function(e){var t;e=e||{},t||(t=void 0!==e?e:{});var n,r={};for(n in t)t.hasOwnProperty(n)&&(r[n]=t[n]);t.arguments=[],t.thisProgram="./this.program",t.quit=function(e,t){throw t},t.preRun=[],t.postRun=[];var i,s,o=!1,a=!1,c=!1,l=!1;if(t.ENVIRONMENT)if("WEB"===t.ENVIRONMENT)o=!0;else if("WORKER"===t.ENVIRONMENT)a=!0;else if("NODE"===t.ENVIRONMENT)c=!0;else{if("SHELL"!==t.ENVIRONMENT)throw Error("Module['ENVIRONMENT'] value is not valid. must be one of: WEB|WORKER|NODE|SHELL.");l=!0}else o="object"==typeof window,a="function"==typeof importScripts,c="object"==typeof process&&"function"==typeof require&&!o&&!a,l=!o&&!c&&!a;if(!t.scriptDirectory)if(t.scriptDirectory="",c)t.scriptDirectory=__dirname+"/";else if(o){var u=this._currentScript||document.currentScript;0!==u.src.indexOf("blob:")&&(t.scriptDirectory=u.src.split("/").slice(0,-1).join("/")+"/")}else a&&(t.scriptDirectory=(this._selfLocation||self.location).href.split("/").slice(0,-1).join("/")+"/");(t.memoryInitializerPrefixURL||(t.memoryInitializerPrefixURL=t.scriptDirectory),t.pthreadMainPrefixURL||(t.pthreadMainPrefixURL=t.scriptDirectory),t.cdInitializerPrefixURL||(t.cdInitializerPrefixURL=t.scriptDirectory),t.filePackagePrefixURL||(t.filePackagePrefixURL=t.scriptDirectory),c)?(t.read=function(e,t){return i||(i=require("fs")),s||(s=require("path")),e=s.normalize(e),e=i.readFileSync(e),t?e:e.toString()},t.readBinary=function(e){return(e=t.read(e,!0)).buffer||(e=new Uint8Array(e)),E(e.buffer),e},1<process.argv.length&&(t.thisProgram=process.argv[1].replace(/\\/g,"/")),t.arguments=process.argv.slice(2),process.on("uncaughtException",function(e){if(!(e instanceof j))throw e}),process.on("unhandledRejection",function(){process.exit(1)}),t.inspect=function(){return"[Emscripten Module object]"}):l?("undefined"!=typeof read&&(t.read=function(e){return read(e)}),t.readBinary=function(e){return"function"==typeof readbuffer?new Uint8Array(readbuffer(e)):(E("object"==typeof(e=read(e,"binary"))),e)},"undefined"!=typeof scriptArgs?t.arguments=scriptArgs:void 0!==arguments&&(t.arguments=arguments),"function"==typeof quit&&(t.quit=function(e){quit(e)})):(o||a)&&(t.read=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},a&&(t.readBinary=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),t.readAsync=function(e,t,n){var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.onload=function(){200==r.status||0==r.status&&r.response?t(r.response):n()},r.onerror=n,r.send(null)},void 0!==arguments&&(t.arguments=arguments),t.setWindowTitle=function(e){document.title=e});for(n in t.print="undefined"!=typeof console?console.log.bind(console):"undefined"!=typeof print?print:null,t.printErr="undefined"!=typeof printErr?printErr:"undefined"!=typeof console&&console.warn.bind(console)||t.print,t.print=t.print,t.printErr=t.printErr,r)r.hasOwnProperty(n)&&(t[n]=r[n]);function h(e){var t;return t||(t=16),Math.ceil(e/t)*t}r=void 0;var d,f,_,p,m,g,y,b,v,w=0;function E(e,t){e||W("Assertion failed: "+t)}function k(){t.HEAP8=new Int8Array(d),t.HEAP16=_=new Int16Array(d),t.HEAP32=p=new Int32Array(d),t.HEAPU8=f=new Uint8Array(d),t.HEAPU16=new Uint16Array(d),t.HEAPU32=new Uint32Array(d),t.HEAPF32=new Float32Array(d),t.HEAPF64=new Float64Array(d)}function x(){W("Cannot enlarge memory arrays. Either (1) compile with  -s TOTAL_MEMORY=X  with X higher than the current value "+S+", (2) compile with  -s ALLOW_MEMORY_GROWTH=1  which allows increasing the size at runtime, or (3) if you want malloc to return NULL (0) instead of this abort, compile with  -s ABORTING_MALLOC=0 ")}"undefined"!=typeof TextDecoder&&new TextDecoder("utf8"),"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le"),m=y=0,g=!1;var A=t.TOTAL_STACK||5242880,S=t.TOTAL_MEMORY||16777216;if(S<A&&t.printErr("TOTAL_MEMORY should be larger than TOTAL_STACK, was "+S+"! (TOTAL_STACK="+A+")"),t.buffer?d=t.buffer:("object"==typeof WebAssembly&&"function"==typeof WebAssembly.Memory?(t.wasmMemory=new WebAssembly.Memory({initial:S/65536,maximum:S/65536}),d=t.wasmMemory.buffer):d=new ArrayBuffer(S),t.buffer=d),k(),p[0]=1668509029,_[1]=25459,115!==f[2]||99!==f[3])throw"Runtime error: expected the system to be little-endian!";function P(e){for(;0<e.length;){var n=e.shift();if("function"==typeof n)n();else{var r=n.f;"number"==typeof r?void 0===n.a?t.dynCall_v(r):t.dynCall_vi(r,n.a):r(void 0===n.a?null:n.a)}}}var T=[],C=[],O=[],N=[],R=[],I=!1;function M(){var e=t.preRun.shift();T.unshift(e)}var L=0,D=null,B=null;function z(e){return String.prototype.startsWith?e.startsWith("data:application/octet-stream;base64,"):0===e.indexOf("data:application/octet-stream;base64,")}t.preloadedImages={},t.preloadedAudios={},function(){function e(){try{if(t.wasmBinary)return new Uint8Array(t.wasmBinary);if(t.readBinary)return t.readBinary(s);throw"on the web, we need the wasm binary to be preloaded and set on Module['wasmBinary']. emcc.py will do that for you when generating HTML (but not JS)"}catch(e){W(e)}}function n(){return t.wasmBinary||!o&&!a||"function"!=typeof fetch?new Promise(function(t){t(e())}):fetch(s,{credentials:"same-origin"}).then(function(e){if(!e.ok)throw"failed to load wasm binary file at '"+s+"'";return e.arrayBuffer()}).catch(function(){return e()})}function r(e){function r(e){if((u=e.exports).memory){e=u.memory;var n=t.buffer;e.byteLength<n.byteLength&&t.printErr("the new buffer in mergeMemory is smaller than the previous one. in native wasm, we should grow memory here"),n=new Int8Array(n),new Int8Array(e).set(n),t.buffer=d=e,k()}t.asm=u,t.usingWasm=!0,L--,t.monitorRunDependencies&&t.monitorRunDependencies(L),0==L&&(null!==D&&(clearInterval(D),D=null),B&&(e=B,B=null,e()))}function i(e){r(e.instance)}function o(e){n().then(function(e){return WebAssembly.instantiate(e,l)}).then(e).catch(function(e){t.printErr("failed to asynchronously prepare wasm: "+e),W(e)})}if("object"!=typeof WebAssembly)return t.printErr("no native wasm support detected"),!1;if(!(t.wasmMemory instanceof WebAssembly.Memory))return t.printErr("no native wasm Memory in use"),!1;if(e.memory=t.wasmMemory,l.global={NaN:NaN,Infinity:1/0},l["global.Math"]=Math,l.env=e,L++,t.monitorRunDependencies&&t.monitorRunDependencies(L),t.instantiateWasm)try{return t.instantiateWasm(l,r)}catch(e){return t.printErr("Module.instantiateWasm callback failed with error: "+e),!1}return t.wasmBinary||"function"!=typeof WebAssembly.instantiateStreaming||z(s)||"function"!=typeof fetch?o(i):WebAssembly.instantiateStreaming(fetch(s,{credentials:"same-origin"}),l).then(i).catch(function(e){t.printErr("wasm streaming compile failed: "+e),t.printErr("falling back to ArrayBuffer instantiation"),o(i)}),{}}var i="blake2.wast",s="blake2.wasm?bdab5",c="blake2.temp.asm.js";"function"==typeof t.locateFile?(z(i)||(i=t.locateFile(i)),z(s)||(s=t.locateFile(s)),z(c)||(c=t.locateFile(c))):(z(i)||(i=t.scriptDirectory+i),z(s)||(s=t.scriptDirectory+s),z(c)||(c=t.scriptDirectory+c));var l={global:null,env:null,asm2wasm:{"f64-rem":function(e,t){return e%t},debugger:function(){}},parent:t},u=null;t.asmPreload=t.asm;var h=t.reallocBuffer;t.reallocBuffer=function(e){if("asmjs"===f)var n=h(e);else e:{var r=t.usingWasm?65536:16777216;if(0<e%r&&(e+=r-e%r),r=t.buffer.byteLength,t.usingWasm)try{n=-1!==t.wasmMemory.grow((e-r)/65536)?t.buffer=t.wasmMemory.buffer:null;break e}catch(e){n=null;break e}n=void 0}return n};var f="";t.asm=function(e,n){if(!n.table){void 0===(e=t.wasmTableSize)&&(e=1024);var i=t.wasmMaxTableSize;n.table="object"==typeof WebAssembly&&"function"==typeof WebAssembly.Table?void 0!==i?new WebAssembly.Table({initial:e,maximum:i,element:"anyfunc"}):new WebAssembly.Table({initial:e,element:"anyfunc"}):Array(e),t.wasmTable=n.table}return n.memoryBase||(n.memoryBase=t.STATIC_BASE),n.tableBase||(n.tableBase=0),(n=r(n))||W("no binaryen method succeeded. consider enabling more options, like interpreting, if you want that: https://github.com/kripken/emscripten/wiki/WebAssembly#binaryen-methods"),n}}(),m=2656,C.push(),t.STATIC_BASE=1024,t.STATIC_BUMP=1632,m+=16,E(!g),v=m,b=h((y=h(m=m+4+15&-16))+A),p[v>>2]=b,g=!0,t.wasmTableSize=2,t.wasmMaxTableSize=2,t.b={},t.c={abort:W,enlargeMemory:function(){x()},getTotalMemory:function(){return S},abortOnCannotGrowMemory:x,___setErrNo:function(e){return t.___errno_location&&(p[t.___errno_location()>>2]=e),e},_emscripten_memcpy_big:function(e,t,n){return f.set(f.subarray(t,t+n),e),e},DYNAMICTOP_PTR:v,STACKTOP:y};var U=t.asm(t.b,t.c,d);t.asm=U,t._blake2b_final=function(){return t.asm._blake2b_final.apply(null,arguments)},t._blake2b_init=function(){return t.asm._blake2b_init.apply(null,arguments)},t._blake2b_init_key=function(){return t.asm._blake2b_init_key.apply(null,arguments)},t._blake2b_update=function(){return t.asm._blake2b_update.apply(null,arguments)},t._blake2s_final=function(){return t.asm._blake2s_final.apply(null,arguments)},t._blake2s_init=function(){return t.asm._blake2s_init.apply(null,arguments)},t._blake2s_init_key=function(){return t.asm._blake2s_init_key.apply(null,arguments)},t._blake2s_update=function(){return t.asm._blake2s_update.apply(null,arguments)};var q=t._free=function(){return t.asm._free.apply(null,arguments)},F=t._malloc=function(){return t.asm._malloc.apply(null,arguments)};function j(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function H(){function e(){if(!t.calledRun&&(t.calledRun=!0,!w)){if(I||(I=!0,P(C)),P(O),t.onRuntimeInitialized&&t.onRuntimeInitialized(),t.postRun)for("function"==typeof t.postRun&&(t.postRun=[t.postRun]);t.postRun.length;){var e=t.postRun.shift();R.unshift(e)}P(R)}}if(!(0<L)){if(t.preRun)for("function"==typeof t.preRun&&(t.preRun=[t.preRun]);t.preRun.length;)M();P(T),0<L||t.calledRun||(t.setStatus?(t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1),e()},1)):e())}}function W(e){throw t.onAbort&&t.onAbort(e),void 0!==e?(t.print(e),t.printErr(e),e=JSON.stringify(e)):e="",w=!0,"abort("+e+"). Build with -s ASSERTIONS=1 for more info."}if(t.asm=U,t.then=function(e){if(t.calledRun)e(t);else{var n=t.onRuntimeInitialized;t.onRuntimeInitialized=function(){n&&n(),e(t)}}return t},j.prototype=Error(),j.prototype.constructor=j,B=function e(){t.calledRun||H(),t.calledRun||(B=e)},t.run=H,t.exit=function(e,n){n&&t.noExitRuntime&&0===e||(!t.noExitRuntime&&(w=!0,y=void 0,P(N),t.onExit)&&t.onExit(e),c&&process.exit(e),t.quit(e,new j(e)))},t.abort=W,t.preInit)for("function"==typeof t.preInit&&(t.preInit=[t.preInit]);0<t.preInit.length;)t.preInit.pop()();return t.noExitRuntime=!0,H(),function(){function e(e){if(e&&e.buffer instanceof ArrayBuffer)e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength);else if("string"==typeof e){for(var t=e.length,n=new Uint8Array(t+1),r=0;r<t;++r)n[r]=e.charCodeAt(r);return n}return e}function n(t,r){var s=new Number(t);return s.length=r,s.get=function(e){return new(e=e||Uint8Array)(d,s,r/e.BYTES_PER_ELEMENT).slice()},s.dereference=function(e){return e=e||4,n(s.get(Uint32Array)[0],e)},s.set=function(t){if((t=e(t)).length>r)throw RangeError("invalid array length");f.set(t,s)},s.free=function(){q(s),i.splice(i.indexOf(s),1)},i.push(s),s}function r(t,r){r=e(r),0===t&&(t=r.length);var i=n(F(t),t);return void 0!==r?(i.set(r),r.length<t&&f.fill(0,i+r.length,i+t)):f.fill(0,i,i+t),i}var i=[];t.createPointer=n,t.allocatePointer=function(e){return e&&(e=Uint32Array.of(e)),r(4,e)},t.allocateBytes=r,t.freeBytes=function(){for(var e=0,t=i.length;e<t;++e)q(i[e]);i=[]}}(),e};function k(e){function t(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array(0);for(var t=[0],s=0;s<e.length;s++){var o=n[e[s]];if(void 0===o)return;for(var a=0;a<t.length;++a)o+=t[a]*r,t[a]=255&o,o>>=8;for(;0<o;)t.push(255&o),o>>=8}for(s=0;e[s]===i&&s<e.length-1;++s)t.push(0);return Uint8Array.from(t.reverse())}for(var n={},r=e.length,i=e.charAt(0),s=0;s<e.length;s++){var o=e.charAt(s);if(void 0!==n[o])throw new TypeError(o+" is ambiguous");n[o]=s}return{encode:function(t){if(0===t.length)return"";for(var n=[0],s=0;s<t.length;++s){for(var o=0,a=t[s];o<n.length;++o)a+=n[o]<<8,n[o]=a%r,a=a/r|0;for(;0<a;)n.push(a%r),a=a/r|0}for(s="",o=0;0===t[o]&&o<t.length-1;++o)s+=i;for(t=n.length-1;0<=t;--t)s+=e[n[t]];return s},decodeUnsafe:t,decode:function(e){if(e=t(e))return e;throw Error("Non-base"+r+" character")}}}__blake2_wasm=__blake2_wasm.bind({_currentScript:"undefined"!=typeof document?document.currentScript:void 0,_selfLocation:"undefined"!=typeof self?self.location:void 0}),"object"==typeof exports&&"object"==typeof module?module.exports=__blake2_wasm:"function"==typeof define&&define.amd?define("blake2.wasm/src/blake2",[],function(){return __blake2_wasm}):"object"==typeof exports&&(exports.__blake2_wasm=__blake2_wasm),function(){function e(e){var t;function n(r,i){return null==r&&(r=64),null==i&&(i=null),this instanceof n?(this._output_length=r,this._state=t(240),i&&i.length?(i=t(0,i),e._blake2b_init_key(this._state,r,i,i.length),i.free()):e._blake2b_init(this._state,r)):new n(r,i)}function r(n,i){return null==n&&(n=32),null==i&&(i=null),this instanceof r?(this._output_length=n,this._state=t(176),i&&i.length?(i=t(0,i),e._blake2s_init_key(this._state,n,i,i.length),i.free()):e._blake2s_init(this._state,n)):new r(n,i)}return e=e(),t=e.allocateBytes,e.freeBytes,n.prototype={update:function(n){return n=t(0,n),e._blake2b_update(this._state,n,n.length),n.free(),this},final:function(){var n,r;return n=t(this._output_length),e._blake2b_final(this._state,n,n.length),r=n.get(),n.free(),this._state.free(),r}},Object.defineProperty(n.prototype,"constructor",{value:n}),r.prototype={update:function(n){return n=t(0,n),e._blake2s_update(this._state,n,n.length),n.free(),this},final:function(){var n,r;return n=t(this._output_length),e._blake2s_final(this._state,n,n.length),r=n.get(),n.free(),this._state.free(),r}},Object.defineProperty(r.prototype,"constructor",{value:r}),{ready:e.then,Blake2b:n,Blake2s:r}}"function"==typeof define&&define.amd?define("blake2.wasm/src/index.min",["./blake2"],e):"object"==typeof exports?module.exports=e(require("./blake2")):this.blake2_wasm=e(this.__blake2_wasm)}.call(this),define("blake2.wasm",["blake2.wasm/src/index.min"],function(e){return e}),function(){function e(e){var t;for(t=e.length-1;0<=t;--t){var n=t;if(++e[n],0!==e[n])break}}function t(t,o,a,c,l){function u(e){if(null==e&&(e=null),!(this instanceof u))return new u(e);null===e&&(e=n(48)),this.b=e,this.a=new Uint8Array(12)}function h(e,t){if(!(this instanceof h))return new h(e,t);e?(this.a=c.HandshakeState(r,c.constants.NOISE_ROLE_INITIATOR),this.a.Initialize(null,null,t)):(this.a=c.HandshakeState(r,c.constants.NOISE_ROLE_RESPONDER),this.a.Initialize(null,t))}return u.prototype={get_key:function(){return this.b},wrap:function(t){return e(this.a),a.encrypt(t,new Uint8Array(0),this.a,this.b,0)},unwrap:function(t){return e(this.a),a.decrypt(t,new Uint8Array(0),this.a,this.b,0)}},Object.defineProperty(u.prototype,"constructor",{value:u}),h.prototype={ready:function(){return!this.a},get_handshake_message:function(){var e=null;return this.a&&(this.a.GetAction()===c.constants.NOISE_ACTION_WRITE_MESSAGE&&(e=this.a.WriteMessage()),this.f()),e},put_handshake_message:function(e){this.a&&(this.a.GetAction()===c.constants.NOISE_ACTION_READ_MESSAGE&&this.a.ReadMessage(e),this.f())},f:function(){var e=this.a.GetAction();if(e===c.constants.NOISE_ACTION_SPLIT){e=this.a.Split(),this.c=e[0],this.b=e[1],e=new Uint8Array(0);var t=new Uint8Array(32);this.h=this.c.EncryptWithAd(e,t),this.g=this.b.EncryptWithAd(e,t),delete this.a}else if(e===c.constants.NOISE_ACTION_FAILED)throw delete this.a,Error("Noise handshake failed")},get_rewrapper_keys:function(){return[this.h,this.g]},encrypt:function(e){return this.c.EncryptWithAd(new Uint8Array(0),e)},decrypt:function(e){return this.b.DecryptWithAd(new Uint8Array(0),e)},destroy:function(){this.a&&this.a.free(),this.c&&this.c.free(),this.b&&this.b.free()}},Object.defineProperty(h.prototype,"constructor",{value:h}),{ready:function(e){a.ready(function(){l.ready(function(){o.ready(function(){c.ready(function(){t.ready(function(){e()})})})})})},create_keypair:function(e){null==e&&(e=null),e||(e=t.createSeed());var n=t.createKeyPair(e);return{seed:e,ed25519:{public:n.publicKey,private:n.secretKey},x25519:{public:o.convert_public_key(n.publicKey),private:o.convert_private_key(e)}}},convert_public_key:function(e){return o.convert_public_key(e)},sign:function(e,n,r){return t.sign(e,n,r)},verify:function(e,n,r){return t.verify(e,n,r)},Rewrapper:u,Encryptor:h,one_way_encrypt:function(e,t){var n=c.HandshakeState(i,c.constants.NOISE_ROLE_INITIATOR);n.Initialize(null,null,e),e=n.WriteMessage();var r=n.Split();return n=r[0],r=r[1],t=n.EncryptWithAd(new Uint8Array(0),t),n.free(),r.free(),(n=new Uint8Array(s+t.length)).set(e),n.set(t,s),n},one_way_decrypt:function(e,t){var n=t.subarray(0,s);t=t.subarray(s);var r=c.HandshakeState(i,c.constants.NOISE_ROLE_RESPONDER);return r.Initialize(null,e),r.ReadMessage(n),e=(n=r.Split())[0],t=(n=n[1]).DecryptWithAd(new Uint8Array(0),t),e.free(),n.free(),t},blake2b_256:function(e){return l.Blake2b(32).update(e).final()}}}var n;n="object"==typeof exports?require("crypto").randomBytes:function(e){return e=new Uint8Array(e),crypto.getRandomValues(e),e};var r="Noise_NK_25519_ChaChaPoly_BLAKE2b",i="Noise_N_25519_ChaChaPoly_BLAKE2b",s=48;"function"==typeof define&&define.amd?define("@detox/crypto",["supercop.wasm","ed25519-to-x25519.wasm","aez.wasm","noise-c.wasm","blake2.wasm"],t):"object"==typeof exports?module.exports=t(require("supercop.wasm"),require("ed25519-to-x25519.wasm"),require("aez.wasm"),require("noise-c.wasm"),require("blake2.wasm")):this.detox_crypto=t(this.supercop_wasm,this.ed25519_to_x25519_wasm,this.aez_wasm,this.noise_c_wasm,this.blake2_wasm)}.call(this),function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define("@detox/dht",[],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).detox_dht=e()}(function(){return function e(t,n,r){function i(o,a){if(!n[o]){if(!t[o]){var c="function"==typeof require&&require;if(!a&&c)return c(o,!0);if(s)return s(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[o]={exports:{}};t[o][0].call(u.exports,function(e){return i(t[o][1][e]||e)},u,u.exports,e,t,n,r)}return n[o].exports}for(var s="function"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,t,n){(function(e){function n(e,t,n){for(var r=0,i=1,s=t;s<n;s++){var o=e[s];if(o<58&&o>=48)r=10*r+(o-48);else if(s!==t||43!==o){if(s!==t||45!==o){if(46===o)break;throw new Error("not a number: buffer["+s+"] = "+o)}i=-1}}return r*i}function r(t,n,i,s){return null==t||0===t.length?null:("number"!=typeof n&&null==s&&(s=n,n=void 0),"number"!=typeof i&&null==s&&(s=i,i=void 0),r.position=0,r.encoding=s||null,r.data=e.isBuffer(t)?t.slice(n,i):new e(t),r.bytes=r.data.length,r.next())}r.bytes=0,r.position=0,r.data=null,r.encoding=null,r.next=function(){switch(r.data[r.position]){case 100:return r.dictionary();case 108:return r.list();case 105:return r.integer();default:return r.buffer()}},r.find=function(e){for(var t=r.position,n=r.data.length,i=r.data;t<n;){if(i[t]===e)return t;t++}throw new Error('Invalid data: Missing delimiter "'+String.fromCharCode(e)+'" [0x'+e.toString(16)+"]")},r.dictionary=function(){r.position++;for(var e={};101!==r.data[r.position];)e[r.buffer()]=r.next();return r.position++,e},r.list=function(){r.position++;for(var e=[];101!==r.data[r.position];)e.push(r.next());return r.position++,e},r.integer=function(){var e=r.find(101),t=n(r.data,r.position+1,e);return r.position+=e+1-r.position,t},r.buffer=function(){var e=r.find(58),t=n(r.data,r.position,e),i=++e+t;return r.position=i,r.encoding?r.data.toString(r.encoding,e,i):r.data.slice(e,i)},t.exports=r}).call(this,e("buffer").Buffer)},{buffer:10}],2:[function(e,t,n){var r=e("safe-buffer").Buffer;function i(e,t,n){var s=[],o=null;return i._encode(s,e),o=r.concat(s),i.bytes=o.length,r.isBuffer(t)?(o.copy(t,n),t):o}i.bytes=-1,i._floatConversionDetected=!1,i.getType=function(e){return r.isBuffer(e)?"buffer":Array.isArray(e)?"array":ArrayBuffer.isView(e)?"arraybufferview":e instanceof Number?"number":e instanceof Boolean?"boolean":e instanceof ArrayBuffer?"arraybuffer":typeof e},i._encode=function(e,t){if(null!=t)switch(i.getType(t)){case"buffer":i.buffer(e,t);break;case"object":i.dict(e,t);break;case"array":i.list(e,t);break;case"string":i.string(e,t);break;case"number":case"boolean":i.number(e,t);break;case"arraybufferview":i.buffer(e,r.from(t.buffer,t.byteOffset,t.byteLength));break;case"arraybuffer":i.buffer(e,r.from(t))}};var s=r.from("e"),o=r.from("d"),a=r.from("l");i.buffer=function(e,t){e.push(new r(t.length+":"),t)},i.string=function(e,t){e.push(r.from(r.byteLength(t)+":"+t))},i.number=function(e,t){var n=2147483648*(t/2147483648<<0)+(t%2147483648<<0);e.push(r.from("i"+n+"e")),n===t||i._floatConversionDetected||(i._floatConversionDetected=!0,console.warn('WARNING: Possible data corruption detected with value "'+t+'":','Bencoding only defines support for integers, value was converted to "'+n+'"'),console.trace())},i.dict=function(e,t){e.push(o);for(var n,r=0,a=Object.keys(t).sort(),c=a.length;r<c;r++)null!=t[n=a[r]]&&(i.string(e,n),i._encode(e,t[n]));e.push(s)},i.list=function(e,t){var n=0,r=t.length;for(e.push(a);n<r;n++)null!=t[n]&&i._encode(e,t[n]);e.push(s)},t.exports=i},{"safe-buffer":29}],3:[function(e,t,n){var r=t.exports;r.encode=e("./encode"),r.decode=e("./decode"),r.byteLength=r.encodingLength=function(e){return r.encode(e).length}},{"./decode":1,"./encode":2}],4:[function(e,t,n){(function(n){t.exports=y;var r=e("bencode"),i=e("safe-buffer").Buffer,s=e("debug")("bittorrent-dht"),o=e("buffer-equals"),a=e("events").EventEmitter,c=e("inherits"),l=e("k-bucket"),u=e("k-rpc"),h=e("lru"),d=e("randombytes"),f=e("simple-sha1"),_=e("record-cache"),p=e("last-one-wins"),m=3e5,g=9e5;function y(e){if(!(this instanceof y))return new y(e);e||(e={});var t=this;this._tables=h({maxAge:m,max:e.maxTables||1e3}),this._values=h(e.maxValues||1e3),this._peers=_({maxAge:e.maxAge||0,maxSize:e.maxPeers||1e4}),this._secrets=null,this._hash=e.hash||v,this._hashLength=this._hash(i.from("")).length,this._rpc=e.krpc||u(Object.assign({idLength:this._hashLength},e)),this._rpc.on("query",function(e,n){t._onquery(e,n)}),this._rpc.on("node",function(e){t.emit("node",e)}),this._rpc.on("warning",function(e){t.emit("warning",e)}),this._rpc.on("error",function(e){t.emit("error",e)}),this._rpc.on("listening",function(){t.listening=!0,t._debug("listening %d",t.address().port),t.emit("listening")}),this._rotateSecrets(),this._verify=e.verify||null,this._host=e.host||null,this._interval=setInterval(function(){t._rotateSecrets()},m),this._runningBucketCheck=!1,this._bucketCheckTimeout=null,this._bucketOutdatedTimeSpan=e.timeBucketOutdated||g,this.listening=!1,this.destroyed=!1,this.nodeId=this._rpc.id,this.nodes=this._rpc.nodes;var r=p(function(e,n){var r=e.older,i=e.newer;t._debug("received ping",r,i),t._checkAndRemoveNodes(r,function(e,r){r&&(t._debug("added new node:",i),t.addNode(i)),t._debug("no node added, all other nodes ok"),n()})});this.nodes.on("ping",function(e,t){r({older:e,newer:t})}),n.nextTick(function(){t.destroyed||t._bootstrap(!1!==e.bootstrap)}),a.call(this),this._debug("new DHT %s",this.nodeId)}function b(){}function v(e){return i.from(f.sync(e),"hex")}function w(e,t,n){var r={id:e,token:t,v:n.v};return n.sig&&(r.sig=n.sig,r.k=n.k,n.salt&&(r.salt=n.salt),"number"==typeof n.seq&&(r.seq=n.seq)),r}function E(e,t){return e[t++]+"."+e[t++]+"."+e[t++]+"."+e[t++]}function k(e){var t={seq:e.seq||0,v:e.v};return e.salt&&(t.salt=e.salt),r.encode(t).slice(1,-1)}function x(e){return{host:e.host,port:e.port}}function A(e){if(i.isBuffer(e))return e;if(ArrayBuffer.isView(e))return i.from(e.buffer,e.byteOffset,e.byteLength);if("string"==typeof e)return i.from(e,"hex");throw new Error("Pass a buffer or a string")}c(y,a),y.prototype._setBucketCheckInterval=function(){var e=this,t=6e4;function n(){if(Date.now()-e._rpc.nodes.metadata.lastChange<e._bucketOutdatedTimeSpan)return r();e._pingAll(function(){e.destroyed||(e.nodes.toArray().length<1&&e._bootstrap(!0),r())})}function r(){if(e._runningBucketCheck&&!e.destroyed){var r=Math.floor(Math.random()*t+t/2);e._bucketCheckTimeout=setTimeout(n,r)}}this._runningBucketCheck=!0,r()},y.prototype._pingAll=function(e){this._checkAndRemoveNodes(this.nodes.toArray(),e)},y.prototype.removeBucketCheckInterval=function(){this._runningBucketCheck=!1,clearTimeout(this._bucketCheckTimeout)},y.prototype.updateBucketTimestamp=function(){this._rpc.nodes.metadata.lastChange=Date.now()},y.prototype._checkAndRemoveNodes=function(e,t){var n=this;this._checkNodes(e,function(e,r){r&&n.removeNode(r.id),t(null,r)})},y.prototype._checkNodes=function(e,t){var n=this;!function e(r){if(!r.length)return t(null);var i=r.pop();n._sendPing(i,function(s){if(!s)return n.updateBucketTimestamp(),e(r);n._sendPing(i,function(o){return s?t(null,i):(n.updateBucketTimestamp(),e(r))})})}(e)},y.prototype.addNode=function(e){var t=this;if(e.id){e.id=A(e.id);var n=!!this._rpc.nodes.get(e.id);return this._rpc.nodes.add(e),void(n||(this.emit("node",e),this.updateBucketTimestamp()))}this._sendPing(e,function(e,n){n&&t.addNode(n)})},y.prototype.removeNode=function(e){this._rpc.nodes.remove(A(e))},y.prototype._sendPing=function(e,t){var n=this,r=e.id;this._rpc.query(e,{q:"ping"},function(e,s,o){return e?t(e):s.r&&s.r.id&&i.isBuffer(s.r.id)&&s.r.id.length===n._hashLength?i.isBuffer(r)&&!r.equals(s.r.id)?t(new Error("Unexpected node id")):(n.updateBucketTimestamp(),void t(null,{id:s.r.id,host:o.host||o.address,port:o.port})):t(new Error("Bad reply"))})},y.prototype.toJSON=function(){var e=this,t={};return Object.keys(this._values.cache).forEach(function(n){var r=e._values.cache[n].value;t[n]={v:r.v.toString("hex"),id:r.id.toString("hex")},null!=r.seq&&(t[n].seq=r.seq),null!=r.sig&&(t[n].sig=r.sig.toString("hex")),null!=r.k&&(t[n].k=r.k.toString("hex"))}),{nodes:this._rpc.nodes.toArray().map(x),values:t}},y.prototype.put=function(e,t){(i.isBuffer(e)||"string"==typeof e)&&(e={v:e});var n=!!e.k;if(void 0===e.v)throw new Error("opts.v not given");if(e.v.length>=1e3)throw new Error("v must be less than 1000 bytes in put()");if(n&&void 0!==e.cas&&"number"!=typeof e.cas)throw new Error("opts.cas must be an integer if provided");if(n&&!e.k)throw new Error("opts.k ed25519 public key required for mutable put");if(n&&32!==e.k.length)throw new Error("opts.k ed25519 public key must be 32 bytes");if(n&&"function"!=typeof e.sign&&!i.isBuffer(e.sig))throw new Error("opts.sign function or options.sig signature is required for mutable put");if(n&&e.salt&&e.salt.length>64)throw new Error("opts.salt is > 64 bytes long");if(n&&void 0===e.seq)throw new Error("opts.seq not provided for a mutable update");if(n&&"number"!=typeof e.seq)throw new Error("opts.seq not an integer");return this._put(e,t)},y.prototype._put=function(e,t){t||(t=b);var n=!!e.k,s="string"==typeof e.v?i.from(e.v):e.v,o=n?this._hash(e.salt?i.concat([e.k,e.salt]):e.k):this._hash(r.encode(s)),a=this._tables.get(o.toString("hex"));if(!a)return this._preput(o,e,t);var c={q:"put",a:{id:this._rpc.id,token:null,v:s}};return n&&("number"==typeof e.cas&&(c.a.cas=e.cas),e.salt&&(c.a.salt=e.salt),c.a.k=e.k,c.a.seq=e.seq,"function"==typeof e.sign?c.a.sig=e.sign(k(c.a)):i.isBuffer(e.sig)&&(c.a.sig=e.sig)),this._values.set(o.toString("hex"),c.a),this._rpc.queryAll(a.closest(o),c,null,function(e,n){if(e)return t(e,o,n);t(null,o,n)}),o},y.prototype._preput=function(e,t,n){var r=this;return this._closest(e,{q:"get",a:{id:this._rpc.id,target:e}},null,function(e,i){if(e)return n(e);r.put(t,n)}),e},y.prototype.get=function(e,t,s){e=A(e),"function"==typeof t&&(s=t,t=null),t||(t={});var a=t.verify||this._verify,c=this._hash,l=this._values.get(e.toString("hex"))||null;if(l)return l=w(this._rpc.id,null,l),n.nextTick(u);function u(e){if(e)return s(e);s(null,l)}this._closest(e,{q:"get",a:{id:this._rpc.id,target:e}},function(t){var n=t.r;if(!n||!n.v)return!0;if(n.k||n.sig){if(!a||!n.sig||!n.k)return!0;if(!a(n.sig,k(n),n.k))return!0;o(c(n.salt?i.concat([n.k,n.salt]):n.k),e)&&(!l||n.seq>l.seq)&&(l=n)}else if(o(c(r.encode(n.v)),e))return l=n,!1;return!0},u)},y.prototype.announce=function(e,t,n){if("function"==typeof t)return this.announce(e,0,t);e=A(e),n||(n=b);var r=this._tables.get(e.toString("hex"));if(!r)return this._preannounce(e,t,n);if(this._host){var i=this.listening?this.address().port:0;this._addPeer({host:this._host,port:t||i},e,{host:this._host,port:i})}var s={q:"announce_peer",a:{id:this._rpc.id,token:null,info_hash:e,port:t,implied_port:t?0:1}};this._debug("announce %s %d",e,t),this._rpc.queryAll(r.closest(e),s,null,n)},y.prototype._preannounce=function(e,t,n){var r=this;this.lookup(e,function(i){return r.destroyed?n(new Error("dht is destroyed")):i?n(i):void r.announce(e,t,n)})},y.prototype.lookup=function(e,t){e=A(e),t||(t=b);var r=this,i=!1;function s(t,n){t||(t=r._peers.get(e.toString("hex"),100));for(var i=function(e){var t=[];try{for(var n=0;n<e.length;n++){var r=e[n].readUInt16BE(4);r&&t.push({host:E(e[n],0),port:r})}}catch(e){}return t}(t),s=0;s<i.length;s++)r.emit("peer",i[s],e,n||null)}return this._debug("lookup %s",e),n.nextTick(s),this._closest(e,{q:"get_peers",a:{id:this._rpc.id,info_hash:e}},function(e,t){if(i)return!1;e.r.values&&s(e.r.values,t)},t),function(){i=!0}},y.prototype.address=function(){return this._rpc.address()},y.prototype.listen=function(){this._rpc.bind.apply(this._rpc,arguments),this.updateBucketTimestamp(),this._setBucketCheckInterval()},y.prototype.destroy=function(e){if(this.destroyed)e&&n.nextTick(e);else{this.destroyed=!0;var t=this;clearInterval(this._interval),this.removeBucketCheckInterval(),this._peers.destroy(),this._debug("destroying"),this._rpc.destroy(function(){t.emit("close"),e&&e()})}},y.prototype._onquery=function(e,t){var n=e.q.toString();if(this._debug("received %s query from %s:%d",n,t.address,t.port),e.a)switch(n){case"ping":return this._rpc.response(t,e,{id:this._rpc.id});case"find_node":return this._onfindnode(e,t);case"get_peers":return this._ongetpeers(e,t);case"announce_peer":return this._onannouncepeer(e,t);case"get":return this._onget(e,t);case"put":return this._onput(e,t)}},y.prototype._onfindnode=function(e,t){var n=e.a.target;if(!n)return this._rpc.error(t,e,[203,"`find_node` missing required `a.target` field"]);this.emit("find_node",n);var r=this._rpc.nodes.closest(n);this._rpc.response(t,e,{id:this._rpc.id},r)},y.prototype._ongetpeers=function(e,t){var n=t.address||t.host,r=e.a.info_hash;if(!r)return this._rpc.error(t,e,[203,"`get_peers` missing required `a.info_hash` field"]);this.emit("get_peers",r);var i={id:this._rpc.id,token:this._generateToken(n)},s=this._peers.get(r.toString("hex"));s.length?(i.values=s,this._rpc.response(t,e,i)):this._rpc.response(t,e,i,this._rpc.nodes.closest(r))},y.prototype._onannouncepeer=function(e,t){var n=t.address||t.host,r=e.a.implied_port?t.port:e.a.port;if(!(!r||"number"!=typeof r||r<=0||r>65535)){var i=e.a.info_hash,s=e.a.token;if(i&&s){if(!this._validateToken(n,s))return this._rpc.error(t,e,[203,"cannot `announce_peer` with bad token"]);this.emit("announce_peer",i,{host:n,port:t.port}),this._addPeer({host:n,port:r},i,{host:n,port:t.port}),this._rpc.response(t,e,{id:this._rpc.id})}}},y.prototype._addPeer=function(e,t,n){this._peers.add(t.toString("hex"),function(e,t){for(var n=i.allocUnsafe(6),r=e.split("."),s=0;s<4;s++)n[s]=parseInt(r[s]||0,10);return n.writeUInt16BE(t,4),n}(e.host,e.port)),this.emit("announce",e,t,n)},y.prototype._onget=function(e,t){var n=t.address||t.host,r=e.a.target;if(r){var i=this._generateToken(n),s=this._values.get(r.toString("hex"));if(this.emit("get",r,s),s)this._rpc.response(t,e,w(this._rpc.id,i,s));else{var o=this._rpc.nodes.closest(r);this._rpc.response(t,e,{id:this._rpc.id,token:i},o)}}},y.prototype._onput=function(e,t){var n=t.address||t.host,s=e.a;if(s){var o=e.a.v;if(o){var a=e.a.id;if(a){var c=s.token;if(c){if(!this._validateToken(n,c))return this._rpc.error(t,e,[203,"cannot `put` with bad token"]);if(o.length>1e3)return this._rpc.error(t,e,[205,"data payload too large"]);var l=!(!s.k&&!s.sig);if(!l||s.k||s.sig){var u=l?this._hash(s.salt?i.concat([s.k,s.salt]):s.k):this._hash(r.encode(o)),h=u.toString("hex");if(this.emit("put",u,o),l){if(!this._verify)return this._rpc.error(t,e,[400,"verification not supported"]);if(!this._verify(s.sig,k(s),s.k))return;var d=this._values.get(h);if(d&&"number"==typeof s.cas&&d.seq!==s.cas)return this._rpc.error(t,e,[301,"CAS mismatch, re-read and try again"]);if(d&&"number"==typeof d.seq&&!(s.seq>d.seq))return this._rpc.error(t,e,[302,"sequence number less than current"]);this._values.set(h,{v:o,k:s.k,salt:s.salt,sig:s.sig,seq:s.seq,id:a})}else this._values.set(h,{v:o,id:a});this._rpc.response(t,e,{id:this._rpc.id})}}}}}},y.prototype._bootstrap=function(e){var t=this;if(!e)return n.nextTick(r);function r(){t.ready||(t._debug("emit ready"),t.ready=!0,t.emit("ready"))}this._rpc.populate(t._rpc.id,{q:"find_node",a:{id:t._rpc.id,target:t._rpc.id}},r)},y.prototype._closest=function(e,t,n,r){var s=this,o=new l({localNodeId:e,numberOfNodesPerKBucket:this._rpc.k});this._rpc.closest(e,t,function(t,r){return!t.r||(t.r.token&&t.r.id&&i.isBuffer(t.r.id)&&t.r.id.length===s._hashLength&&(s._debug("found node %s (target: %s)",t.r.id,e),o.add({id:t.r.id,host:r.host||r.address,port:r.port,token:t.r.token})),!n||n(t,r))},function(t,n){if(t)return r(t);s._tables.set(e.toString("hex"),o),s._debug("visited %d nodes",n),r(null,n)})},y.prototype._debug=function(){if(s.enabled){var e=[].slice.call(arguments);e[0]="["+this.nodeId.toString("hex").substring(0,7)+"] "+e[0];for(var t=1;t<e.length;t++)i.isBuffer(e[t])&&(e[t]=e[t].toString("hex"));s.apply(null,e)}},y.prototype._validateToken=function(e,t){var n=this._generateToken(e,this._secrets[0]),r=this._generateToken(e,this._secrets[1]);return o(t,n)||o(t,r)},y.prototype._generateToken=function(e,t){return t||(t=this._secrets[0]),this._hash(i.concat([i.from(e),t]))},y.prototype._rotateSecrets=function(){this._secrets?(this._secrets[1]=this._secrets[0],this._secrets[0]=d(this._hashLength)):this._secrets=[d(this._hashLength),d(this._hashLength)]}}).call(this,e("_process"))},{_process:26,bencode:3,"buffer-equals":11,debug:12,events:14,inherits:16,"k-bucket":19,"k-rpc":21,"last-one-wins":22,lru:23,randombytes:27,"record-cache":28,"safe-buffer":29,"simple-sha1":8}],5:[function(e,t,n){var r=e("./client"),i=e("./server");t.exports=r,t.exports.Client=r,t.exports.Server=i},{"./client":4,"./server":6}],6:[function(e,t,n){t.exports=e("./client")},{"./client":4}],7:[function(e,t,n){},{}],8:[function(e,t,n){arguments[4][7][0].apply(n,arguments)},{dup:7}],9:[function(e,t,n){"use strict";n.byteLength=function(e){return 3*e.length/4-l(e)},n.toByteArray=function(e){var t,n,r,o,a,c=e.length;o=l(e),a=new s(3*c/4-o),n=o>0?c-4:c;var u=0;for(t=0;t<n;t+=4)r=i[e.charCodeAt(t)]<<18|i[e.charCodeAt(t+1)]<<12|i[e.charCodeAt(t+2)]<<6|i[e.charCodeAt(t+3)],a[u++]=r>>16&255,a[u++]=r>>8&255,a[u++]=255&r;return 2===o?(r=i[e.charCodeAt(t)]<<2|i[e.charCodeAt(t+1)]>>4,a[u++]=255&r):1===o&&(r=i[e.charCodeAt(t)]<<10|i[e.charCodeAt(t+1)]<<4|i[e.charCodeAt(t+2)]>>2,a[u++]=r>>8&255,a[u++]=255&r),a},n.fromByteArray=function(e){for(var t,n=e.length,i=n%3,s="",o=[],a=0,c=n-i;a<c;a+=16383)o.push(u(e,a,a+16383>c?c:a+16383));return 1===i?(t=e[n-1],s+=r[t>>2],s+=r[t<<4&63],s+="=="):2===i&&(t=(e[n-2]<<8)+e[n-1],s+=r[t>>10],s+=r[t>>4&63],s+=r[t<<2&63],s+="="),o.push(s),o.join("")};for(var r=[],i=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,c=o.length;a<c;++a)r[a]=o[a],i[o.charCodeAt(a)]=a;function l(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===e[t-2]?2:"="===e[t-1]?1:0}function u(e,t,n){for(var i,s,o=[],a=t;a<n;a+=3)i=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),o.push(r[(s=i)>>18&63]+r[s>>12&63]+r[s>>6&63]+r[63&s]);return o.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},{}],10:[function(e,t,n){"use strict";var r=e("base64-js"),i=e("ieee754");n.Buffer=a,n.SlowBuffer=function(e){return+e!=e&&(e=0),a.alloc(+e)},n.INSPECT_MAX_BYTES=50;var s=2147483647;function o(e){if(e>s)throw new RangeError("Invalid typed array length");var t=new Uint8Array(e);return t.__proto__=a.prototype,t}function a(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return u(e)}return c(e,t,n)}function c(e,t,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return q(e)||e&&q(e.buffer)?function(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');var r;return(r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n)).__proto__=a.prototype,r}(e,t,n):"string"==typeof e?function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!a.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var n=0|f(e,t),r=o(n),i=r.write(e,t);return i!==n&&(r=r.slice(0,i)),r}(e,t):function(e){if(a.isBuffer(e)){var t=0|d(e.length),n=o(t);return 0===n.length?n:(e.copy(n,0,0,t),n)}if(e){if(ArrayBuffer.isView(e)||"length"in e)return"number"!=typeof e.length||F(e.length)?o(0):h(e);if("Buffer"===e.type&&Array.isArray(e.data))return h(e.data)}throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object.")}(e)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('"size" argument must not be negative')}function u(e){return l(e),o(e<0?0:0|d(e))}function h(e){for(var t=e.length<0?0:0|d(e.length),n=o(t),r=0;r<t;r+=1)n[r]=255&e[r];return n}function d(e){if(e>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return 0|e}function f(e,t){if(a.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||q(e))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return B(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return z(e).length;default:if(r)return B(e).length;t=(""+t).toLowerCase(),r=!0}}function _(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function p(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),F(n=+n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=a.from(t,r)),a.isBuffer(t))return 0===t.length?-1:m(e,t,n,r,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):m(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function m(e,t,n,r,i){var s,o=1,a=e.length,c=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;o=2,a/=2,c/=2,n/=2}function l(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(i){var u=-1;for(s=n;s<a;s++)if(l(e,s)===l(t,-1===u?0:s-u)){if(-1===u&&(u=s),s-u+1===c)return u*o}else-1!==u&&(s-=s-u),u=-1}else for(n+c>a&&(n=a-c),s=n;s>=0;s--){for(var h=!0,d=0;d<c;d++)if(l(e,s+d)!==l(t,d)){h=!1;break}if(h)return s}return-1}function g(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var s=t.length;r>s/2&&(r=s/2);for(var o=0;o<r;++o){var a=parseInt(t.substr(2*o,2),16);if(F(a))return o;e[n+o]=a}return o}function y(e,t,n,r){return U(B(t,e.length-n),e,n,r)}function b(e,t,n,r){return U(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function v(e,t,n,r){return b(e,t,n,r)}function w(e,t,n,r){return U(z(t),e,n,r)}function E(e,t,n,r){return U(function(e,t){for(var n,r,i,s=[],o=0;o<e.length&&!((t-=2)<0);++o)r=(n=e.charCodeAt(o))>>8,i=n%256,s.push(i),s.push(r);return s}(t,e.length-n),e,n,r)}function k(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function x(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var s,o,a,c,l=e[i],u=null,h=l>239?4:l>223?3:l>191?2:1;if(i+h<=n)switch(h){case 1:l<128&&(u=l);break;case 2:128==(192&(s=e[i+1]))&&(c=(31&l)<<6|63&s)>127&&(u=c);break;case 3:s=e[i+1],o=e[i+2],128==(192&s)&&128==(192&o)&&(c=(15&l)<<12|(63&s)<<6|63&o)>2047&&(c<55296||c>57343)&&(u=c);break;case 4:s=e[i+1],o=e[i+2],a=e[i+3],128==(192&s)&&128==(192&o)&&128==(192&a)&&(c=(15&l)<<18|(63&s)<<12|(63&o)<<6|63&a)>65535&&c<1114112&&(u=c)}null===u?(u=65533,h=1):u>65535&&(u-=65536,r.push(u>>>10&1023|55296),u=56320|1023&u),r.push(u),i+=h}return function(e){var t=e.length;if(t<=A)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=A));return n}(r)}n.kMaxLength=s,a.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch(e){return!1}}(),a.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(a.prototype,"parent",{get:function(){if(this instanceof a)return this.buffer}}),Object.defineProperty(a.prototype,"offset",{get:function(){if(this instanceof a)return this.byteOffset}}),"undefined"!=typeof Symbol&&Symbol.species&&a[Symbol.species]===a&&Object.defineProperty(a,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),a.poolSize=8192,a.from=function(e,t,n){return c(e,t,n)},a.prototype.__proto__=Uint8Array.prototype,a.__proto__=Uint8Array,a.alloc=function(e,t,n){return function(e,t,n){return l(e),e<=0?o(e):void 0!==t?"string"==typeof n?o(e).fill(t,n):o(e).fill(t):o(e)}(e,t,n)},a.allocUnsafe=function(e){return u(e)},a.allocUnsafeSlow=function(e){return u(e)},a.isBuffer=function(e){return null!=e&&!0===e._isBuffer},a.compare=function(e,t){if(!a.isBuffer(e)||!a.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,s=Math.min(n,r);i<s;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},a.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return a.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=a.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var s=e[n];if(ArrayBuffer.isView(s)&&(s=a.from(s)),!a.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,i),i+=s.length}return r},a.byteLength=f,a.prototype._isBuffer=!0,a.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)_(this,t,t+1);return this},a.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)_(this,t,t+3),_(this,t+1,t+2);return this},a.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)_(this,t,t+7),_(this,t+1,t+6),_(this,t+2,t+5),_(this,t+3,t+4);return this},a.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?x(this,0,e):function(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return T(this,t,n);case"utf8":case"utf-8":return x(this,t,n);case"ascii":return S(this,t,n);case"latin1":case"binary":return P(this,t,n);case"base64":return k(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(e){if(!a.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===a.compare(this,e)},a.prototype.inspect=function(){var e="",t=n.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"},a.prototype.compare=function(e,t,n,r,i){if(!a.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var s=(i>>>=0)-(r>>>=0),o=(n>>>=0)-(t>>>=0),c=Math.min(s,o),l=this.slice(r,i),u=e.slice(t,n),h=0;h<c;++h)if(l[h]!==u[h]){s=l[h],o=u[h];break}return s<o?-1:o<s?1:0},a.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},a.prototype.indexOf=function(e,t,n){return p(this,e,t,n,!0)},a.prototype.lastIndexOf=function(e,t,n){return p(this,e,t,n,!1)},a.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var s=!1;;)switch(r){case"hex":return g(this,e,t,n);case"utf8":case"utf-8":return y(this,e,t,n);case"ascii":return b(this,e,t,n);case"latin1":case"binary":return v(this,e,t,n);case"base64":return w(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,e,t,n);default:if(s)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),s=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var A=4096;function S(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function P(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function T(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",s=t;s<n;++s)i+=D(e[s]);return i}function C(e,t,n){for(var r=e.slice(t,n),i="",s=0;s<r.length;s+=2)i+=String.fromCharCode(r[s]+256*r[s+1]);return i}function O(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function N(e,t,n,r,i,s){if(!a.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<s)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function R(e,t,n,r,i,s){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function I(e,t,n,r,s){return t=+t,n>>>=0,s||R(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function M(e,t,n,r,s){return t=+t,n>>>=0,s||R(e,0,n,8),i.write(e,t,n,r,52,8),n+8}a.prototype.slice=function(e,t){var n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);var r=this.subarray(e,t);return r.__proto__=a.prototype,r},a.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||O(e,t,this.length);for(var r=this[e],i=1,s=0;++s<t&&(i*=256);)r+=this[e+s]*i;return r},a.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||O(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},a.prototype.readUInt8=function(e,t){return e>>>=0,t||O(e,1,this.length),this[e]},a.prototype.readUInt16LE=function(e,t){return e>>>=0,t||O(e,2,this.length),this[e]|this[e+1]<<8},a.prototype.readUInt16BE=function(e,t){return e>>>=0,t||O(e,2,this.length),this[e]<<8|this[e+1]},a.prototype.readUInt32LE=function(e,t){return e>>>=0,t||O(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},a.prototype.readUInt32BE=function(e,t){return e>>>=0,t||O(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},a.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||O(e,t,this.length);for(var r=this[e],i=1,s=0;++s<t&&(i*=256);)r+=this[e+s]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},a.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||O(e,t,this.length);for(var r=t,i=1,s=this[e+--r];r>0&&(i*=256);)s+=this[e+--r]*i;return s>=(i*=128)&&(s-=Math.pow(2,8*t)),s},a.prototype.readInt8=function(e,t){return e>>>=0,t||O(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},a.prototype.readInt16LE=function(e,t){e>>>=0,t||O(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},a.prototype.readInt16BE=function(e,t){e>>>=0,t||O(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},a.prototype.readInt32LE=function(e,t){return e>>>=0,t||O(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},a.prototype.readInt32BE=function(e,t){return e>>>=0,t||O(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},a.prototype.readFloatLE=function(e,t){return e>>>=0,t||O(e,4,this.length),i.read(this,e,!0,23,4)},a.prototype.readFloatBE=function(e,t){return e>>>=0,t||O(e,4,this.length),i.read(this,e,!1,23,4)},a.prototype.readDoubleLE=function(e,t){return e>>>=0,t||O(e,8,this.length),i.read(this,e,!0,52,8)},a.prototype.readDoubleBE=function(e,t){return e>>>=0,t||O(e,8,this.length),i.read(this,e,!1,52,8)},a.prototype.writeUIntLE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||N(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,s=0;for(this[t]=255&e;++s<n&&(i*=256);)this[t+s]=e/i&255;return t+n},a.prototype.writeUIntBE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||N(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,s=1;for(this[t+i]=255&e;--i>=0&&(s*=256);)this[t+i]=e/s&255;return t+n},a.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||N(this,e,t,1,255,0),this[t]=255&e,t+1},a.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||N(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},a.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||N(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},a.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||N(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},a.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||N(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},a.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var i=Math.pow(2,8*n-1);N(this,e,t,n,i-1,-i)}var s=0,o=1,a=0;for(this[t]=255&e;++s<n&&(o*=256);)e<0&&0===a&&0!==this[t+s-1]&&(a=1),this[t+s]=(e/o>>0)-a&255;return t+n},a.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var i=Math.pow(2,8*n-1);N(this,e,t,n,i-1,-i)}var s=n-1,o=1,a=0;for(this[t+s]=255&e;--s>=0&&(o*=256);)e<0&&0===a&&0!==this[t+s+1]&&(a=1),this[t+s]=(e/o>>0)-a&255;return t+n},a.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||N(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},a.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||N(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},a.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||N(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},a.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||N(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},a.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||N(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},a.prototype.writeFloatLE=function(e,t,n){return I(this,e,t,!0,n)},a.prototype.writeFloatBE=function(e,t,n){return I(this,e,t,!1,n)},a.prototype.writeDoubleLE=function(e,t,n){return M(this,e,t,!0,n)},a.prototype.writeDoubleBE=function(e,t,n){return M(this,e,t,!1,n)},a.prototype.copy=function(e,t,n,r){if(!a.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i=r-n;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,n,r);else if(this===e&&n<t&&t<r)for(var s=i-1;s>=0;--s)e[s+t]=this[s+n];else Uint8Array.prototype.set.call(e,this.subarray(n,r),t);return i},a.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!a.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){var i=e.charCodeAt(0);("utf8"===r&&i<128||"latin1"===r)&&(e=i)}}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var s;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(s=t;s<n;++s)this[s]=e;else{var o=a.isBuffer(e)?e:new a(e,r),c=o.length;if(0===c)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<n-t;++s)this[s+t]=o[s%c]}return this};var L=/[^+/0-9A-Za-z-_]/g;function D(e){return e<16?"0"+e.toString(16):e.toString(16)}function B(e,t){var n;t=t||1/0;for(var r=e.length,i=null,s=[],o=0;o<r;++o){if((n=e.charCodeAt(o))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(o+1===r){(t-=3)>-1&&s.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&s.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&s.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;s.push(n)}else if(n<2048){if((t-=2)<0)break;s.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;s.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return s}function z(e){return r.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(L,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function U(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function q(e){return e instanceof ArrayBuffer||null!=e&&null!=e.constructor&&"ArrayBuffer"===e.constructor.name&&"number"==typeof e.byteLength}function F(e){return e!=e}},{"base64-js":9,ieee754:15}],11:[function(e,t,n){(function(e){"use strict";t.exports=function(t,n){if(!e.isBuffer(t)||!e.isBuffer(n))throw new TypeError("Arguments must be Buffers");if(t===n)return!0;if("function"==typeof t.equals)return t.equals(n);if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r]!==n[r])return!1;return!0}}).call(this,{isBuffer:e("../is-buffer/index.js")})},{"../is-buffer/index.js":17}],12:[function(e,t,n){(function(r){function i(){var e;try{e=n.storage.debug}catch(e){}return!e&&void 0!==r&&"env"in r&&(e=r.env.DEBUG),e}(n=t.exports=e("./debug")).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},n.formatArgs=function(e){var t=this.useColors;if(e[0]=(t?"%c":"")+this.namespace+(t?" %c":" ")+e[0]+(t?"%c ":" ")+"+"+n.humanize(this.diff),t){var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var i=0,s=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&"%c"===e&&(s=++i)}),e.splice(s,0,r)}},n.save=function(e){try{null==e?n.storage.removeItem("debug"):n.storage.debug=e}catch(e){}},n.load=i,n.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},n.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),n.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],n.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},n.enable(i())}).call(this,e("_process"))},{"./debug":13,_process:26}],13:[function(e,t,n){function r(e){var t;function r(){if(r.enabled){var e=r,i=+new Date,s=i-(t||i);e.diff=s,e.prev=t,e.curr=i,t=i;for(var o=new Array(arguments.length),a=0;a<o.length;a++)o[a]=arguments[a];o[0]=n.coerce(o[0]),"string"!=typeof o[0]&&o.unshift("%O");var c=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,function(t,r){if("%%"===t)return t;c++;var i=n.formatters[r];if("function"==typeof i){var s=o[c];t=i.call(e,s),o.splice(c,1),c--}return t}),n.formatArgs.call(e,o),(r.log||n.log||console.log.bind(console)).apply(e,o)}}return r.namespace=e,r.enabled=n.enabled(e),r.useColors=n.useColors(),r.color=function(e){var t,r=0;for(t in e)r=(r<<5)-r+e.charCodeAt(t),r|=0;return n.colors[Math.abs(r)%n.colors.length]}(e),r.destroy=i,"function"==typeof n.init&&n.init(r),n.instances.push(r),r}function i(){var e=n.instances.indexOf(this);return-1!==e&&(n.instances.splice(e,1),!0)}(n=t.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},n.disable=function(){n.enable("")},n.enable=function(e){var t;n.save(e),n.names=[],n.skips=[];var r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length;for(t=0;t<i;t++)r[t]&&("-"===(e=r[t].replace(/\*/g,".*?"))[0]?n.skips.push(new RegExp("^"+e.substr(1)+"$")):n.names.push(new RegExp("^"+e+"$")));for(t=0;t<n.instances.length;t++){var s=n.instances[t];s.enabled=n.enabled(s.namespace)}},n.enabled=function(e){if("*"===e[e.length-1])return!0;var t,r;for(t=0,r=n.skips.length;t<r;t++)if(n.skips[t].test(e))return!1;for(t=0,r=n.names.length;t<r;t++)if(n.names[t].test(e))return!0;return!1},n.humanize=e("ms"),n.instances=[],n.names=[],n.skips=[],n.formatters={}},{ms:24}],14:[function(e,t,n){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(e){return"function"==typeof e}function s(e){return"object"==typeof e&&null!==e}function o(e){return void 0===e}t.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,n,r,a,c,l;if(this._events||(this._events={}),"error"===e&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var u=new Error('Uncaught, unspecified "error" event. ('+t+")");throw u.context=t,u}if(o(n=this._events[e]))return!1;if(i(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),n.apply(this,a)}else if(s(n))for(a=Array.prototype.slice.call(arguments,1),r=(l=n.slice()).length,c=0;c<r;c++)l[c].apply(this,a);return!0},r.prototype.addListener=function(e,t){var n;if(!i(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,i(t.listener)?t.listener:t),this._events[e]?s(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,s(this._events[e])&&!this._events[e].warned&&(n=o(this._maxListeners)?r.defaultMaxListeners:this._maxListeners)&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){if(!i(t))throw TypeError("listener must be a function");var n=!1;function r(){this.removeListener(e,r),n||(n=!0,t.apply(this,arguments))}return r.listener=t,this.on(e,r),this},r.prototype.removeListener=function(e,t){var n,r,o,a;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(o=(n=this._events[e]).length,r=-1,n===t||i(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(s(n)){for(a=o;a-- >0;)if(n[a]===t||n[a].listener&&n[a].listener===t){r=a;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(i(n=this._events[e]))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){return this._events&&this._events[e]?i(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(i(t))return 1;if(t)return t.length}return 0},r.listenerCount=function(e,t){return e.listenerCount(t)}},{}],15:[function(e,t,n){n.read=function(e,t,n,r,i){var s,o,a=8*i-r-1,c=(1<<a)-1,l=c>>1,u=-7,h=n?i-1:0,d=n?-1:1,f=e[t+h];for(h+=d,s=f&(1<<-u)-1,f>>=-u,u+=a;u>0;s=256*s+e[t+h],h+=d,u-=8);for(o=s&(1<<-u)-1,s>>=-u,u+=r;u>0;o=256*o+e[t+h],h+=d,u-=8);if(0===s)s=1-l;else{if(s===c)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,r),s-=l}return(f?-1:1)*o*Math.pow(2,s-r)},n.write=function(e,t,n,r,i,s){var o,a,c,l=8*s-i-1,u=(1<<l)-1,h=u>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:s-1,_=r?1:-1,p=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,o=u):(o=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-o))<1&&(o--,c*=2),(t+=o+h>=1?d/c:d*Math.pow(2,1-h))*c>=2&&(o++,c/=2),o+h>=u?(a=0,o=u):o+h>=1?(a=(t*c-1)*Math.pow(2,i),o+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,i),o=0));i>=8;e[n+f]=255&a,f+=_,a/=256,i-=8);for(o=o<<i|a,l+=i;l>0;e[n+f]=255&o,f+=_,o/=256,l-=8);e[n+f-_]|=128*p}},{}],16:[function(e,t,n){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],17:[function(e,t,n){function r(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}t.exports=function(e){return null!=e&&(r(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&r(e.slice(0,0))}(e)||!!e._isBuffer)}},{}],18:[function(e,t,n){!function(e){var t="(0?0?[0-9]|0?[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])",n="[0-9]|[1-2][0-9]|3[0-2]",r="("+t+"\\.){3}"+t+"(\\/("+n+"))?",i="(((([0-9a-fA-F]){1,4}:){6}(([0-9a-fA-F]){1,4}:([0-9a-fA-F]){1,4}|((0?0?[0-9]|0?[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\\.){3}(0?0?[0-9]|0?[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])(\\/([0-9]|[1-2][0-9]|3[0-2]))?)|::(([0-9a-fA-F]){1,4}:){5}(([0-9a-fA-F]){1,4}:([0-9a-fA-F]){1,4}|((0?0?[0-9]|0?[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\\.){3}(0?0?[0-9]|0?[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])(\\/([0-9]|[1-2][0-9]|3[0-2]))?)|([0-9a-fA-F]){1,4}::(([0-9a-fA-F]){1,4}:){4}(([0-9a-fA-F]){1,4}:([0-9a-fA-F]){1,4}|((0?0?[0-9]|0?[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\\.){3}(0?0?[0-9]|0?[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])(\\/([0-9]|[1-2][0-9]|3[0-2]))?)|(([0-9a-fA-F]){1,4}:){0,1}([0-9a-fA-F]){1,4}::(([0-9a-fA-F]){1,4}:){3}(([0-9a-fA-F]){1,4}:([0-9a-fA-F]){1,4}|((0?0?[0-9]|0?[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\\.){3}(0?0?[0-9]|0?[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])(\\/([0-9]|[1-2][0-9]|3[0-2]))?)|(([0-9a-fA-F]){1,4}:){0,2}([0-9a-fA-F]){1,4}::(([0-9a-fA-F]){1,4}:){2}(([0-9a-fA-F]){1,4}:([0-9a-fA-F]){1,4}|((0?0?[0-9]|0?[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\\.){3}(0?0?[0-9]|0?[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])(\\/([0-9]|[1-2][0-9]|3[0-2]))?)|(([0-9a-fA-F]){1,4}:){0,3}([0-9a-fA-F]){1,4}::([0-9a-fA-F]){1,4}:(([0-9a-fA-F]){1,4}:([0-9a-fA-F]){1,4}|((0?0?[0-9]|0?[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\\.){3}(0?0?[0-9]|0?[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])(\\/([0-9]|[1-2][0-9]|3[0-2]))?)|(([0-9a-fA-F]){1,4}:){0,4}([0-9a-fA-F]){1,4}::(([0-9a-fA-F]){1,4}:([0-9a-fA-F]){1,4}|((0?0?[0-9]|0?[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\\.){3}(0?0?[0-9]|0?[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])(\\/([0-9]|[1-2][0-9]|3[0-2]))?)|(([0-9a-fA-F]){1,4}:){0,5}([0-9a-fA-F]){1,4}::([0-9a-fA-F]){1,4}|(([0-9a-fA-F]){1,4}:){0,6}([0-9a-fA-F]){1,4}::)(\\/("+n+"))?)",s="((v|V)[0-9a-fA-F]+\\.[a-zA-Z0-9-\\._~!$&'()*+,;=:]+("+n+")?)",o=new RegExp("^("+r+"|"+i+"|"+s+")$"),a=new RegExp("^"+r+"$"),c=new RegExp("^"+i+"$"),l=new RegExp("^"+s+"$");e.exports={test:function(e){return o.test(e)},v4:function(e){return a.test(e)},v6:function(e){return c.test(e)},future:function(e){return l.test(e)}}}(t)},{}],19:[function(e,t,n){"use strict";var r=e("randombytes"),i=e("events").EventEmitter,s=e("inherits");function o(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(var n=0,r=e.length;n<r;++n)if(e[n]!==t[n])return!1;return!0}function a(e){if(i.call(this),e=e||{},this.localNodeId=e.localNodeId||r(20),!(this.localNodeId instanceof Uint8Array))throw new TypeError("localNodeId is not a Uint8Array");this.numberOfNodesPerKBucket=e.numberOfNodesPerKBucket||20,this.numberOfNodesToPing=e.numberOfNodesToPing||3,this.distance=e.distance||a.distance,this.arbiter=e.arbiter||a.arbiter,this.root={contacts:[],dontSplit:!1,left:null,right:null},this.metadata=Object.assign({},e.metadata)}t.exports=a,s(a,i),a.arbiter=function(e,t){return e.vectorClock>t.vectorClock?e:t},a.distance=function(e,t){for(var n=0,r=Math.min(e.length,t.length),i=Math.max(e.length,t.length),s=0;s<r;++s)n=256*n+(e[s]^t[s]);for(;s<i;++s)n=256*n+255;return n},a.prototype.add=function(e){if(!(e&&e.id instanceof Uint8Array))throw new TypeError("contact.id is not a Uint8Array");for(var t=0,n=this.root;null===n.contacts;)n=this._determineNode(n,e.id,t++);var r=this._indexOf(n,e.id);return r>=0?(this._update(n,r,e),this):n.contacts.length<this.numberOfNodesPerKBucket?(n.contacts.push(e),this.emit("added",e),this):n.dontSplit?(this.emit("ping",n.contacts.slice(0,this.numberOfNodesToPing),e),this):(this._split(n,t),this.add(e))},a.prototype.closest=function(e,t){if(!(e instanceof Uint8Array))throw new TypeError("id is not a Uint8Array");if(void 0===t&&(t=1/0),"number"!=typeof t||isNaN(t)||t<=0)throw new TypeError("n is not positive number");for(var n=[],r=[this.root],i=0;r.length>0&&n.length<t;){var s=r.pop();if(null===s.contacts){var o=this._determineNode(s,e,i++);r.push(s.left===o?s.right:s.left),r.push(o)}else n=n.concat(s.contacts)}var a=this;return n.sort(function(t,n){return a.distance(t.id,e)-a.distance(n.id,e)}).slice(0,t)},a.prototype.count=function(){for(var e=0,t=[this.root];t.length>0;){var n=t.pop();null===n.contacts?t.push(n.right,n.left):e+=n.contacts.length}return e},a.prototype._determineNode=function(e,t,n){var r=~~(n/8),i=n%8;return t.length<=r&&0!==i?e.left:t[r]&Math.pow(2,7-i)?e.right:e.left},a.prototype.get=function(e){if(!(e instanceof Uint8Array))throw new TypeError("id is not a Uint8Array");for(var t=0,n=this.root;null===n.contacts;)n=this._determineNode(n,e,t++);var r=this._indexOf(n,e);return r>=0?n.contacts[r]:null},a.prototype._indexOf=function(e,t){for(var n=0;n<e.contacts.length;++n)if(o(e.contacts[n].id,t))return n;return-1},a.prototype.remove=function(e){if(!(e instanceof Uint8Array))throw new TypeError("id is not a Uint8Array");for(var t=0,n=this.root;null===n.contacts;)n=this._determineNode(n,e,t++);var r=this._indexOf(n,e);if(r>=0){var i=n.contacts.splice(r,1)[0];this.emit("removed",i)}return this},a.prototype._split=function(e,t){e.left={contacts:[],dontSplit:!1,left:null,right:null},e.right={contacts:[],dontSplit:!1,left:null,right:null};for(var n=0;n<e.contacts.length;++n){var r=e.contacts[n];this._determineNode(e,r.id,t).contacts.push(r)}e.contacts=null;var i=this._determineNode(e,this.localNodeId,t);(e.left===i?e.right:e.left).dontSplit=!0},a.prototype.toArray=function(){for(var e=[],t=[this.root];t.length>0;){var n=t.pop();null===n.contacts?t.push(n.right,n.left):e=e.concat(n.contacts)}return e},a.prototype._update=function(e,t,n){if(!o(e.contacts[t].id,n.id))throw new Error("wrong index for _update");var r=e.contacts[t],i=this.arbiter(r,n);i===r&&r!==n||(e.contacts.splice(t,1),e.contacts.push(i),this.emit("updated",r,i))}},{events:14,inherits:16,randombytes:27}],20:[function(e,t,n){var r=e("dgram"),i=e("bencode"),s=e("net").isIP,o=e("dns"),a=e("util"),c=e("events"),l=e("safe-buffer").Buffer,u=e("buffer-equals"),h=new Error("Query timed out");h.code="ETIMEDOUT";var d=new Error("Unexpected node id");function f(e){if(!(this instanceof f))return new f(e);e||(e={});var t=this;this.timeout=e.timeout||2e3,this.inflight=0,this.destroyed=!1,this.isIP=e.isIP||s,this.socket=e.socket||r.createSocket("udp4"),this.socket.on("message",function(e,n){if(!t.destroyed&&n.port){try{var r=i.decode(e)}catch(e){return t.emit("warning",e)}var s=r&&r.y&&r.y.toString();if("r"===s||"e"===s){if(!l.isBuffer(r.t))return;try{var o=r.t.readUInt16BE(0)}catch(f){return t.emit("warning",f)}var a=t._ids.indexOf(o);if(-1===a||0===o)return t.emit("response",r,n),void t.emit("warning",new Error("Unexpected transaction id: "+o));var c=t._reqs[a];if(c.peer.host!==n.address)return t.emit("response",r,n),void t.emit("warning",new Error("Out of order response"));if(t._ids[a]=0,t._reqs[a]=null,t.inflight--,"e"===s){var h=Array.isArray(r.e),f=new Error(h?r.e.join(" "):"Unknown error");return f.code=h&&r.e.length&&"number"==typeof r.e[0]?r.e[0]:0,c.callback(f,r,n,c.message),t.emit("update"),void t.emit("postupdate")}var _=r.r&&r.r.id;if(c.peer&&c.peer.id&&_&&!u(c.peer.id,_))return c.callback(d,null,n),t.emit("update"),void t.emit("postupdate");c.callback(null,r,n,c.message),t.emit("update"),t.emit("postupdate"),t.emit("response",r,n)}else"q"===s?t.emit("query",r,n):t.emit("warning",new Error("Unknown type: "+s))}}),this.socket.on("error",function(e){"EACCES"===e.code||"EADDRINUSE"===e.code?t.emit("error",e):t.emit("warning",e)}),this.socket.on("listening",function(){t.emit("listening")}),this._tick=0,this._ids=[],this._reqs=[],this._timer=setInterval(function(){var e=t.inflight;if(e)for(var n=0;n<t._reqs.length;n++){var r=t._reqs[n];if(r&&(r.ttl?r.ttl--:t._cancel(n,h),!--e))return}},this.timeout/4|0),c.EventEmitter.call(this)}function _(){}d.code="EUNEXPECTEDNODE",t.exports=f,a.inherits(f,c.EventEmitter),f.prototype.address=function(){return this.socket.address()},f.prototype.response=function(e,t,n,r){this.send(e,{t:t.t,y:"r",r:n},r)},f.prototype.error=function(e,t,n,r){this.send(e,{t:t.t,y:"e",e:[].concat(n.message||n)},r)},f.prototype.send=function(e,t,n){var r=i.encode(t);this.socket.send(r,0,r.length,e.port,e.address||e.host,n||_)},f.prototype.bind=function(){this.socket.bind.apply(this.socket,arguments)},f.prototype.destroy=function(e){this.destroyed=!0,clearInterval(this._timer),e&&this.socket.on("close",e);for(var t=0;t<this._ids.length;t++)this._cancel(t);this.socket.close()},f.prototype.query=function(e,t,n){if(n||(n=_),!this.isIP(e.host))return this._resolveAndQuery(e,t,n);var r={t:l.allocUnsafe(2),y:"q",q:t.q,a:t.a},i={ttl:4,peer:e,message:r,callback:n};65535===this._tick&&(this._tick=0);var s=++this._tick,o=this._ids.indexOf(0);for(-1===o&&(o=this._ids.push(0)-1),this._ids[o]=s;this._reqs.length<o;)this._reqs.push(null);return this._reqs[o]=i,this.inflight++,r.t.writeUInt16BE(s,0),this.send(e,r),s},f.prototype.cancel=function(e,t){var n=this._ids.indexOf(e);n>-1&&this._cancel(n,t)},f.prototype._cancel=function(e,t){var n=this._reqs[e];this._ids[e]=0,this._reqs[e]=null,n&&(this.inflight--,n.callback(t||new Error("Query was cancelled"),null,n.peer),this.emit("update"),this.emit("postupdate"))},f.prototype._resolveAndQuery=function(e,t,n){var r=this;o.lookup(e.host,function(i,s){return i?n(i):r.destroyed?n(new Error("k-rpc-socket is destroyed")):void r.query({host:s,port:e.port},t,n)})}},{bencode:3,"buffer-equals":11,dgram:8,dns:8,events:14,net:8,"safe-buffer":29,util:32}],21:[function(e,t,n){(function(n){var r=e("k-rpc-socket"),i=e("k-bucket"),s=e("buffer-equals"),o=e("events"),a=e("randombytes"),c=e("util"),l=e("safe-buffer").Buffer,u=20,h=16,d=[{host:"router.bittorrent.com",port:6881},{host:"router.utorrent.com",port:6881},{host:"dht.transmissionbt.com",port:6881}];function f(e){if(!(this instanceof f))return new f(e);e||(e={});var t,n=this;function i(e,t){e&&_(e.id,n._idLength)&&!n.nodes.get(e.id)&&!s(e.id,n.id)&&n._addNode({id:e.id,host:t.address||t.host,port:t.port,distance:0})}this._idLength=e.idLength||20,this.id=function(e){if(l.isBuffer(e))return e;if(ArrayBuffer.isView(e))return l.from(e.buffer,e.byteOffset,e.byteLength);if("string"==typeof e)return l.from(e,"hex");throw new Error("Pass a buffer or a string")}(e.id||e.nodeId||a(this._idLength)),this.socket=e.krpcSocket||r(e),this.bootstrap=!1===(t=e.nodes||e.bootstrap)?[]:!0===t?d:[].concat(t||d).map(m),this.concurrency=e.concurrency||h,this.backgroundConcurrency=e.backgroundConcurrency||this.concurrency/4|0,this.k=e.k||u,this.destroyed=!1,this.pending=[],this.nodes=null,this.socket.setMaxListeners(0),this.socket.on("query",function(e,t){i(e.a,t),n.emit("query",e,t)}),this.socket.on("response",function(e,t){i(e.r,t)}),this.socket.on("warning",function(e){n.emit("warning",e)}),this.socket.on("error",function(e){n.emit("error",e)}),this.socket.on("update",function(){for(;n.pending.length&&n.socket.inflight<n.concurrency;){var e=n.pending.shift();n.query(e[0],e[1],e[2])}}),this.socket.on("listening",function(){n.emit("listening")}),o.EventEmitter.call(this),this.clear()}function _(e,t){return e&&l.isBuffer(e)&&e.length===t}function p(e,t){return e[t++]+"."+e[t++]+"."+e[t++]+"."+e[t++]}function m(e){return"string"==typeof e?{host:e.split(":")[0],port:Number(e.split(":")[1])}:e}function g(){}t.exports=f,c.inherits(f,o.EventEmitter),f.prototype.response=function(e,t,n,r,i){"function"==typeof r&&(i=r,r=null),n.id||(n.id=this.id),r&&(n.nodes=function(e,t){for(var n=l.allocUnsafe(e.length*(t+6)),r=0,i=0;i<e.length;i++){var s=e[i];if(_(s.id,t)){s.id.copy(n,r),r+=t;for(var o=(s.host||s.address).split("."),a=0;a<4;a++)n[r++]=parseInt(o[a]||0,10);n.writeUInt16BE(s.port,r),r+=2}}return r===n.length?n:n.slice(0,r)}(r,this._idLength)),this.socket.response(e,t,n,i)},f.prototype.error=function(e,t,n,r){this.socket.error(e,t,n,r)},f.prototype.bind=function(){this.socket.bind.apply(this.socket,arguments)},f.prototype.address=function(){return this.socket.address()},f.prototype.queryAll=function(e,t,n,r){t.a||(t.a={}),t.a.id||(t.a.id=this.id);var i=!1,s=e.length,o=0,a=null;if(!s)return r(new Error("No nodes to query"),0);for(var c=0;c<e.length;c++)this.query(e[c],t,l);function l(e,t,c){e?e.code>=300&&e.code<400&&(a=e):o++,e||i||n&&!1===n(t,c)&&(i=!0),--s||r(o?null:a||new Error("All queries failed"),o)}},f.prototype.query=function(e,t,n){this.socket.inflight>=this.concurrency?this.pending.push([e,t,n]):(t.a||(t.a={}),t.a.id||(t.a.id=this.id),e.token&&(t.a.token=e.token),this.socket.query(e,t,n))},f.prototype.destroy=function(e){this.destroyed=!0,this.socket.destroy(e)},f.prototype.clear=function(){var e=this;this.nodes=new i({localNodeId:this.id,numberOfNodesPerKBucket:this.k,numberOfNodesToPing:this.concurrency}),this.nodes.on("ping",function(t,n){e.emit("ping",t,n)})},f.prototype.populate=function(e,t,n){this._closest(e,t,!0,null,n)},f.prototype.closest=function(e,t,n,r){this._closest(e,t,!1,n,r)},f.prototype._addNode=function(e){var t=this.nodes.get(e.id);this.nodes.add(e),t||this.emit("node",e)},f.prototype._closest=function(e,t,r,o,a){a||(a=g);var c=this,l=0,u={},h=0,d=!0,f=!1;t.a||(t.a={}),t.a.id||(t.a.id=this.id);var m=new i({localNodeId:e,numberOfNodesPerKBucket:this.k,numberOfNodesToPing:this.concurrency}),y=r?"postupdate":"update";function b(){if(!(c.destroyed||c.socket.inflight>=c.concurrency)){var i=c.pending.length+c.socket.inflight-h;if(!(r&&c.socket.inflight>=c.backgroundConcurrency&&i)){var s=m.closest(e,c.k);(!s.length||s.length<c.bootstrap.length)&&(!(s=c.nodes.closest(e,c.k)).length||s.length<c.bootstrap.length)&&d&&(d=!1,c.bootstrap.forEach(function(e){h++,c.socket.query(e,t,w)}));for(var o=0;o<s.length&&!f;o++){if(c.socket.inflight>=c.concurrency)return;var a=s[o],l=a.host+":"+a.port;u[l]||(u[l]=!0,h++,c.socket.query(a,t,w))}h||(c.socket.removeListener(y,b),n.nextTick(v))}}}function v(){a(null,l)}function w(e,t,n){h--,n&&(u[(n.address||n.host)+":"+n.port]=!0),n&&n.id&&c.nodes.get(n.id)&&(!e||"EUNEXPECTEDNODE"!==e.code&&"ETIMEDOUT"!==e.code||c.nodes.remove(n.id));var r=t&&t.r;if(!r)return b();!e&&_(r.id,c._idLength)&&(l++,E({id:r.id,port:n.port,host:n.host||n.address,distance:0}));for(var i=r.nodes?function(e,t){var n=[];try{for(var r=0;r<e.length;r+=t+6){var i=e.readUInt16BE(r+(t+4));i&&n.push({id:e.slice(r,r+t),host:p(e,r+t),port:i,distance:0,token:null})}}catch(e){}return n}(r.nodes,c._idLength):[],s=0;s<i.length;s++)E(i[s]);o&&!1===o(t,n)&&(f=!0),b()}function E(e){s(e.id,c.id)||m.add(e)}this.socket.on(y,b),b()}}).call(this,e("_process"))},{_process:26,"buffer-equals":11,events:14,"k-bucket":19,"k-rpc-socket":20,randombytes:27,"safe-buffer":29,util:32}],22:[function(e,t,n){function r(e){}t.exports=function(e){var t=null,n=null,i=null,s=null;return function(e,t){s=e,o(t||r)};function o(r){if(n)return t||(t=[]),void t.push(r);var i=s;s=null,n=r,e(i,a)}function a(e){var s=n,a=i;if(i=null,n=null,t&&(i=t,t=null,o(r)),a)for(var c=0;c<a.length;c++)a[c](e);s(e)}}},{}],23:[function(e,t,n){var r=e("events"),i=e("inherits");function s(e){if(!(this instanceof s))return new s(e);"number"==typeof e&&(e={max:e}),e||(e={}),r.EventEmitter.call(this),this.cache={},this.head=this.tail=null,this.length=0,this.max=e.max||1e3,this.maxAge=e.maxAge||0}t.exports=s,i(s,r.EventEmitter),Object.defineProperty(s.prototype,"keys",{get:function(){return Object.keys(this.cache)}}),s.prototype.clear=function(){this.cache={},this.head=this.tail=null,this.length=0},s.prototype.remove=function(e){if("string"!=typeof e&&(e=""+e),this.cache.hasOwnProperty(e)){var t=this.cache[e];return delete this.cache[e],this._unlink(e,t.prev,t.next),t.value}},s.prototype._unlink=function(e,t,n){this.length--,0===this.length?this.head=this.tail=null:this.head===e?(this.head=t,this.cache[this.head].next=null):this.tail===e?(this.tail=n,this.cache[this.tail].prev=null):(this.cache[t].next=n,this.cache[n].prev=t)},s.prototype.peek=function(e){if(this.cache.hasOwnProperty(e)){var t=this.cache[e];if(this._checkAge(e,t))return t.value}},s.prototype.set=function(e,t){var n;if("string"!=typeof e&&(e=""+e),this.cache.hasOwnProperty(e)){if((n=this.cache[e]).value=t,this.maxAge&&(n.modified=Date.now()),e===this.head)return t;this._unlink(e,n.prev,n.next)}else n={value:t,modified:0,next:null,prev:null},this.maxAge&&(n.modified=Date.now()),this.cache[e]=n,this.length===this.max&&this.evict();return this.length++,n.next=null,n.prev=this.head,this.head&&(this.cache[this.head].next=e),this.head=e,this.tail||(this.tail=e),t},s.prototype._checkAge=function(e,t){return!(this.maxAge&&Date.now()-t.modified>this.maxAge&&(this.remove(e),this.emit("evict",{key:e,value:t.value}),1))},s.prototype.get=function(e){if("string"!=typeof e&&(e=""+e),this.cache.hasOwnProperty(e)){var t=this.cache[e];if(this._checkAge(e,t))return this.head!==e&&(e===this.tail?(this.tail=t.next,this.cache[this.tail].prev=null):this.cache[t.prev].next=t.next,this.cache[t.next].prev=t.prev,this.cache[this.head].next=e,t.prev=this.head,t.next=null,this.head=e),t.value}},s.prototype.evict=function(){if(this.tail){var e=this.tail,t=this.remove(this.tail);this.emit("evict",{key:e,value:t})}}},{events:14,inherits:16}],24:[function(e,t,n){var r=1e3,i=6e4,s=36e5,o=24*s;function a(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}t.exports=function(e,t){t=t||{};var n,c=typeof e;if("string"===c&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*n;case"days":case"day":case"d":return n*o;case"hours":case"hour":case"hrs":case"hr":case"h":return n*s;case"minutes":case"minute":case"mins":case"min":case"m":return n*i;case"seconds":case"second":case"secs":case"sec":case"s":return n*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}(e);if("number"===c&&!1===isNaN(e))return t.long?a(n=e,o,"day")||a(n,s,"hour")||a(n,i,"minute")||a(n,r,"second")||n+" ms":function(e){return e>=o?Math.round(e/o)+"d":e>=s?Math.round(e/s)+"h":e>=i?Math.round(e/i)+"m":e>=r?Math.round(e/r)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},{}],25:[function(e,t,n){t.exports=n=window.fetch,n.default=window.fetch.bind(window),n.Headers=window.Headers,n.Request=window.Request,n.Response=window.Response},{}],26:[function(e,t,n){var r,i,s=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function c(e){if(r===setTimeout)return setTimeout(e,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:o}catch(e){r=o}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(e){i=a}}();var l,u=[],h=!1,d=-1;function f(){h&&l&&(h=!1,l.length?u=l.concat(u):d=-1,u.length&&_())}function _(){if(!h){var e=c(f);h=!0;for(var t=u.length;t;){for(l=u,u=[];++d<t;)l&&l[d].run();d=-1,t=u.length}l=null,h=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function m(){}s.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new p(e,t)),1!==u.length||h||c(_)},p.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=m,s.addListener=m,s.once=m,s.off=m,s.removeListener=m,s.removeAllListeners=m,s.emit=m,s.prependListener=m,s.prependOnceListener=m,s.listeners=function(e){return[]},s.binding=function(e){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},{}],27:[function(e,t,n){(function(n,r){"use strict";var i=e("safe-buffer").Buffer,s=r.crypto||r.msCrypto;s&&s.getRandomValues?t.exports=function(e,t){if(e>65536)throw new Error("requested too many random bytes");var o=new r.Uint8Array(e);e>0&&s.getRandomValues(o);var a=i.from(o.buffer);return"function"==typeof t?n.nextTick(function(){t(null,a)}):a}:t.exports=function(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:26,"safe-buffer":29}],28:[function(e,t,n){(function(e){var n=[];function r(){this.list=[],this.map=new Map}function i(){this.records=new Map,this.size=0}function s(e){if(!(this instanceof s))return new s(e);if(e||(e={}),this.maxSize=e.maxSize||1/0,this.maxAge=e.maxAge||0,this._fresh=new i,this._stale=new i,this._interval=null,this.maxAge&&this.maxAge<1/0){var t=Math.ceil(2/3*this.maxAge);this._interval=setInterval(this._gc.bind(this),t),this._interval.unref&&this._interval.unref()}}function o(t){return e.isBuffer(t)?t.toString("hex"):t}function a(e,t,n){var r=e[t];r.index=n,e[n].index=t,e[t]=e[n],e[n]=r}t.exports=s,r.prototype.add=function(e,t){var n=o(e),r=this.map.get(e);return!r&&(r={index:this.list.length,record:t||e},this.list.push(r),this.map.set(n,r),!0)},r.prototype.remove=function(e){var t=o(e),n=this.map.get(e);return!!n&&(a(this.list,n.index,this.list.length-1),this.list.pop(),this.map.delete(t),!0)},i.prototype.add=function(e,t,n){var i=this.records.get(e);return i||(i=new r,this.records.set(e,i)),!!i.add(t,n)&&(this.size++,!0)},i.prototype.remove=function(e,t,n){var r=this.records.get(e);return!!r&&!!r.remove(t,n)&&(this.size--,r.map.size||this.records.delete(e),!0)},i.prototype.get=function(e){var t=this.records.get(e);return t?t.list:n},Object.defineProperty(s.prototype,"size",{get:function(){return this._fresh.size+this._stale.size}}),s.prototype.add=function(e,t,n){this._stale.remove(e,t,n),this._fresh.add(e,t,n)&&this._fresh.size>this.maxSize&&this._gc()},s.prototype.remove=function(e,t,n){this._fresh.remove(e,t,n),this._stale.remove(e,t,n)},s.prototype.get=function(e,t){var n=this._fresh.get(e),r=this._stale.get(e),i=n.length,s=r.length,o=i+s;(t>o||!t)&&(t=o);for(var c=new Array(t),l=0;l<t;l++){var u=Math.floor(Math.random()*(i+s));u<i?(c[l]=n[u].record,a(n,u,--i)):(u-=i,c[l]=r[u].record,a(r,u,--s))}return c},s.prototype._gc=function(){this._stale=this._fresh,this._fresh=new i},s.prototype.clear=function(){this._gc(),this._gc()},s.prototype.destroy=function(){this.clear(),clearInterval(this._interval),this._interval=null}}).call(this,{isBuffer:e("../is-buffer/index.js")})},{"../is-buffer/index.js":17}],29:[function(e,t,n){var r=e("buffer"),i=r.Buffer;function s(e,t){for(var n in e)t[n]=e[n]}function o(e,t,n){return i(e,t,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=r:(s(r,n),n.Buffer=o),s(i,o),o.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,n)},o.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=i(e);return void 0!==t?"string"==typeof n?r.fill(t,n):r.fill(t):r.fill(0),r},o.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},{buffer:10}],30:[function(e,t,n){arguments[4][16][0].apply(n,arguments)},{dup:16}],31:[function(e,t,n){t.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],32:[function(e,t,n){(function(t,r){var i=/%[sdj%]/g;n.format=function(e){if(!g(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(a(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,s=r.length,o=String(e).replace(i,function(e){if("%%"===e)return"%";if(n>=s)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}}),c=r[n];n<s;c=r[++n])p(c)||!v(c)?o+=" "+c:o+=" "+a(c);return o},n.deprecate=function(e,i){if(y(r.process))return function(){return n.deprecate(e,i).apply(this,arguments)};if(!0===t.noDeprecation)return e;var s=!1;return function(){if(!s){if(t.throwDeprecation)throw new Error(i);t.traceDeprecation?console.trace(i):console.error(i),s=!0}return e.apply(this,arguments)}};var s,o={};function a(e,t){var r={seen:[],stylize:l};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),_(t)?r.showHidden=t:t&&n._extend(r,t),y(r.showHidden)&&(r.showHidden=!1),y(r.depth)&&(r.depth=2),y(r.colors)&&(r.colors=!1),y(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=c),u(r,e,r.depth)}function c(e,t){var n=a.styles[t];return n?"["+a.colors[n][0]+"m"+e+"["+a.colors[n][1]+"m":e}function l(e,t){return e}function u(e,t,r){if(e.customInspect&&t&&k(t.inspect)&&t.inspect!==n.inspect&&(!t.constructor||t.constructor.prototype!==t)){var i=t.inspect(r,e);return g(i)||(i=u(e,i,r)),i}var s=function(e,t){if(y(t))return e.stylize("undefined","undefined");if(g(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return m(t)?e.stylize(""+t,"number"):_(t)?e.stylize(""+t,"boolean"):p(t)?e.stylize("null","null"):void 0}(e,t);if(s)return s;var o=Object.keys(t),a=function(e){var t={};return o.forEach(function(e,n){t[e]=!0}),t}();if(e.showHidden&&(o=Object.getOwnPropertyNames(t)),E(t)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return h(t);if(0===o.length){if(k(t)){var c=t.name?": "+t.name:"";return e.stylize("[Function"+c+"]","special")}if(b(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(w(t))return e.stylize(Date.prototype.toString.call(t),"date");if(E(t))return h(t)}var l,v="",x=!1,A=["{","}"];return f(t)&&(x=!0,A=["[","]"]),k(t)&&(v=" [Function"+(t.name?": "+t.name:"")+"]"),b(t)&&(v=" "+RegExp.prototype.toString.call(t)),w(t)&&(v=" "+Date.prototype.toUTCString.call(t)),E(t)&&(v=" "+h(t)),0!==o.length||x&&0!=t.length?r<0?b(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),l=x?function(e,t,n,r,i){for(var s=[],o=0,a=t.length;o<a;++o)P(t,String(o))?s.push(d(e,t,n,r,String(o),!0)):s.push("");return i.forEach(function(i){i.match(/^\d+$/)||s.push(d(e,t,n,r,i,!0))}),s}(e,t,r,a,o):o.map(function(n){return d(e,t,r,a,n,x)}),e.seen.pop(),function(e,t,n){return e.reduce(function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}(l,v,A)):A[0]+v+A[1]}function h(e){return"["+Error.prototype.toString.call(e)+"]"}function d(e,t,n,r,i,s){var o,a,c;if((c=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?a=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(a=e.stylize("[Setter]","special")),P(r,i)||(o="["+i+"]"),a||(e.seen.indexOf(c.value)<0?(a=p(n)?u(e,c.value,null):u(e,c.value,n-1)).indexOf("\n")>-1&&(a=s?a.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+a.split("\n").map(function(e){return"   "+e}).join("\n")):a=e.stylize("[Circular]","special")),y(o)){if(s&&i.match(/^\d+$/))return a;(o=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=e.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=e.stylize(o,"string"))}return o+": "+a}function f(e){return Array.isArray(e)}function _(e){return"boolean"==typeof e}function p(e){return null===e}function m(e){return"number"==typeof e}function g(e){return"string"==typeof e}function y(e){return void 0===e}function b(e){return v(e)&&"[object RegExp]"===x(e)}function v(e){return"object"==typeof e&&null!==e}function w(e){return v(e)&&"[object Date]"===x(e)}function E(e){return v(e)&&("[object Error]"===x(e)||e instanceof Error)}function k(e){return"function"==typeof e}function x(e){return Object.prototype.toString.call(e)}function A(e){return e<10?"0"+e.toString(10):e.toString(10)}n.debuglog=function(e){if(y(s)&&(s=t.env.NODE_DEBUG||""),e=e.toUpperCase(),!o[e])if(new RegExp("\\b"+e+"\\b","i").test(s)){var r=t.pid;o[e]=function(){var t=n.format.apply(n,arguments);console.error("%s %d: %s",e,r,t)}}else o[e]=function(){};return o[e]},n.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=f,n.isBoolean=_,n.isNull=p,n.isNullOrUndefined=function(e){return null==e},n.isNumber=m,n.isString=g,n.isSymbol=function(e){return"symbol"==typeof e},n.isUndefined=y,n.isRegExp=b,n.isObject=v,n.isDate=w,n.isError=E,n.isFunction=k,n.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},n.isBuffer=e("./support/isBuffer");var S=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function P(e,t){return Object.prototype.hasOwnProperty.call(e,t)}n.log=function(){var e,t;console.log("%s - %s",(t=[A((e=new Date).getHours()),A(e.getMinutes()),A(e.getSeconds())].join(":"),[e.getDate(),S[e.getMonth()],t].join(" ")),n.format.apply(n,arguments))},n.inherits=e("inherits"),n._extend=function(e,t){if(!t||!v(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":31,_process:26,inherits:30}],33:[function(e,t,n){(function(n){(function(){var r,i,s,o,a,c,l=[].slice;function u(e,t){var n;return{id:e.slice(0,t),host:(n=h(e.slice(t,t+6))).host,port:n.port}}function h(e){return{host:e[0]+"."+e[1]+"."+e[2]+"."+e[3],port:e.readUInt16BE(4)}}function d(e,t){var r;return e=n.from(e.split(".").map(function(e){return parseInt(e,10)})),(r=n.alloc(2)).writeUInt16BE(t),t=r,n.concat([e,t])}function f(e){var t=this;if(null==e&&(e={}),!(this instanceof f))return new f(e);if(!(e=Object.assign({},e)).k)throw new Error("k-rpc-socket-webrtc requires options.k to be specified explicitly");if(this._k=Math.max(2,Math.floor(Math.log2(e.k))),!e.id)throw new Error("k-rpc-socket-webrtc requires options.id to be specified explicitly");n.isBuffer(e.id)?this.id=e.id:this.id=n.from(e.id,"hex"),e.socket=e.socket||o(e),e.socket.on("update_http_request_peer",function(e,n,r){var i,s,o,a;for(i=0,o=(s=t._reqs).length;i<o;++i)(a=s[i])&&a.peer.host===e&&a.peer.port===n&&(a.peer=r)}),e.isIP=function(){return!0},this._id_length=e.id.length,this._info_length=this._id_length+6,this._extensions=e.extensions||[],s.call(this,e)}r=e("debug")("webtorrent-dht"),i=e("inherits"),s=e("k-rpc-socket"),o=e("./webrtc-socket"),t.exports=f,i(a=function(){},s),i(f,a),(c=f.prototype).send=function(e,t,n){r("send to peer: %o",arguments),s.prototype.send.call(this,e,t,n)},c.response=function(e,t,n,i){var o,a,c=this;switch(r("response: %o",arguments),n=Object.assign({},n),t.q.toString()){case"find_node":case"get_peers":case"get":if(o=t.a.signals,!Array.isArray(o))return;if(n.nodes)n.nodes.length/this._info_length>o.length&&(n.nodes=n.nodes.slice(0,o.length*this._info_length)),a=function(e,t){var n,r,i,s,o;for(n=[],r=0,s=e.length,i=t+6;i<0?r>s:r<s;r+=i)o=r,n.push(u(e.slice(o,o+t+6),t));return n.filter(Boolean)}(n.nodes,this._id_length);else{if(!n.values){s.prototype.response.call(this,e,t,n,i);break}n.values.length>o.length&&(n.values=n.values(0,o.length)),a=n.values.map(h)}Promise.all(function(){var e,t,n,r=[];for(e=0,n=(t=a).length;e<n;++e)r.push(i.call(this,e,t[e]));return r;function i(e,t){var n=this;return new Promise(function(r){var i,s;i=o[e],s={q:"peer_connection",a:{id:n.id,signal:i}},n.query(t,s,function(e,t){r({error:e,response:t})})})}}.call(this)).then(function(r){var o,l,u,h,d;for(o=[],l=0,u=a.length;l<u;++l)r[h=l].error?o.push(null):o.push((null!=(d=r[h].response.r)?d.signal:void 0)||null);n.signals=o,s.prototype.response.call(c,e,t,n,i)});break;default:s.prototype.response.call(this,e,t,n,i)}},c.query=function(e,t,i){var o=this;switch(r("query: %o",arguments),(t=Object.assign({},t)).q.toString()){case"find_node":case"get_peers":case"get":Promise.all(function(){var e,t,n=[];for(e=0,t=this._k;e<t;++e)n.push(new Promise(r));return n;function r(e){var t,n;(t=n=o.socket._prepare_connection(!0)).once("signal",function(t){t.id=o.id,t.extensions=o._extensions,e({peer_connection:n,signal:t})}),t.once("error",function(t){e(null)})}}.call(this)).then(function(r){var a,c,u,h,f;for(r=r.filter(Boolean),a=[],c=[],u=0,h=r.length;u<h;++u)f=r[u],a.push(f.peer_connection),c.push(f.signal);t.a.signals=c,s.prototype.query.call(o,e,t,function(e,r){var s,c,u,h,f;for(c=[],u=2,h=arguments.length;u<h;++u)c.push(arguments[u]);s=c,!e&&Array.isArray(r.r.signals)?(f=t.a.id.toString("hex"),Promise.all(function(){var e,t,i,s=[];for(e=0,i=(t=r.r.signals).length;e<i;++e)s.push(o.call(this,e,t[e]));return s;function o(e,t){var i,s,o,c=this;return t?(i=t.id.toString("hex"))===f?null:(s=this.socket.get_id_mapping(i),o=function(t){return r.r.nodes?(i=r.r.nodes.slice(e*c._info_length,e*c._info_length+c._id_length),s=t.remoteAddress,o=t.remotePort,i=n.from(i),a=d(s,o),n.concat([i,a])):r.r.values?d(t.remoteAddress,t.remotePort):null;var i,s,o,a},s?(a[e].destroy(),o(s)):r.r.nodes||r.r.values?new Promise(function(n){var r,s;(r=a[e]).destroyed?n(null):((s=r).once("connect",function(){c.socket._add_id_mapping(i,r),r.destroyed||n(o(r))}),s.once("close",function(){var e;e=c.socket.get_id_mapping(i),n(e?o(e):null)}),s.signal(t))}):null):null}}.call(o)).then(function(t){t=t.filter(Boolean),r.r.nodes?r.r.nodes=n.concat(t,t.length*o._info_length):r.r.values&&(r.r.values=t),i.apply(null,[e,r].concat(l.call(s)))})):i.apply(null,[e,r].concat(l.call(s)))})});break;default:s.prototype.query.call(this,e,t,i)}},c.emit=function(e){var t,n,r,i,o,a,c,l,u,h,d,f,_,p,m,g=this;for(n=[],r=1,i=arguments.length;r<i;++r)n.push(arguments[r]);switch(t=n,e){case"query":switch(o=t[0],a=t[1],null!=(c=o.a)&&c.id&&this.socket._add_id_mapping(o.a.id.toString("hex"),a),null!=(l=o.q)&&"function"==typeof l.toString&&l.toString()){case"peer_connection":return void(null!=(u=o.a)&&u.signal&&(h=o.a.signal,(d=h.id.toString("hex"))===this.id.toString("hex")||this.socket.get_id_mapping(d)?this.response(a,o,{id:this.id,signal:{id:this.id}}):(f=!1,(_=p=this.socket._prepare_connection(!1)).once("connect",function(){g.socket._add_id_mapping(d,p)}),_.once("signal",function(e){f||(f=!0,e.id=g.id,e.extensions=g._extensions,g.response(a,o,{id:g.id,signal:e}))}),_.once("error",function(e){f||(f=!0,g.error(a,o,[201,e]))}),_.signal(h))))}break;case"response":o=t[0],a=t[1],null!=(m=o.r)&&m.id&&this.socket._add_id_mapping(o.r.id.toString("hex"),a)}return s.prototype.emit.apply(this,arguments)}}).call(this)}).call(this,e("buffer").Buffer)},{"./webrtc-socket":35,buffer:10,debug:12,inherits:16,"k-rpc-socket":20}],34:[function(e,t,n){(function(n){(function(){var r,i,s,o,a,c,l;function u(e){var t=this;if(null==e&&(e={}),!(this instanceof u))return new u(e);(e=Object.assign({},e)).id=e.id||e.nodeId||o(e.idLength||20),e.k=e.k||a,e.krpcSocket=e.krpcSocket||s(e),e.bootstrap=e.nodes||e.bootstrap||l,i.call(this,e),this.socket.socket.on("node_disconnected",function(e){t.nodes.remove(n.from(e,"hex"))}),this.nodes.on("added",function(e){t.socket.socket.add_tag(e.id.toString("hex"),"k-rpc-webrtc")}),this.nodes.on("removed",function(e){t.socket.socket.del_tag(e.id.toString("hex"),"k-rpc-webrtc")})}r=e("inherits"),i=e("k-rpc"),s=e("./k-rpc-socket-webrtc"),o=e("randombytes"),t.exports=u,a=2,l=[{host:"127.0.0.1",port:16881}],r(c=function(){},i),r(u,c)}).call(this)}).call(this,e("buffer").Buffer)},{"./k-rpc-socket-webrtc":33,buffer:10,inherits:16,"k-rpc":21,randombytes:27}],35:[function(e,t,n){(function(n){(function(){var r,i,s,o,a,c,l,u,h,d,f,_=[].slice,p=Array.from||function(e){return _.call(e)};function m(e){if(null==e&&(e={}),!(this instanceof m))return new m(e);this._peer_connection_timeout=1e3*(e.peer_connection_timeout||h),this._simple_peer_opts=Object.assign({},d,e.simple_peer_opts),this._simple_peer_constructor=e.simple_peer_constructor||l,this._http_address=e.http_address,this._extensions=e.extensions||[],this._peer_connections={},this._all_peer_connections=new Set,this._http_connections_aliases={},this._pending_peer_connections={},this._connections_id_mapping={},s.call(this)}r=e("bencode"),i=e("debug")("webtorrent-dht"),s=e("events").EventEmitter,o=e("http"),a=e("inherits"),e("isipaddress").test,c=e("node-fetch"),l=e("simple-peer"),u=e("wrtc"),t.exports=m,h=30,d={trickle:!1,wrtc:u},a(m,s),(f=m.prototype).address=function(){if(this.http_server)return this._http_address;throw new Error("HTTP server is not running yet")},f.bind=function(e,t,n){var r,s=this;if(!e||!t||e instanceof Function||t instanceof Function)throw"Both address and port are required for listen call";this.http_server=o.createServer(function(e,t){var n;if("POST"!==e.method)return t.writeHead(400),void t.end();n="",e.on("data",function(e){n+=e}).on("end",function(){var e;(e=s._prepare_connection(!1)).once("signal",function(e){i("got signal for HTTP (server): %s",e),e.extensions=s._extensions,e=JSON.stringify(e),t.finished||(t.setHeader("Access-Control-Allow-Origin","*"),t.write(e),t.end())}),e.once("connect",function(){t.finished||(t.writeHead(500),t.end())}),e.once("close",function(){t.finished||(t.writeHead(500),t.end())}),e.signal(JSON.parse(n))}).setEncoding("utf8")}),(r=this.http_server).listen(e,t,function(){i("listening for HTTP connections on %s:%d",t,e),s._http_address||(s._http_address={address:t,port:e}),s.emit("listening"),"function"==typeof n&&n()}),r.on("error",function(e){s.emit("error",e)})},f.close=function(){this._all_peer_connections.forEach(function(e){e.destroy()}),this.http_server&&this.http_server.close()},f.send=function(e,t,n,r,s,o){var a,l=this;this._peer_connections[s+":"+r]?(this._peer_connections[s+":"+r].send(e),o()):this._http_connections_aliases[s+":"+r]?(a=this._http_connections_aliases[s+":"+r],this.emit("update_http_request_peer",s,r,{host:a.remoteAddress,port:a.remotePort}),a.send(e),o()):this._pending_peer_connections[s+":"+r]?this._pending_peer_connections[s+":"+r].then(function(i){l.send(e,t,n,r,s,o)}).catch(function(){}):(this._pending_peer_connections[s+":"+r]=new Promise(function(a,u){var h,d,f;(h=d=l._prepare_connection(!0)).once("signal",function(e){var t;i("got signal for HTTP (client): %s",e),e.extensions=l._extensions,t={method:"POST",body:JSON.stringify(e)},c("https://"+s+":"+r,t).catch(function(e){if("http:"===location.protocol)return c("http://"+s+":"+r,t);throw e}).then(function(e){return e.json()}).then(function(e){d.destroyed?u():d.signal(e)}).catch(function(e){u(),l.emit("error",e)})}),h.once("connect",function(){var i;i={address:d.remoteAddress,port:d.remotePort},l._register_http_connection_alias(i.address,i.port,s,r),d.destroyed?u():(l.send(e,t,n,r,s,o),delete l._pending_peer_connections[s+":"+r],a(i))}),h.once("close",function(){clearTimeout(f)}),f=setTimeout(function(){delete l._pending_peer_connections[s+":"+r],d.connected||u()},l._peer_connection_timeout)}),this._pending_peer_connections[s+":"+r].catch(function(){}))},f._prepare_connection=function(e){var t,s,o,a=this;return i("prepare connection, initiator: %s",e),(t=s=this._simple_peer_constructor(Object.assign({},this._simple_peer_opts,{initiator:e}))).once("connect",function(){var e,t;i("peer connected: %s:%d",s.remoteAddress,s.remotePort),a._register_connection(s),a.http_server&&(e=a.address(),t=JSON.stringify({http_server:{host:e.address,port:e.port}}),a.send(n.from(t),0,t.length,s.remotePort,s.remoteAddress,function(){})),s.once("close",function(){i("peer disconnected: %s:%d",s.remoteAddress,s.remotePort)})}),t.on("data",function(e){var t;if(i.enabled&&i("got data: %o, %s",e,e.toString()),e instanceof Uint8Array&&(e=n.from(e)),!s._http_info_checked){s._http_info_checked=!0;try{if((t=JSON.parse(e)).http_server)return void(s.http_server={host:t.http_server.host.toString(),port:t.http_server.port})}catch(e){}}t=r.decode(e),n.isBuffer(e)&&(s.connected?a.emit("message",e,{address:s.remoteAddress,port:s.remotePort}):s.once("connected",function(){a.emit("message",e,{address:s.remoteAddress,port:s.remotePort})}))}),t.on("error",function(){i("peer error: %o",arguments),a.emit.apply(a,["error"].concat(p(arguments)))}),t.once("close",function(){clearTimeout(o),a._all_peer_connections.delete(s)}),t.setMaxListeners(0),t.signal=function(e){e.sdp=String(e.sdp),e.type=String(e.type),e.extensions&&(e.extensions=e.extensions.map(function(e){return e+""}),e.extensions.length&&a.emit("extensions_received",s,e.extensions)),a._simple_peer_constructor.prototype.signal.call(s,e)},t._tags=new Set,this._all_peer_connections.add(s),o=setTimeout(function(){s.connected&&s._tags.size||s.destroy()},this._peer_connection_timeout),s},f._add_id_mapping=function(e,t){var n,r,s=this;if(!(t instanceof this._simple_peer_constructor)){if(n=t.host||t.address,r=t.port,!this._peer_connections[n+":"+r])return void i("bad peer specified for id mapping: %s => %o",e,{ip:n,port:r});t=this._peer_connections[n+":"+r]}this._connections_id_mapping[e]?this._connections_id_mapping[e]!==t&&t.destroy():(this._connections_id_mapping[e]=t,t.id=e,t.once("close",function(){s._del_id_mapping(e)}),this.emit("node_connected",e))},f._del_id_mapping=function(e){var t;this._connections_id_mapping[e]&&((t=this._connections_id_mapping[e])._tags.size&&!t.destroyed||(delete this._connections_id_mapping[e],t.destroyed||t.destroy(),this.emit("node_disconnected",e)))},f.get_id_mapping=function(e){return this._connections_id_mapping[e]},f.add_tag=function(e,t){var n;(n=this.get_id_mapping(e))&&n._tags.add(t)},f.del_tag=function(e,t){this._connections_id_mapping[e]&&(this._connections_id_mapping[e]._tags.delete(t),this._del_id_mapping(e))},f.known_http_servers=function(){var e;return function(){var t,n=[];for(e in t=this._peer_connections)e=t[e],n.push(e.http_server);return n}.call(this).filter(Boolean)},f._register_connection=function(e){var t,n,r=this;t=e.remoteAddress,n=e.remotePort,this._peer_connections[t+":"+n]=e,e.once("close",function(){delete r._peer_connections[t+":"+n]})},f._register_http_connection_alias=function(e,t,n,r){var i,s=this;i=this._peer_connections[e+":"+t],this._http_connections_aliases[n+":"+r]=i,i.once("close",function(){delete s._http_connections_aliases[n+":"+r]}),this.emit("http_peer_connection_alias",n,r,i)}}).call(this)}).call(this,e("buffer").Buffer)},{bencode:3,buffer:10,debug:12,events:14,http:7,inherits:16,isipaddress:18,"node-fetch":25,"simple-peer":8,wrtc:37}],36:[function(e,t,n){(function(n){(function(){var r,i,s,o,a;function c(e){if(null==e&&(e={}),!(this instanceof c))return new c(e);(e=Object.assign({},e)).hash&&(e.idLength=e.hash(n.from("")).length),e.krpc=e.krpc||s(e),r.call(this,e)}r=e("bittorrent-dht"),i=e("inherits"),s=e("./k-rpc-webrtc"),t.exports=c,i(o=function(){},r),i(c,o),(a=c.prototype).listen=function(e,t,n){null==e&&(e=16881),null==t&&(t="127.0.0.1"),this._rpc.bind(e,t,n)},a.toJSON=function(){return{nodes:this._rpc.socket.socket.known_http_servers(),values:r.prototype.toJSON.call(this).values}}}).call(this)}).call(this,e("buffer").Buffer)},{"./k-rpc-webrtc":34,"bittorrent-dht":5,buffer:10,inherits:16}],37:[function(e,t,n){"use strict";n.RTCIceCandidate=window.RTCIceCandidate,n.RTCPeerConnection=window.RTCPeerConnection,n.RTCSessionDescription=window.RTCSessionDescription},{}],38:[function(e,t,n){(function(){var n,r,i;n=e("bencode"),r=e("webtorrent-dht/webrtc-socket"),i=e("webtorrent-dht"),t.exports={bencode:n,"webrtc-socket":r,"webtorrent-dht":i}}).call(this)},{bencode:3,"webtorrent-dht":36,"webtorrent-dht/webrtc-socket":35}]},{},[38])(38)}),"function"==typeof define&&define.amd?define("@detox/base-x",[],function(){return k}):"object"==typeof exports?module.exports=k:this.base_x=k,function(){function e(e,t){var n=p(4);return n=new Uint32Array(n.buffer)[0],Math.floor(n/Math.pow(2,32)*(t-e+1))+e}function t(t){var n=t.length;return 1===n?t.pop():(n=e(0,n-1),t.splice(n,1)[0])}function n(e){var t,n="",r=0;for(t=e.length;r<t;++r){n+=e[r].toString(16).padStart(2,"0")}return n}function r(e){var t,n=new Uint8Array(e.length/2),r=0;for(t=n.length;r<t;++r){var i=r;n[i]=parseInt(e.substring(2*i,2*i+2),16)}return n}function i(e,t){var n;if(e===t)return!0;if(e.length!==t.length)return!1;var r=0;for(n=e.length;r<n;++r){var i=r;if(e[r]!==t[i])return!1}return!0}function s(e){var t,n=e.reduce(function(e,t){return e+t.length},0),r=0;n=new Uint8Array(n);var i=0;for(t=e.length;i<t;++i){var s=e[i];n.set(s,r),r+=s.length}return n}function o(e,t){return setTimeout(t,1e3*e)}function a(e,t){return setInterval(t,1e3*e)}function c(e){if(e instanceof Error)return console.error(e)}function l(e){var t;return(t=y.get(e))&&v.has(t)?t:(t=e.join(","),b.has(t)?(t=b.get(t),y.set(e,t),t):e)}function u(e){var t,n=e.join(",");(t=v.get(e))?(++t,v.set(e,t)):(y.set(e,e),b.set(n,e),v.set(e,1))}function h(e){var t=e.join(","),n=v.get(e);--n?v.set(e,n):(b.delete(t),v.delete(e))}function d(e){var t,n,r=t=new Map;if(r.get=function(e){return e=l(e),Map.prototype.get.call(this,e)},r.has=function(e){return e=l(e),Map.prototype.has.call(this,e)},r.set=function(e,t){return e=l(e),Map.prototype.has.call(this,e)||u(e),Map.prototype.set.call(this,e,t)},r.delete=function(e){return e=l(e),Map.prototype.has.call(this,e)&&h(e),Map.prototype.delete.call(this,e)},r.clear=function(){var e=this;this.forEach(function(t,n){e.delete(n)})},e)for(r=0,n=e.length;r<n;++r){var i=e[r],s=i[0];i=i[1],t.set(s,i)}return t}function f(e){var t,n,r=t=new Set;if(r.has=function(e){return e=l(e),Set.prototype.has.call(this,e)},r.add=function(e){return e=l(e),Set.prototype.has.call(this,e)||u(e),Set.prototype.add.call(this,e)},r.delete=function(e){return e=l(e),Set.prototype.has.call(this,e)&&h(e),Set.prototype.delete.call(this,e)},r.clear=function(){var e=this;this.forEach(function(t,n){e.delete(n)})},e)for(r=0,n=e.length;r<n;++r){var i=e[r];t.add(i)}return t}function _(l){return l=l("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),{random_bytes:p,random_int:e,pull_random_item_from_array:t,array2hex:n,hex2array:r,string2array:m,array2string:g,are_arrays_equal:i,concat_arrays:s,timeoutSet:o,intervalSet:a,error_handler:c,ArrayMap:d,ArraySet:f,base58_encode:l.encode,base58_decode:l.decode}}var p;if(p="undefined"!=typeof crypto?function(e){return e=new Uint8Array(e),crypto.getRandomValues(e),e}:require("crypto").randomBytes,"undefined"!=typeof Buffer)var m=function(e){return Buffer.from(e)},g=function(e){return Buffer.from(e).toString()};else(function(e,t){m=function(t){return e.encode(t)},g=function(e){return t.decode(e)}}).call(this,new TextEncoder,new TextDecoder);var y=new WeakMap,b=new Map,v=new Map;"function"==typeof define&&define.amd?define("@detox/utils",["@detox/base-x"],_):"object"==typeof exports?module.exports=_(require("@detox/base-x")):this.detox_utils=_(this.base_x)}.call(this),function(){function e(){if(!(this instanceof e))return new e;t.set(this,{})}var t=new WeakMap;e.prototype={on:function(e,n){var r;return e&&n&&((r=t.get(this))[e]||(r[e]=[])).push(n),this},off:function(e,n){return(e=t.get(this)[e])&&e.splice(e.indexOf(n),n?1:e.length),this},once:function(e,t){var n=this;if(e&&t){var r=function(){if(!r.a)return r.a=!0,n.off(e,r),t.apply(null,arguments)};this.on(e,r)}return this},fire:function(e,n){var r=Promise.resolve(),i=arguments;return(t.get(this)[e]||[]).forEach(function(e){r=r.then(function(){var t=e.call.apply(e,i);return!1===t?Promise.reject():t})}),r.catch(function(e){e instanceof Error&&console.error(e)}),r}},"function"==typeof define&&define.amd?define("async-eventer",[],function(){return e}):"object"==typeof exports?module.exports=e:this.async_eventer=e}.call(this),function(){function e(e){var t=new Uint8Array(2);return new DataView(t.buffer).setUint16(0,e,!1),t}function t(e){var t=e[0],n=e.subarray(1,3);return n=new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,!1),[t,e.slice(3,3+n)]}function n(e,t,n){return(e=new Uint8Array(e)).set(t),e.set(n,2),e}function r(t,n,r){return(r=new Uint8Array(3+r)).set([t]),r.set(e(n.length),1),r.set(n,3),r}function i(e,t){return e.join(",")+t.join(",")}function s(e){if(e instanceof Error)return console.error(e)}function o(o){function d(e,t,n,r){if(null==r&&(r=10),!(this instanceof d))return new d(e,t,n,r);o.call(this),this.l=e,this.v=t,this.u=n,this.N=r,this.b=new Map,this.g=new Set,this.f=new Map,this.m=new Map,this.o=new Map,this.a=new Map}return d.prototype={X:function(e,t){if(t.length===this.l){var n=[t.subarray(0,2),t.subarray(2)];t=n[0],n=n[1],this.c("activity",e,t);var r=i(e,t);this.b.has(r)||this.g.has(r)||this.a.has(r)?this.O(e,t,n):this.P(e,t,n)}},U:function(e,t){this.b.set(i(e,t),[e]),this.h(e,t)},T:function(e,t){this.g.add(i(e,t)),this.h(e,t)},S:function(e,t){e=i(e,t),t=this.o.get(e),this.b.get(e).push(t),this.o.delete(e)},H:function(e,t){if(t.length>this.i())throw new RangeError("Too much command data");var n=this.M(e);return t=this.D(n,a,t),this.j(e,n,t),this.s(e,n),n},V:function(e,t,n){if(n.length>this.i())throw new RangeError("Too much command data");n=this.D(t,c,n),this.j(e,t,n)},W:function(e,t,n,r){var o,a=this,c=i(e,t);if(!this.b.has(c))throw new ReferenceError("There is no such segment established");if(r.length>this.i()-this.v)throw new RangeError("Too much command data");var u=this.b.get(c).slice(-1)[0],h=o=new Uint8Array(n.length+r.length);h.set(n),h.set(r,n.length),this.A(e,t,u,l,o).then(function(r){a.j(e,t,r),a.o.set(c,n)}).catch(s)},C:function(e,t,n){var r=this;this.A(e,t,e,u,n).then(function(n){r.j(e,t,n)}).catch(s)},I:function(e,t){var n=i(e,t);if(this.b.delete(n),this.g.delete(n),this.o.delete(n),this.h(e,t),this.a.has(n)){var r=this.a.get(n);n=r[0],r=r[1],this.B(e,t),this.I(n,r)}else this.B(e,t)},data:function(e,t,n,r,o){var a=this,c=i(e,t);if(!this.b.has(c)&&!this.g.has(c))throw new ReferenceError("There is no such segment established");if(o.length>this.i())throw new RangeError("Too much command data");this.A(e,t,n,r+h,o).then(function(n){a.j(e,t,n)}).catch(s)},i:function(){return this.l-2-1-2-this.u},j:function(e,t,n){return this.c("activity",e,t),this.c("send",e,n)},P:function(e,n,r){var s=i(e,n),o=(r=t(r))[0];switch(r=r[1],o){case a:this.s(e,n),this.c("create_request",e,n,r);break;case c:this.f.has(s)&&((s=(s=this.f.get(s)).Z)?(e=s[0],n=s[1],this.C(e,n,r)):this.c("create_response",e,n,r))}},O:function(e,n,r){var o=this;this.R(e,n,r).then(function(r){var s=i(e,n);!o.g.has(s)&&o.a.has(s)?o.w(s,r):o.K(e,n,r).then(function(r){var i=t(r.plaintext),a=i[0];switch(i=i[1],a){case l:try{var c=i.subarray(0,o.v),d=i.subarray(o.v),f=o.H(c,d),_=[e,n],p=[c,f];o.s(e,n,{Y:p}),o.s(c,f,{Z:_})}catch(t){if(!((r=t)instanceof RangeError))throw r;o.C(e,n,new Uint8Array(0))}break;case u:o.o.has(s)&&o.c("extend_response",e,n,i);break;default:a<h||o.c("data",e,n,r.target_address,a-h,i)}},function(){var t;if(o.a.has(s))o.w(s,r);else if(o.f.has(s)){var i=o.f.get(s);(t=i.Y)&&(i=t[0],t=t[1],o.h(e,n),o.h(i,t),o.J(e,n,i,t)&&o.w(s,r))}})}).catch(s)},w:function(e,t){var r=this.a.get(e);e=r[0],r=r[1],t=n(this.l,r,t),this.j(e,r,t)},M:function(t){var n,r=0;for(n=Math.pow(2,16);r<n;++r){var s=r,o=i(t,s=e(s));if(!(this.b.has(o)||this.f.has(o)||this.g.has(o)||this.a.has(o)))return s}throw new RangeError("Out of possible segment IDs")},D:function(e,t,i){return t=r(t,i,this.i()),n(this.l,e,t)},A:function(e,t,i,s,o){var a=this;return s=r(s,o,this.i()),this.L(e,t,i,s).then(function(e){return n(a.l,t,e)})},J:function(e,t,n,r){var s=i(e,t),o=i(n,r);return!this.a.has(s)&&!this.a.has(o)&&(this.a.set(s,[n,r]),this.a.set(o,[e,t]),!0)},B:function(e,t){if(e=i(e,t),this.a.has(e)){var n=this.a.get(e);t=i(t=n[0],n=n[1]),this.a.delete(e),this.a.delete(t)}},s:function(e,t,n){null==n&&(n={}),this.h(e,t);var r=i(e,t),s=e.join("");this.f.set(r,n),this.m.has(s)||this.m.set(s,[]),(n=this.m.get(s)).push(t),n.length>this.N&&(t=n.shift(),this.h(e,t))},h:function(e,t){var n,r=i(e,t);if(this.f.has(r)){this.f.delete(r),e=e.join(""),t=t.join("");var s=0;for(n=(r=this.m.get(e)).length;s<n;++s){var o=s;if(r[s].join("")===t)return void r.splice(o,1)}r.length||this.m.delete(e)}},L:function(e,t,n,r){var s,o=this,a=i(e,t),c={address:e,segment_id:t,target_address:n,plaintext:r,ciphertext:null},l=this.c("encrypt",c).then(function(){var e=c.ciphertext;if(!(e instanceof Uint8Array)||e.length!==r.length+o.u)throw"Encryption failed";return e});return s=this.b.has(a)?this.b.get(a):[n],(s=function(e){var t,n,r=[],i=0;for(n=(t=s).length;i<n;++i){var o=t[i];if(r.push(o),e===o.join(","))break}return r}.call(this,n.join(","))).reverse().forEach(function(n){return l=l.then(function(r){return o.G(e,t,n,r)})}),l},K:function(e,t,n){var r,s=this,o=i(e,t);r=this.b.has(o)?this.b.get(o):[e];var a=Promise.reject(),c={address:e,segment_id:t,target_address:null,ciphertext:n,plaintext:null};return r.forEach(function(r,i){a=a.catch(function(){return c.target_address=r,0<i?s.F(e,t,r,c.ciphertext).then(function(e){return c.ciphertext=e,s.c("decrypt",c)}):s.c("decrypt",c)}).then(function(){var e=c.plaintext;if(!(e instanceof Uint8Array)||e.length!==n.length-s.u)throw"Decryption failed";return c})}),a},R:function(e,t,n){var r=i(e,t);return this.b.has(r)||this.g.has(r)?this.F(e,t,e,n):(t=(e=this.a.get(r))[0],this.G(t,e[1],t,n))},G:function(e,t,n,r){var i={address:e,segment_id:t,target_address:n,unwrapped:r,wrapped:null};return this.c("wrap",i).then(function(){var e=i.wrapped;if(!(e instanceof Uint8Array)||e.length!==r.length)throw"Wrapping failed";return e})},F:function(e,t,n,r){var i={address:e,segment_id:t,target_address:n,wrapped:r,unwrapped:null};return this.c("unwrap",i).then(function(){var e=i.unwrapped;if(!(e instanceof Uint8Array)||e.length!==r.length)throw"Unwrapping failed";return e})}},d.prototype=Object.assign(Object.create(o.prototype),d.prototype),d.prototype.c=d.prototype.fire,d.prototype.process_packet=d.prototype.X,d.prototype.confirm_outgoing_segment_established=d.prototype.U,d.prototype.confirm_incoming_segment_established=d.prototype.T,d.prototype.confirm_extended_path=d.prototype.S,d.prototype.create_request=d.prototype.H,d.prototype.create_response=d.prototype.V,d.prototype.extend_request=d.prototype.W,d.prototype.destroy=d.prototype.I,d.prototype.data=d.prototype.data,d.prototype.get_max_command_data_length=d.prototype.i,Object.defineProperty(d.prototype,"constructor",{value:d}),d}var a=0,c=1,l=2,u=3,h=10;"function"==typeof define&&define.amd?define("ronion",["async-eventer"],o):"object"==typeof exports?module.exports=o(require("async-eventer")):this.ronion=o(this.async_eventer)}.call(this),function(){function e(e){var t,n=0,r=1;for(t=e.length-1;0<=t;--t){n+=e[t]*r,r*=Math.pow(2,8)}return n}function t(e,t,n){for(e.j=t,e.f=n,e.b=1;t>=Math.pow(2,8);)++e.b,t/=Math.pow(2,8);e.a=new Uint8Array(0)}function n(){function n(e,r){if(!(this instanceof n))return new n(e,r);t(this,e,r),this.c=!0}function r(e,n){if(!(this instanceof r))return new r(e,n);t(this,e,n),this.c=[]}return n.prototype={feed:function(e){var t,n=t=new Uint8Array(this.a.length+this.b+e.length);n.set(this.a),n.set(function(e,t){var n=new Uint8Array(t);for(--t;0<=t;--t){var r=t,i=e%Math.pow(2,8);e=(e-i)/Math.pow(2,8),n.set([i],r)}return n}(e.length,this.b),this.a.length),n.set(e,this.b+this.a.length),this.a=t,this.c=!1},have_more_blocks:function(){return!this.c},get_block:function(){var e,t=new Uint8Array(this.f);if(this.have_more_blocks()){if(this.f>this.a.length){var n=Math.ceil((this.f-this.a.length)/this.b);(n=e=new Uint8Array(this.a.length+n*this.b)).set(this.a),this.a=e,this.c=!0}t.set(this.a.subarray(0,this.f)),this.a=this.a.subarray(this.f)}return t}},Object.defineProperty(n.prototype,"constructor",{value:n}),r.prototype={feed:function(e){this.have_more_data()?this.c.push(e):this.g(e)},g:function(e){var t,n=t=new Uint8Array(this.a.length+e.length);n.set(this.a),n.set(e,this.a.length),this.a=t},have_more_data:function(){return this.i(),this.h()},h:function(){for(var t;;){if(this.a.length<=this.b)return!1;if(t=e(this.a.subarray(0,this.b)))break;this.a=this.a.subarray(this.b)}return this.a.length>=this.b+t},get_data:function(){if(!this.have_more_data())return null;var t=e(this.a.subarray(0,this.b)),n=this.a.subarray(this.b,this.b+t);return this.a=this.a.subarray(this.b+t),n},i:function(){for(;!this.h()&&this.c.length;)e(this.a.subarray(0,this.b))||(this.a=new Uint8Array(0)),this.g(this.c.shift())}},Object.defineProperty(r.prototype,"constructor",{value:r}),{Multiplexer:n,Demultiplexer:r}}"function"==typeof define&&define.amd?define("fixed-size-multiplexer",n):"object"==typeof exports?module.exports=n():this.fixed_size_multiplexer=n()}.call(this),function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define("pako",[],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).pako=e()}(function(){return function e(t,n,r){function i(o,a){if(!n[o]){if(!t[o]){var c="function"==typeof require&&require;if(!a&&c)return c(o,!0);if(s)return s(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[o]={exports:{}};t[o][0].call(u.exports,function(e){return i(t[o][1][e]||e)},u,u.exports,e,t,n,r)}return n[o].exports}for(var s="function"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,t,n){"use strict";function r(e){if(!(this instanceof r))return new r(e);this.options=o.assign({level:d,method:_,chunkSize:16384,windowBits:15,memLevel:8,strategy:f,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var n=s.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==h)throw new Error(c[n]);if(t.header&&s.deflateSetHeader(this.strm,t.header),t.dictionary){var i;if(i="string"==typeof t.dictionary?a.string2buf(t.dictionary):"[object ArrayBuffer]"===u.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(n=s.deflateSetDictionary(this.strm,i))!==h)throw new Error(c[n]);this._dict_set=!0}}function i(e,t){var n=new r(t);if(n.push(e,!0),n.err)throw n.msg||c[n.err];return n.result}var s=e("./zlib/deflate"),o=e("./utils/common"),a=e("./utils/strings"),c=e("./zlib/messages"),l=e("./zlib/zstream"),u=Object.prototype.toString,h=0,d=-1,f=0,_=8;r.prototype.push=function(e,t){var n,r,i=this.strm,c=this.options.chunkSize;if(this.ended)return!1;r=t===~~t?t:!0===t?4:0,"string"==typeof e?i.input=a.string2buf(e):"[object ArrayBuffer]"===u.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;do{if(0===i.avail_out&&(i.output=new o.Buf8(c),i.next_out=0,i.avail_out=c),1!==(n=s.deflate(i,r))&&n!==h)return this.onEnd(n),this.ended=!0,!1;0!==i.avail_out&&(0!==i.avail_in||4!==r&&2!==r)||("string"===this.options.to?this.onData(a.buf2binstring(o.shrinkBuf(i.output,i.next_out))):this.onData(o.shrinkBuf(i.output,i.next_out)))}while((i.avail_in>0||0===i.avail_out)&&1!==n);return 4===r?(n=s.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===h):2!==r||(this.onEnd(h),i.avail_out=0,!0)},r.prototype.onData=function(e){this.chunks.push(e)},r.prototype.onEnd=function(e){e===h&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Deflate=r,n.deflate=i,n.deflateRaw=function(e,t){return(t=t||{}).raw=!0,i(e,t)},n.gzip=function(e,t){return(t=t||{}).gzip=!0,i(e,t)}},{"./utils/common":3,"./utils/strings":4,"./zlib/deflate":8,"./zlib/messages":13,"./zlib/zstream":15}],2:[function(e,t,n){"use strict";function r(e){if(!(this instanceof r))return new r(e);this.options=o.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var n=s.inflateInit2(this.strm,t.windowBits);if(n!==c.Z_OK)throw new Error(l[n]);this.header=new h,s.inflateGetHeader(this.strm,this.header)}function i(e,t){var n=new r(t);if(n.push(e,!0),n.err)throw n.msg||l[n.err];return n.result}var s=e("./zlib/inflate"),o=e("./utils/common"),a=e("./utils/strings"),c=e("./zlib/constants"),l=e("./zlib/messages"),u=e("./zlib/zstream"),h=e("./zlib/gzheader"),d=Object.prototype.toString;r.prototype.push=function(e,t){var n,r,i,l,u,h,f=this.strm,_=this.options.chunkSize,p=this.options.dictionary,m=!1;if(this.ended)return!1;r=t===~~t?t:!0===t?c.Z_FINISH:c.Z_NO_FLUSH,"string"==typeof e?f.input=a.binstring2buf(e):"[object ArrayBuffer]"===d.call(e)?f.input=new Uint8Array(e):f.input=e,f.next_in=0,f.avail_in=f.input.length;do{if(0===f.avail_out&&(f.output=new o.Buf8(_),f.next_out=0,f.avail_out=_),(n=s.inflate(f,c.Z_NO_FLUSH))===c.Z_NEED_DICT&&p&&(h="string"==typeof p?a.string2buf(p):"[object ArrayBuffer]"===d.call(p)?new Uint8Array(p):p,n=s.inflateSetDictionary(this.strm,h)),n===c.Z_BUF_ERROR&&!0===m&&(n=c.Z_OK,m=!1),n!==c.Z_STREAM_END&&n!==c.Z_OK)return this.onEnd(n),this.ended=!0,!1;f.next_out&&(0!==f.avail_out&&n!==c.Z_STREAM_END&&(0!==f.avail_in||r!==c.Z_FINISH&&r!==c.Z_SYNC_FLUSH)||("string"===this.options.to?(i=a.utf8border(f.output,f.next_out),l=f.next_out-i,u=a.buf2string(f.output,i),f.next_out=l,f.avail_out=_-l,l&&o.arraySet(f.output,f.output,i,l,0),this.onData(u)):this.onData(o.shrinkBuf(f.output,f.next_out)))),0===f.avail_in&&0===f.avail_out&&(m=!0)}while((f.avail_in>0||0===f.avail_out)&&n!==c.Z_STREAM_END);return n===c.Z_STREAM_END&&(r=c.Z_FINISH),r===c.Z_FINISH?(n=s.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===c.Z_OK):r!==c.Z_SYNC_FLUSH||(this.onEnd(c.Z_OK),f.avail_out=0,!0)},r.prototype.onData=function(e){this.chunks.push(e)},r.prototype.onEnd=function(e){e===c.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Inflate=r,n.inflate=i,n.inflateRaw=function(e,t){return(t=t||{}).raw=!0,i(e,t)},n.ungzip=i},{"./utils/common":3,"./utils/strings":4,"./zlib/constants":6,"./zlib/gzheader":9,"./zlib/inflate":11,"./zlib/messages":13,"./zlib/zstream":15}],3:[function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;n.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var i in n)r(n,i)&&(e[i]=n[i])}}return e},n.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var s={arraySet:function(e,t,n,r,i){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+r),i);else for(var s=0;s<r;s++)e[i+s]=t[n+s]},flattenChunks:function(e){var t,n,r,i,s,o;for(r=0,t=0,n=e.length;t<n;t++)r+=e[t].length;for(o=new Uint8Array(r),i=0,t=0,n=e.length;t<n;t++)s=e[t],o.set(s,i),i+=s.length;return o}},o={arraySet:function(e,t,n,r,i){for(var s=0;s<r;s++)e[i+s]=t[n+s]},flattenChunks:function(e){return[].concat.apply([],e)}};n.setTyped=function(e){e?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,s)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,o))},n.setTyped(i)},{}],4:[function(e,t,n){"use strict";function r(e,t){if(t<65537&&(e.subarray&&o||!e.subarray&&s))return String.fromCharCode.apply(null,i.shrinkBuf(e,t));for(var n="",r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n}var i=e("./common"),s=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(e){s=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){o=!1}for(var a=new i.Buf8(256),c=0;c<256;c++)a[c]=c>=252?6:c>=248?5:c>=240?4:c>=224?3:c>=192?2:1;a[254]=a[254]=1,n.string2buf=function(e){var t,n,r,s,o,a=e.length,c=0;for(s=0;s<a;s++)55296==(64512&(n=e.charCodeAt(s)))&&s+1<a&&56320==(64512&(r=e.charCodeAt(s+1)))&&(n=65536+(n-55296<<10)+(r-56320),s++),c+=n<128?1:n<2048?2:n<65536?3:4;for(t=new i.Buf8(c),o=0,s=0;o<c;s++)55296==(64512&(n=e.charCodeAt(s)))&&s+1<a&&56320==(64512&(r=e.charCodeAt(s+1)))&&(n=65536+(n-55296<<10)+(r-56320),s++),n<128?t[o++]=n:n<2048?(t[o++]=192|n>>>6,t[o++]=128|63&n):n<65536?(t[o++]=224|n>>>12,t[o++]=128|n>>>6&63,t[o++]=128|63&n):(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63,t[o++]=128|n>>>6&63,t[o++]=128|63&n);return t},n.buf2binstring=function(e){return r(e,e.length)},n.binstring2buf=function(e){for(var t=new i.Buf8(e.length),n=0,r=t.length;n<r;n++)t[n]=e.charCodeAt(n);return t},n.buf2string=function(e,t){var n,i,s,o,c=t||e.length,l=new Array(2*c);for(i=0,n=0;n<c;)if((s=e[n++])<128)l[i++]=s;else if((o=a[s])>4)l[i++]=65533,n+=o-1;else{for(s&=2===o?31:3===o?15:7;o>1&&n<c;)s=s<<6|63&e[n++],o--;o>1?l[i++]=65533:s<65536?l[i++]=s:(s-=65536,l[i++]=55296|s>>10&1023,l[i++]=56320|1023&s)}return r(l,i)},n.utf8border=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;n>=0&&128==(192&e[n]);)n--;return n<0?t:0===n?t:n+a[e[n]]>t?n:t}},{"./common":3}],5:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){for(var i=65535&e|0,s=e>>>16&65535|0,o=0;0!==n;){n-=o=n>2e3?2e3:n;do{s=s+(i=i+t[r++]|0)|0}while(--o);i%=65521,s%=65521}return i|s<<16|0}},{}],6:[function(e,t,n){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],7:[function(e,t,n){"use strict";var r=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t,n,i){var s=r,o=i+n;e^=-1;for(var a=i;a<o;a++)e=e>>>8^s[255&(e^t[a])];return-1^e}},{}],8:[function(e,t,n){"use strict";function r(e,t){return e.msg=P[t],t}function i(e){return(e<<1)-(e>4?9:0)}function s(e){for(var t=e.length;--t>=0;)e[t]=0}function o(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(k.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function a(e,t){x._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,o(e.strm)}function c(e,t){e.pending_buf[e.pending++]=t}function l(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function u(e,t,n,r){var i=e.avail_in;return i>r&&(i=r),0===i?0:(e.avail_in-=i,k.arraySet(t,e.input,e.next_in,i,n),1===e.state.wrap?e.adler=A(e.adler,t,i,n):2===e.state.wrap&&(e.adler=S(e.adler,t,i,n)),e.next_in+=i,e.total_in+=i,i)}function h(e,t){var n,r,i=e.max_chain_length,s=e.strstart,o=e.prev_length,a=e.nice_match,c=e.strstart>e.w_size-V?e.strstart-(e.w_size-V):0,l=e.window,u=e.w_mask,h=e.prev,d=e.strstart+W,f=l[s+o-1],_=l[s+o];e.prev_length>=e.good_match&&(i>>=2),a>e.lookahead&&(a=e.lookahead);do{if(l[(n=t)+o]===_&&l[n+o-1]===f&&l[n]===l[s]&&l[++n]===l[s+1]){s+=2,n++;do{}while(l[++s]===l[++n]&&l[++s]===l[++n]&&l[++s]===l[++n]&&l[++s]===l[++n]&&l[++s]===l[++n]&&l[++s]===l[++n]&&l[++s]===l[++n]&&l[++s]===l[++n]&&s<d);if(r=W-(d-s),s=d-W,r>o){if(e.match_start=t,o=r,r>=a)break;f=l[s+o-1],_=l[s+o]}}}while((t=h[t&u])>c&&0!=--i);return o<=e.lookahead?o:e.lookahead}function d(e){var t,n,r,i,s,o=e.w_size;do{if(i=e.window_size-e.lookahead-e.strstart,e.strstart>=o+(o-V)){k.arraySet(e.window,e.window,o,o,0),e.match_start-=o,e.strstart-=o,e.block_start-=o,t=n=e.hash_size;do{r=e.head[--t],e.head[t]=r>=o?r-o:0}while(--n);t=n=o;do{r=e.prev[--t],e.prev[t]=r>=o?r-o:0}while(--n);i+=o}if(0===e.strm.avail_in)break;if(n=u(e.strm,e.window,e.strstart+e.lookahead,i),e.lookahead+=n,e.lookahead+e.insert>=H)for(s=e.strstart-e.insert,e.ins_h=e.window[s],e.ins_h=(e.ins_h<<e.hash_shift^e.window[s+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[s+H-1])&e.hash_mask,e.prev[s&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=s,s++,e.insert--,!(e.lookahead+e.insert<H)););}while(e.lookahead<V&&0!==e.strm.avail_in)}function f(e,t){for(var n,r;;){if(e.lookahead<V){if(d(e),e.lookahead<V&&t===T)return $;if(0===e.lookahead)break}if(n=0,e.lookahead>=H&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+H-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-V&&(e.match_length=h(e,n)),e.match_length>=H)if(r=x._tr_tally(e,e.strstart-e.match_start,e.match_length-H),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=H){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+H-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else r=x._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(a(e,!1),0===e.strm.avail_out))return $}return e.insert=e.strstart<H-1?e.strstart:H-1,t===C?(a(e,!0),0===e.strm.avail_out?K:Z):e.last_lit&&(a(e,!1),0===e.strm.avail_out)?$:X}function _(e,t){for(var n,r,i;;){if(e.lookahead<V){if(d(e),e.lookahead<V&&t===T)return $;if(0===e.lookahead)break}if(n=0,e.lookahead>=H&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+H-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=H-1,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-V&&(e.match_length=h(e,n),e.match_length<=5&&(e.strategy===I||e.match_length===H&&e.strstart-e.match_start>4096)&&(e.match_length=H-1)),e.prev_length>=H&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-H,r=x._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-H),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+H-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=H-1,e.strstart++,r&&(a(e,!1),0===e.strm.avail_out))return $}else if(e.match_available){if((r=x._tr_tally(e,0,e.window[e.strstart-1]))&&a(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return $}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=x._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<H-1?e.strstart:H-1,t===C?(a(e,!0),0===e.strm.avail_out?K:Z):e.last_lit&&(a(e,!1),0===e.strm.avail_out)?$:X}function p(e,t){for(var n,r,i,s,o=e.window;;){if(e.lookahead<=W){if(d(e),e.lookahead<=W&&t===T)return $;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=H&&e.strstart>0&&((r=o[i=e.strstart-1])===o[++i]&&r===o[++i]&&r===o[++i])){s=e.strstart+W;do{}while(r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&i<s);e.match_length=W-(s-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=H?(n=x._tr_tally(e,1,e.match_length-H),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=x._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(a(e,!1),0===e.strm.avail_out))return $}return e.insert=0,t===C?(a(e,!0),0===e.strm.avail_out?K:Z):e.last_lit&&(a(e,!1),0===e.strm.avail_out)?$:X}function m(e,t){for(var n;;){if(0===e.lookahead&&(d(e),0===e.lookahead)){if(t===T)return $;break}if(e.match_length=0,n=x._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(a(e,!1),0===e.strm.avail_out))return $}return e.insert=0,t===C?(a(e,!0),0===e.strm.avail_out?K:Z):e.last_lit&&(a(e,!1),0===e.strm.avail_out)?$:X}function g(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i}function y(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=D,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new k.Buf16(2*F),this.dyn_dtree=new k.Buf16(2*(2*U+1)),this.bl_tree=new k.Buf16(2*(2*q+1)),s(this.dyn_ltree),s(this.dyn_dtree),s(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new k.Buf16(j+1),this.heap=new k.Buf16(2*z+1),s(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new k.Buf16(2*z+1),s(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function b(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=L,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?G:Y,e.adler=2===t.wrap?0:1,t.last_flush=T,x._tr_init(t),O):r(e,N)}function v(e){var t=b(e);return t===O&&function(e){e.window_size=2*e.w_size,s(e.head),e.max_lazy_match=E[e.level].max_lazy,e.good_match=E[e.level].good_length,e.nice_match=E[e.level].nice_length,e.max_chain_length=E[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=H-1,e.match_available=0,e.ins_h=0}(e.state),t}function w(e,t,n,i,s,o){if(!e)return N;var a=1;if(t===R&&(t=6),i<0?(a=0,i=-i):i>15&&(a=2,i-=16),s<1||s>B||n!==D||i<8||i>15||t<0||t>9||o<0||o>M)return r(e,N);8===i&&(i=9);var c=new y;return e.state=c,c.strm=e,c.wrap=a,c.gzhead=null,c.w_bits=i,c.w_size=1<<c.w_bits,c.w_mask=c.w_size-1,c.hash_bits=s+7,c.hash_size=1<<c.hash_bits,c.hash_mask=c.hash_size-1,c.hash_shift=~~((c.hash_bits+H-1)/H),c.window=new k.Buf8(2*c.w_size),c.head=new k.Buf16(c.hash_size),c.prev=new k.Buf16(c.w_size),c.lit_bufsize=1<<s+6,c.pending_buf_size=4*c.lit_bufsize,c.pending_buf=new k.Buf8(c.pending_buf_size),c.d_buf=1*c.lit_bufsize,c.l_buf=3*c.lit_bufsize,c.level=t,c.strategy=o,c.method=n,v(e)}var E,k=e("../utils/common"),x=e("./trees"),A=e("./adler32"),S=e("./crc32"),P=e("./messages"),T=0,C=4,O=0,N=-2,R=-1,I=1,M=4,L=2,D=8,B=9,z=286,U=30,q=19,F=2*z+1,j=15,H=3,W=258,V=W+H+1,G=42,Y=113,$=1,X=2,K=3,Z=4;E=[new g(0,0,0,0,function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(d(e),0===e.lookahead&&t===T)return $;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var r=e.block_start+n;if((0===e.strstart||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,a(e,!1),0===e.strm.avail_out))return $;if(e.strstart-e.block_start>=e.w_size-V&&(a(e,!1),0===e.strm.avail_out))return $}return e.insert=0,t===C?(a(e,!0),0===e.strm.avail_out?K:Z):(e.strstart>e.block_start&&(a(e,!1),e.strm.avail_out),$)}),new g(4,4,8,4,f),new g(4,5,16,8,f),new g(4,6,32,32,f),new g(4,4,16,16,_),new g(8,16,32,32,_),new g(8,16,128,128,_),new g(8,32,128,256,_),new g(32,128,258,1024,_),new g(32,258,258,4096,_)],n.deflateInit=function(e,t){return w(e,t,D,15,8,0)},n.deflateInit2=w,n.deflateReset=v,n.deflateResetKeep=b,n.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?N:(e.state.gzhead=t,O):N},n.deflate=function(e,t){var n,a,u,h;if(!e||!e.state||t>5||t<0)return e?r(e,N):N;if(a=e.state,!e.output||!e.input&&0!==e.avail_in||666===a.status&&t!==C)return r(e,0===e.avail_out?-5:N);if(a.strm=e,n=a.last_flush,a.last_flush=t,a.status===G)if(2===a.wrap)e.adler=0,c(a,31),c(a,139),c(a,8),a.gzhead?(c(a,(a.gzhead.text?1:0)+(a.gzhead.hcrc?2:0)+(a.gzhead.extra?4:0)+(a.gzhead.name?8:0)+(a.gzhead.comment?16:0)),c(a,255&a.gzhead.time),c(a,a.gzhead.time>>8&255),c(a,a.gzhead.time>>16&255),c(a,a.gzhead.time>>24&255),c(a,9===a.level?2:a.strategy>=2||a.level<2?4:0),c(a,255&a.gzhead.os),a.gzhead.extra&&a.gzhead.extra.length&&(c(a,255&a.gzhead.extra.length),c(a,a.gzhead.extra.length>>8&255)),a.gzhead.hcrc&&(e.adler=S(e.adler,a.pending_buf,a.pending,0)),a.gzindex=0,a.status=69):(c(a,0),c(a,0),c(a,0),c(a,0),c(a,0),c(a,9===a.level?2:a.strategy>=2||a.level<2?4:0),c(a,3),a.status=Y);else{var d=D+(a.w_bits-8<<4)<<8;d|=(a.strategy>=2||a.level<2?0:a.level<6?1:6===a.level?2:3)<<6,0!==a.strstart&&(d|=32),d+=31-d%31,a.status=Y,l(a,d),0!==a.strstart&&(l(a,e.adler>>>16),l(a,65535&e.adler)),e.adler=1}if(69===a.status)if(a.gzhead.extra){for(u=a.pending;a.gzindex<(65535&a.gzhead.extra.length)&&(a.pending!==a.pending_buf_size||(a.gzhead.hcrc&&a.pending>u&&(e.adler=S(e.adler,a.pending_buf,a.pending-u,u)),o(e),u=a.pending,a.pending!==a.pending_buf_size));)c(a,255&a.gzhead.extra[a.gzindex]),a.gzindex++;a.gzhead.hcrc&&a.pending>u&&(e.adler=S(e.adler,a.pending_buf,a.pending-u,u)),a.gzindex===a.gzhead.extra.length&&(a.gzindex=0,a.status=73)}else a.status=73;if(73===a.status)if(a.gzhead.name){u=a.pending;do{if(a.pending===a.pending_buf_size&&(a.gzhead.hcrc&&a.pending>u&&(e.adler=S(e.adler,a.pending_buf,a.pending-u,u)),o(e),u=a.pending,a.pending===a.pending_buf_size)){h=1;break}h=a.gzindex<a.gzhead.name.length?255&a.gzhead.name.charCodeAt(a.gzindex++):0,c(a,h)}while(0!==h);a.gzhead.hcrc&&a.pending>u&&(e.adler=S(e.adler,a.pending_buf,a.pending-u,u)),0===h&&(a.gzindex=0,a.status=91)}else a.status=91;if(91===a.status)if(a.gzhead.comment){u=a.pending;do{if(a.pending===a.pending_buf_size&&(a.gzhead.hcrc&&a.pending>u&&(e.adler=S(e.adler,a.pending_buf,a.pending-u,u)),o(e),u=a.pending,a.pending===a.pending_buf_size)){h=1;break}h=a.gzindex<a.gzhead.comment.length?255&a.gzhead.comment.charCodeAt(a.gzindex++):0,c(a,h)}while(0!==h);a.gzhead.hcrc&&a.pending>u&&(e.adler=S(e.adler,a.pending_buf,a.pending-u,u)),0===h&&(a.status=103)}else a.status=103;if(103===a.status&&(a.gzhead.hcrc?(a.pending+2>a.pending_buf_size&&o(e),a.pending+2<=a.pending_buf_size&&(c(a,255&e.adler),c(a,e.adler>>8&255),e.adler=0,a.status=Y)):a.status=Y),0!==a.pending){if(o(e),0===e.avail_out)return a.last_flush=-1,O}else if(0===e.avail_in&&i(t)<=i(n)&&t!==C)return r(e,-5);if(666===a.status&&0!==e.avail_in)return r(e,-5);if(0!==e.avail_in||0!==a.lookahead||t!==T&&666!==a.status){var f=2===a.strategy?m(a,t):3===a.strategy?p(a,t):E[a.level].func(a,t);if(f!==K&&f!==Z||(a.status=666),f===$||f===K)return 0===e.avail_out&&(a.last_flush=-1),O;if(f===X&&(1===t?x._tr_align(a):5!==t&&(x._tr_stored_block(a,0,0,!1),3===t&&(s(a.head),0===a.lookahead&&(a.strstart=0,a.block_start=0,a.insert=0))),o(e),0===e.avail_out))return a.last_flush=-1,O}return t!==C?O:a.wrap<=0?1:(2===a.wrap?(c(a,255&e.adler),c(a,e.adler>>8&255),c(a,e.adler>>16&255),c(a,e.adler>>24&255),c(a,255&e.total_in),c(a,e.total_in>>8&255),c(a,e.total_in>>16&255),c(a,e.total_in>>24&255)):(l(a,e.adler>>>16),l(a,65535&e.adler)),o(e),a.wrap>0&&(a.wrap=-a.wrap),0!==a.pending?O:1)},n.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==G&&69!==t&&73!==t&&91!==t&&103!==t&&t!==Y&&666!==t?r(e,N):(e.state=null,t===Y?r(e,-3):O):N},n.deflateSetDictionary=function(e,t){var n,r,i,o,a,c,l,u,h=t.length;if(!e||!e.state)return N;if(2===(o=(n=e.state).wrap)||1===o&&n.status!==G||n.lookahead)return N;for(1===o&&(e.adler=A(e.adler,t,h,0)),n.wrap=0,h>=n.w_size&&(0===o&&(s(n.head),n.strstart=0,n.block_start=0,n.insert=0),u=new k.Buf8(n.w_size),k.arraySet(u,t,h-n.w_size,n.w_size,0),t=u,h=n.w_size),a=e.avail_in,c=e.next_in,l=e.input,e.avail_in=h,e.next_in=0,e.input=t,d(n);n.lookahead>=H;){r=n.strstart,i=n.lookahead-(H-1);do{n.ins_h=(n.ins_h<<n.hash_shift^n.window[r+H-1])&n.hash_mask,n.prev[r&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=r,r++}while(--i);n.strstart=r,n.lookahead=H-1,d(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=H-1,n.match_available=0,e.next_in=c,e.input=l,e.avail_in=a,n.wrap=o,O},n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":3,"./adler32":5,"./crc32":7,"./messages":13,"./trees":14}],9:[function(e,t,n){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],10:[function(e,t,n){"use strict";t.exports=function(e,t){var n,r,i,s,o,a,c,l,u,h,d,f,_,p,m,g,y,b,v,w,E,k,x,A,S;n=e.state,r=e.next_in,A=e.input,i=r+(e.avail_in-5),s=e.next_out,S=e.output,o=s-(t-e.avail_out),a=s+(e.avail_out-257),c=n.dmax,l=n.wsize,u=n.whave,h=n.wnext,d=n.window,f=n.hold,_=n.bits,p=n.lencode,m=n.distcode,g=(1<<n.lenbits)-1,y=(1<<n.distbits)-1;e:do{_<15&&(f+=A[r++]<<_,_+=8,f+=A[r++]<<_,_+=8),b=p[f&g];t:for(;;){if(f>>>=v=b>>>24,_-=v,0==(v=b>>>16&255))S[s++]=65535&b;else{if(!(16&v)){if(0==(64&v)){b=p[(65535&b)+(f&(1<<v)-1)];continue t}if(32&v){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}w=65535&b,(v&=15)&&(_<v&&(f+=A[r++]<<_,_+=8),w+=f&(1<<v)-1,f>>>=v,_-=v),_<15&&(f+=A[r++]<<_,_+=8,f+=A[r++]<<_,_+=8),b=m[f&y];n:for(;;){if(f>>>=v=b>>>24,_-=v,!(16&(v=b>>>16&255))){if(0==(64&v)){b=m[(65535&b)+(f&(1<<v)-1)];continue n}e.msg="invalid distance code",n.mode=30;break e}if(E=65535&b,_<(v&=15)&&(f+=A[r++]<<_,(_+=8)<v&&(f+=A[r++]<<_,_+=8)),(E+=f&(1<<v)-1)>c){e.msg="invalid distance too far back",n.mode=30;break e}if(f>>>=v,_-=v,E>(v=s-o)){if((v=E-v)>u&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(k=0,x=d,0===h){if(k+=l-v,v<w){w-=v;do{S[s++]=d[k++]}while(--v);k=s-E,x=S}}else if(h<v){if(k+=l+h-v,(v-=h)<w){w-=v;do{S[s++]=d[k++]}while(--v);if(k=0,h<w){w-=v=h;do{S[s++]=d[k++]}while(--v);k=s-E,x=S}}}else if(k+=h-v,v<w){w-=v;do{S[s++]=d[k++]}while(--v);k=s-E,x=S}for(;w>2;)S[s++]=x[k++],S[s++]=x[k++],S[s++]=x[k++],w-=3;w&&(S[s++]=x[k++],w>1&&(S[s++]=x[k++]))}else{k=s-E;do{S[s++]=S[k++],S[s++]=S[k++],S[s++]=S[k++],w-=3}while(w>2);w&&(S[s++]=S[k++],w>1&&(S[s++]=S[k++]))}break}}break}}while(r<i&&s<a);r-=w=_>>3,f&=(1<<(_-=w<<3))-1,e.next_in=r,e.next_out=s,e.avail_in=r<i?i-r+5:5-(r-i),e.avail_out=s<a?a-s+257:257-(s-a),n.hold=f,n.bits=_}},{}],11:[function(e,t,n){"use strict";function r(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function i(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=w,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new d.Buf32(k),t.distcode=t.distdyn=new d.Buf32(x),t.sane=1,t.back=-1,b):v}function s(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,i(e)):v}function o(e,t){var n,r;return e&&e.state?(r=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?v:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,s(e))):v}function a(e,t){var n,r;return e?(r=new function(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new d.Buf16(320),this.work=new d.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0},e.state=r,r.window=null,(n=o(e,t))!==b&&(e.state=null),n):v}function c(e){if(A){var t;for(u=new d.Buf32(512),h=new d.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(m(g,e.lens,0,288,u,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;m(y,e.lens,0,32,h,0,e.work,{bits:5}),A=!1}e.lencode=u,e.lenbits=9,e.distcode=h,e.distbits=5}function l(e,t,n,r){var i,s=e.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new d.Buf8(s.wsize)),r>=s.wsize?(d.arraySet(s.window,t,n-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):((i=s.wsize-s.wnext)>r&&(i=r),d.arraySet(s.window,t,n-r,i,s.wnext),(r-=i)?(d.arraySet(s.window,t,n-r,r,0),s.wnext=r,s.whave=s.wsize):(s.wnext+=i,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=i))),0}var u,h,d=e("../utils/common"),f=e("./adler32"),_=e("./crc32"),p=e("./inffast"),m=e("./inftrees"),g=1,y=2,b=0,v=-2,w=1,E=12,k=852,x=592,A=!0;n.inflateReset=s,n.inflateReset2=o,n.inflateResetKeep=i,n.inflateInit=function(e){return a(e,15)},n.inflateInit2=a,n.inflate=function(e,t){var n,i,s,o,a,u,h,k,x,A,S,P,T,C,O,N,R,I,M,L,D,B,z,U,q=0,F=new d.Buf8(4),j=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return v;(n=e.state).mode===E&&(n.mode=13),a=e.next_out,s=e.output,h=e.avail_out,o=e.next_in,i=e.input,u=e.avail_in,k=n.hold,x=n.bits,A=u,S=h,B=b;e:for(;;)switch(n.mode){case w:if(0===n.wrap){n.mode=13;break}for(;x<16;){if(0===u)break e;u--,k+=i[o++]<<x,x+=8}if(2&n.wrap&&35615===k){n.check=0,F[0]=255&k,F[1]=k>>>8&255,n.check=_(n.check,F,2,0),k=0,x=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&k)<<8)+(k>>8))%31){e.msg="incorrect header check",n.mode=30;break}if(8!=(15&k)){e.msg="unknown compression method",n.mode=30;break}if(x-=4,D=8+(15&(k>>>=4)),0===n.wbits)n.wbits=D;else if(D>n.wbits){e.msg="invalid window size",n.mode=30;break}n.dmax=1<<D,e.adler=n.check=1,n.mode=512&k?10:E,k=0,x=0;break;case 2:for(;x<16;){if(0===u)break e;u--,k+=i[o++]<<x,x+=8}if(n.flags=k,8!=(255&n.flags)){e.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=k>>8&1),512&n.flags&&(F[0]=255&k,F[1]=k>>>8&255,n.check=_(n.check,F,2,0)),k=0,x=0,n.mode=3;case 3:for(;x<32;){if(0===u)break e;u--,k+=i[o++]<<x,x+=8}n.head&&(n.head.time=k),512&n.flags&&(F[0]=255&k,F[1]=k>>>8&255,F[2]=k>>>16&255,F[3]=k>>>24&255,n.check=_(n.check,F,4,0)),k=0,x=0,n.mode=4;case 4:for(;x<16;){if(0===u)break e;u--,k+=i[o++]<<x,x+=8}n.head&&(n.head.xflags=255&k,n.head.os=k>>8),512&n.flags&&(F[0]=255&k,F[1]=k>>>8&255,n.check=_(n.check,F,2,0)),k=0,x=0,n.mode=5;case 5:if(1024&n.flags){for(;x<16;){if(0===u)break e;u--,k+=i[o++]<<x,x+=8}n.length=k,n.head&&(n.head.extra_len=k),512&n.flags&&(F[0]=255&k,F[1]=k>>>8&255,n.check=_(n.check,F,2,0)),k=0,x=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((P=n.length)>u&&(P=u),P&&(n.head&&(D=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),d.arraySet(n.head.extra,i,o,P,D)),512&n.flags&&(n.check=_(n.check,i,P,o)),u-=P,o+=P,n.length-=P),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===u)break e;P=0;do{D=i[o+P++],n.head&&D&&n.length<65536&&(n.head.name+=String.fromCharCode(D))}while(D&&P<u);if(512&n.flags&&(n.check=_(n.check,i,P,o)),u-=P,o+=P,D)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===u)break e;P=0;do{D=i[o+P++],n.head&&D&&n.length<65536&&(n.head.comment+=String.fromCharCode(D))}while(D&&P<u);if(512&n.flags&&(n.check=_(n.check,i,P,o)),u-=P,o+=P,D)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;x<16;){if(0===u)break e;u--,k+=i[o++]<<x,x+=8}if(k!==(65535&n.check)){e.msg="header crc mismatch",n.mode=30;break}k=0,x=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=E;break;case 10:for(;x<32;){if(0===u)break e;u--,k+=i[o++]<<x,x+=8}e.adler=n.check=r(k),k=0,x=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=a,e.avail_out=h,e.next_in=o,e.avail_in=u,n.hold=k,n.bits=x,2;e.adler=n.check=1,n.mode=E;case E:if(5===t||6===t)break e;case 13:if(n.last){k>>>=7&x,x-=7&x,n.mode=27;break}for(;x<3;){if(0===u)break e;u--,k+=i[o++]<<x,x+=8}switch(n.last=1&k,x-=1,3&(k>>>=1)){case 0:n.mode=14;break;case 1:if(c(n),n.mode=20,6===t){k>>>=2,x-=2;break e}break;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=30}k>>>=2,x-=2;break;case 14:for(k>>>=7&x,x-=7&x;x<32;){if(0===u)break e;u--,k+=i[o++]<<x,x+=8}if((65535&k)!=(k>>>16^65535)){e.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&k,k=0,x=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(P=n.length){if(P>u&&(P=u),P>h&&(P=h),0===P)break e;d.arraySet(s,i,o,P,a),u-=P,o+=P,h-=P,a+=P,n.length-=P;break}n.mode=E;break;case 17:for(;x<14;){if(0===u)break e;u--,k+=i[o++]<<x,x+=8}if(n.nlen=257+(31&k),k>>>=5,x-=5,n.ndist=1+(31&k),k>>>=5,x-=5,n.ncode=4+(15&k),k>>>=4,x-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;x<3;){if(0===u)break e;u--,k+=i[o++]<<x,x+=8}n.lens[j[n.have++]]=7&k,k>>>=3,x-=3}for(;n.have<19;)n.lens[j[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,z={bits:n.lenbits},B=m(0,n.lens,0,19,n.lencode,0,n.work,z),n.lenbits=z.bits,B){e.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;N=(q=n.lencode[k&(1<<n.lenbits)-1])>>>16&255,R=65535&q,!((O=q>>>24)<=x);){if(0===u)break e;u--,k+=i[o++]<<x,x+=8}if(R<16)k>>>=O,x-=O,n.lens[n.have++]=R;else{if(16===R){for(U=O+2;x<U;){if(0===u)break e;u--,k+=i[o++]<<x,x+=8}if(k>>>=O,x-=O,0===n.have){e.msg="invalid bit length repeat",n.mode=30;break}D=n.lens[n.have-1],P=3+(3&k),k>>>=2,x-=2}else if(17===R){for(U=O+3;x<U;){if(0===u)break e;u--,k+=i[o++]<<x,x+=8}x-=O,D=0,P=3+(7&(k>>>=O)),k>>>=3,x-=3}else{for(U=O+7;x<U;){if(0===u)break e;u--,k+=i[o++]<<x,x+=8}x-=O,D=0,P=11+(127&(k>>>=O)),k>>>=7,x-=7}if(n.have+P>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=30;break}for(;P--;)n.lens[n.have++]=D}}if(30===n.mode)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,z={bits:n.lenbits},B=m(g,n.lens,0,n.nlen,n.lencode,0,n.work,z),n.lenbits=z.bits,B){e.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,z={bits:n.distbits},B=m(y,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,z),n.distbits=z.bits,B){e.msg="invalid distances set",n.mode=30;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(u>=6&&h>=258){e.next_out=a,e.avail_out=h,e.next_in=o,e.avail_in=u,n.hold=k,n.bits=x,p(e,S),a=e.next_out,s=e.output,h=e.avail_out,o=e.next_in,i=e.input,u=e.avail_in,k=n.hold,x=n.bits,n.mode===E&&(n.back=-1);break}for(n.back=0;N=(q=n.lencode[k&(1<<n.lenbits)-1])>>>16&255,R=65535&q,!((O=q>>>24)<=x);){if(0===u)break e;u--,k+=i[o++]<<x,x+=8}if(N&&0==(240&N)){for(I=O,M=N,L=R;N=(q=n.lencode[L+((k&(1<<I+M)-1)>>I)])>>>16&255,R=65535&q,!(I+(O=q>>>24)<=x);){if(0===u)break e;u--,k+=i[o++]<<x,x+=8}k>>>=I,x-=I,n.back+=I}if(k>>>=O,x-=O,n.back+=O,n.length=R,0===N){n.mode=26;break}if(32&N){n.back=-1,n.mode=E;break}if(64&N){e.msg="invalid literal/length code",n.mode=30;break}n.extra=15&N,n.mode=22;case 22:if(n.extra){for(U=n.extra;x<U;){if(0===u)break e;u--,k+=i[o++]<<x,x+=8}n.length+=k&(1<<n.extra)-1,k>>>=n.extra,x-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;N=(q=n.distcode[k&(1<<n.distbits)-1])>>>16&255,R=65535&q,!((O=q>>>24)<=x);){if(0===u)break e;u--,k+=i[o++]<<x,x+=8}if(0==(240&N)){for(I=O,M=N,L=R;N=(q=n.distcode[L+((k&(1<<I+M)-1)>>I)])>>>16&255,R=65535&q,!(I+(O=q>>>24)<=x);){if(0===u)break e;u--,k+=i[o++]<<x,x+=8}k>>>=I,x-=I,n.back+=I}if(k>>>=O,x-=O,n.back+=O,64&N){e.msg="invalid distance code",n.mode=30;break}n.offset=R,n.extra=15&N,n.mode=24;case 24:if(n.extra){for(U=n.extra;x<U;){if(0===u)break e;u--,k+=i[o++]<<x,x+=8}n.offset+=k&(1<<n.extra)-1,k>>>=n.extra,x-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===h)break e;if(P=S-h,n.offset>P){if((P=n.offset-P)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=30;break}P>n.wnext?(P-=n.wnext,T=n.wsize-P):T=n.wnext-P,P>n.length&&(P=n.length),C=n.window}else C=s,T=a-n.offset,P=n.length;P>h&&(P=h),h-=P,n.length-=P;do{s[a++]=C[T++]}while(--P);0===n.length&&(n.mode=21);break;case 26:if(0===h)break e;s[a++]=n.length,h--,n.mode=21;break;case 27:if(n.wrap){for(;x<32;){if(0===u)break e;u--,k|=i[o++]<<x,x+=8}if(S-=h,e.total_out+=S,n.total+=S,S&&(e.adler=n.check=n.flags?_(n.check,s,S,a-S):f(n.check,s,S,a-S)),S=h,(n.flags?k:r(k))!==n.check){e.msg="incorrect data check",n.mode=30;break}k=0,x=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;x<32;){if(0===u)break e;u--,k+=i[o++]<<x,x+=8}if(k!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=30;break}k=0,x=0}n.mode=29;case 29:B=1;break e;case 30:B=-3;break e;case 31:return-4;case 32:default:return v}return e.next_out=a,e.avail_out=h,e.next_in=o,e.avail_in=u,n.hold=k,n.bits=x,(n.wsize||S!==e.avail_out&&n.mode<30&&(n.mode<27||4!==t))&&l(e,e.output,e.next_out,S-e.avail_out)?(n.mode=31,-4):(A-=e.avail_in,S-=e.avail_out,e.total_in+=A,e.total_out+=S,n.total+=S,n.wrap&&S&&(e.adler=n.check=n.flags?_(n.check,s,S,e.next_out-S):f(n.check,s,S,e.next_out-S)),e.data_type=n.bits+(n.last?64:0)+(n.mode===E?128:0)+(20===n.mode||15===n.mode?256:0),(0===A&&0===S||4===t)&&B===b&&(B=-5),B)},n.inflateEnd=function(e){if(!e||!e.state)return v;var t=e.state;return t.window&&(t.window=null),e.state=null,b},n.inflateGetHeader=function(e,t){var n;return e&&e.state?0==(2&(n=e.state).wrap)?v:(n.head=t,t.done=!1,b):v},n.inflateSetDictionary=function(e,t){var n,r=t.length;return e&&e.state?0!==(n=e.state).wrap&&11!==n.mode?v:11===n.mode&&f(1,t,r,0)!==n.check?-3:l(e,t,r,r)?(n.mode=31,-4):(n.havedict=1,b):v},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":3,"./adler32":5,"./crc32":7,"./inffast":10,"./inftrees":12}],12:[function(e,t,n){"use strict";var r=e("../utils/common"),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],a=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,n,c,l,u,h,d){var f,_,p,m,g,y,b,v,w,E=d.bits,k=0,x=0,A=0,S=0,P=0,T=0,C=0,O=0,N=0,R=0,I=null,M=0,L=new r.Buf16(16),D=new r.Buf16(16),B=null,z=0;for(k=0;k<=15;k++)L[k]=0;for(x=0;x<c;x++)L[t[n+x]]++;for(P=E,S=15;S>=1&&0===L[S];S--);if(P>S&&(P=S),0===S)return l[u++]=20971520,l[u++]=20971520,d.bits=1,0;for(A=1;A<S&&0===L[A];A++);for(P<A&&(P=A),O=1,k=1;k<=15;k++)if(O<<=1,(O-=L[k])<0)return-1;if(O>0&&(0===e||1!==S))return-1;for(D[1]=0,k=1;k<15;k++)D[k+1]=D[k]+L[k];for(x=0;x<c;x++)0!==t[n+x]&&(h[D[t[n+x]]++]=x);if(0===e?(I=B=h,y=19):1===e?(I=i,M-=257,B=s,z-=257,y=256):(I=o,B=a,y=-1),R=0,x=0,k=A,g=u,T=P,C=0,p=-1,m=(N=1<<P)-1,1===e&&N>852||2===e&&N>592)return 1;for(;;){b=k-C,h[x]<y?(v=0,w=h[x]):h[x]>y?(v=B[z+h[x]],w=I[M+h[x]]):(v=96,w=0),f=1<<k-C,A=_=1<<T;do{l[g+(R>>C)+(_-=f)]=b<<24|v<<16|w|0}while(0!==_);for(f=1<<k-1;R&f;)f>>=1;if(0!==f?(R&=f-1,R+=f):R=0,x++,0==--L[k]){if(k===S)break;k=t[n+h[x]]}if(k>P&&(R&m)!==p){for(0===C&&(C=P),g+=A,O=1<<(T=k-C);T+C<S&&!((O-=L[T+C])<=0);)T++,O<<=1;if(N+=1<<T,1===e&&N>852||2===e&&N>592)return 1;l[p=R&m]=P<<24|T<<16|g-u|0}}return 0!==R&&(l[g+R]=k-C<<24|64<<16|0),d.bits=P,0}},{"../utils/common":3}],13:[function(e,t,n){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],14:[function(e,t,n){"use strict";function r(e){for(var t=e.length;--t>=0;)e[t]=0}function i(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length}function s(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function o(e){return e<256?W[e]:W[256+(e>>>7)]}function a(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function c(e,t,n){e.bi_valid>R-n?(e.bi_buf|=t<<e.bi_valid&65535,a(e,e.bi_buf),e.bi_buf=t>>R-e.bi_valid,e.bi_valid+=n-R):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function l(e,t,n){c(e,n[2*t],n[2*t+1])}function u(e,t){var n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1}function h(e,t,n){var r,i,s=new Array(N+1),o=0;for(r=1;r<=N;r++)s[r]=o=o+n[r-1]<<1;for(i=0;i<=t;i++){var a=e[2*i+1];0!==a&&(e[2*i]=u(s[a]++,a))}}function d(e){var t;for(t=0;t<P;t++)e.dyn_ltree[2*t]=0;for(t=0;t<T;t++)e.dyn_dtree[2*t]=0;for(t=0;t<C;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*M]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function f(e){e.bi_valid>8?a(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function _(e,t,n,r){var i=2*t,s=2*n;return e[i]<e[s]||e[i]===e[s]&&r[t]<=r[n]}function p(e,t,n){for(var r=e.heap[n],i=n<<1;i<=e.heap_len&&(i<e.heap_len&&_(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!_(t,r,e.heap[i],e.depth));)e.heap[n]=e.heap[i],n=i,i<<=1;e.heap[n]=r}function m(e,t,n){var r,i,s,a,u=0;if(0!==e.last_lit)do{r=e.pending_buf[e.d_buf+2*u]<<8|e.pending_buf[e.d_buf+2*u+1],i=e.pending_buf[e.l_buf+u],u++,0===r?l(e,i,t):(l(e,(s=V[i])+S+1,t),0!==(a=z[s])&&c(e,i-=G[s],a),l(e,s=o(--r),n),0!==(a=U[s])&&c(e,r-=Y[s],a))}while(u<e.last_lit);l(e,M,t)}function g(e,t){var n,r,i,s=t.dyn_tree,o=t.stat_desc.static_tree,a=t.stat_desc.has_stree,c=t.stat_desc.elems,l=-1;for(e.heap_len=0,e.heap_max=O,n=0;n<c;n++)0!==s[2*n]?(e.heap[++e.heap_len]=l=n,e.depth[n]=0):s[2*n+1]=0;for(;e.heap_len<2;)s[2*(i=e.heap[++e.heap_len]=l<2?++l:0)]=1,e.depth[i]=0,e.opt_len--,a&&(e.static_len-=o[2*i+1]);for(t.max_code=l,n=e.heap_len>>1;n>=1;n--)p(e,s,n);i=c;do{n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],p(e,s,1),r=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=r,s[2*i]=s[2*n]+s[2*r],e.depth[i]=(e.depth[n]>=e.depth[r]?e.depth[n]:e.depth[r])+1,s[2*n+1]=s[2*r+1]=i,e.heap[1]=i++,p(e,s,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,r,i,s,o,a,c=t.dyn_tree,l=t.max_code,u=t.stat_desc.static_tree,h=t.stat_desc.has_stree,d=t.stat_desc.extra_bits,f=t.stat_desc.extra_base,_=t.stat_desc.max_length,p=0;for(s=0;s<=N;s++)e.bl_count[s]=0;for(c[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<O;n++)(s=c[2*c[2*(r=e.heap[n])+1]+1]+1)>_&&(s=_,p++),c[2*r+1]=s,r>l||(e.bl_count[s]++,o=0,r>=f&&(o=d[r-f]),a=c[2*r],e.opt_len+=a*(s+o),h&&(e.static_len+=a*(u[2*r+1]+o)));if(0!==p){do{for(s=_-1;0===e.bl_count[s];)s--;e.bl_count[s]--,e.bl_count[s+1]+=2,e.bl_count[_]--,p-=2}while(p>0);for(s=_;0!==s;s--)for(r=e.bl_count[s];0!==r;)(i=e.heap[--n])>l||(c[2*i+1]!==s&&(e.opt_len+=(s-c[2*i+1])*c[2*i],c[2*i+1]=s),r--)}}(e,t),h(s,l,e.bl_count)}function y(e,t,n){var r,i,s=-1,o=t[1],a=0,c=7,l=4;for(0===o&&(c=138,l=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)i=o,o=t[2*(r+1)+1],++a<c&&i===o||(a<l?e.bl_tree[2*i]+=a:0!==i?(i!==s&&e.bl_tree[2*i]++,e.bl_tree[2*L]++):a<=10?e.bl_tree[2*D]++:e.bl_tree[2*B]++,a=0,s=i,0===o?(c=138,l=3):i===o?(c=6,l=3):(c=7,l=4))}function b(e,t,n){var r,i,s=-1,o=t[1],a=0,u=7,h=4;for(0===o&&(u=138,h=3),r=0;r<=n;r++)if(i=o,o=t[2*(r+1)+1],!(++a<u&&i===o)){if(a<h)do{l(e,i,e.bl_tree)}while(0!=--a);else 0!==i?(i!==s&&(l(e,i,e.bl_tree),a--),l(e,L,e.bl_tree),c(e,a-3,2)):a<=10?(l(e,D,e.bl_tree),c(e,a-3,3)):(l(e,B,e.bl_tree),c(e,a-11,7));a=0,s=i,0===o?(u=138,h=3):i===o?(u=6,h=3):(u=7,h=4)}}function v(e,t,n,r){c(e,(x<<1)+(r?1:0),3),function(e,t,n,r){f(e),r&&(a(e,n),a(e,~n)),w.arraySet(e.pending_buf,e.window,t,n,e.pending),e.pending+=n}(e,t,n,!0)}var w=e("../utils/common"),E=0,k=1,x=0,A=29,S=256,P=S+1+A,T=30,C=19,O=2*P+1,N=15,R=16,I=7,M=256,L=16,D=17,B=18,z=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],U=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],q=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],j=new Array(2*(P+2));r(j);var H=new Array(2*T);r(H);var W=new Array(512);r(W);var V=new Array(256);r(V);var G=new Array(A);r(G);var Y=new Array(T);r(Y);var $,X,K,Z=!1;n._tr_init=function(e){Z||(function(){var e,t,n,r,s,o=new Array(N+1);for(n=0,r=0;r<A-1;r++)for(G[r]=n,e=0;e<1<<z[r];e++)V[n++]=r;for(V[n-1]=r,s=0,r=0;r<16;r++)for(Y[r]=s,e=0;e<1<<U[r];e++)W[s++]=r;for(s>>=7;r<T;r++)for(Y[r]=s<<7,e=0;e<1<<U[r]-7;e++)W[256+s++]=r;for(t=0;t<=N;t++)o[t]=0;for(e=0;e<=143;)j[2*e+1]=8,e++,o[8]++;for(;e<=255;)j[2*e+1]=9,e++,o[9]++;for(;e<=279;)j[2*e+1]=7,e++,o[7]++;for(;e<=287;)j[2*e+1]=8,e++,o[8]++;for(h(j,P+1,o),e=0;e<T;e++)H[2*e+1]=5,H[2*e]=u(e,5);$=new i(j,z,S+1,P,N),X=new i(H,U,0,T,N),K=new i(new Array(0),q,0,C,I)}(),Z=!0),e.l_desc=new s(e.dyn_ltree,$),e.d_desc=new s(e.dyn_dtree,X),e.bl_desc=new s(e.bl_tree,K),e.bi_buf=0,e.bi_valid=0,d(e)},n._tr_stored_block=v,n._tr_flush_block=function(e,t,n,r){var i,s,o=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return E;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return k;for(t=32;t<S;t++)if(0!==e.dyn_ltree[2*t])return k;return E}(e)),g(e,e.l_desc),g(e,e.d_desc),o=function(e){var t;for(y(e,e.dyn_ltree,e.l_desc.max_code),y(e,e.dyn_dtree,e.d_desc.max_code),g(e,e.bl_desc),t=C-1;t>=3&&0===e.bl_tree[2*F[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),i=e.opt_len+3+7>>>3,(s=e.static_len+3+7>>>3)<=i&&(i=s)):i=s=n+5,n+4<=i&&-1!==t?v(e,t,n,r):4===e.strategy||s===i?(c(e,2+(r?1:0),3),m(e,j,H)):(c(e,4+(r?1:0),3),function(e,t,n,r){var i;for(c(e,t-257,5),c(e,n-1,5),c(e,r-4,4),i=0;i<r;i++)c(e,e.bl_tree[2*F[i]+1],3);b(e,e.dyn_ltree,t-1),b(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),m(e,e.dyn_ltree,e.dyn_dtree)),d(e),r&&f(e)},n._tr_tally=function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(V[n]+S+1)]++,e.dyn_dtree[2*o(t)]++),e.last_lit===e.lit_bufsize-1},n._tr_align=function(e){c(e,2,3),l(e,M,j),function(e){16===e.bi_valid?(a(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},{"../utils/common":3}],15:[function(e,t,n){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],"/":[function(e,t,n){"use strict";var r={};(0,e("./lib/utils/common").assign)(r,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=r},{"./lib/deflate":1,"./lib/inflate":2,"./lib/utils/common":3,"./lib/zlib/constants":6}]},{},[])("/")}),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define("@detox/simple-peer",[],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).SimplePeer=e()}}(function(){return function(){return function e(t,n,r){function i(o,a){if(!n[o]){if(!t[o]){var c="function"==typeof require&&require;if(!a&&c)return c(o,!0);if(s)return s(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[o]={exports:{}};t[o][0].call(u.exports,function(e){return i(t[o][1][e]||e)},u,u.exports,e,t,n,r)}return n[o].exports}for(var s="function"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}}()({"/":[function(e,t,n){t.exports=o;var r=e("eventemitter").EventEmitter,i=e("inherits"),s=e("./lib/randombytes");function o(e){var t=this;if(!(t instanceof o))return new o(e);r.call(t),t.channelName=e.initiator?e.channelName||s(20).toString("hex"):null,t._isChromium="undefined"!=typeof window&&!!window.webkitRTCPeerConnection,t.initiator=e.initiator||!1,t.channelConfig=e.channelConfig||o.channelConfig,t.config=e.config||o.config,t.constraints=t._transformConstraints(e.constraints||o.constraints),t.offerConstraints=t._transformConstraints(e.offerConstraints||{}),t.answerConstraints=t._transformConstraints(e.answerConstraints||{}),t.reconnectTimer=e.reconnectTimer||!1,t.sdpTransform=e.sdpTransform||function(e){return e},t.streams=e.streams||(e.stream?[e.stream]:[]),t.trickle=void 0===e.trickle||e.trickle,t.destroyed=!1,t.connected=!1,t.remoteAddress=void 0,t.remoteFamily=void 0,t.remotePort=void 0,t.localAddress=void 0,t.localPort=void 0,t._wrtc=e.wrtc&&"object"==typeof e.wrtc?e.wrtc:window,t._pcReady=!1,t._channelReady=!1,t._iceComplete=!1,t._channel=null,t._pendingCandidates=[],t._isNegotiating=!1,t._batchedNegotiation=!1,t._queuedNegotiation=!1,t._sendersAwaitingStable=[],t._senderMap=new WeakMap,t._remoteTracks=[],t._remoteStreams=[],t._chunk=null,t._cb=null,t._interval=null,t._reconnectTimeout=null,t._pc=new t._wrtc.RTCPeerConnection(t.config,t.constraints),t._isWrtc=Array.isArray(t._pc.RTCIceConnectionStates),t._isReactNativeWebrtc="number"==typeof t._pc._peerConnectionId,t._pc.oniceconnectionstatechange=function(){t._onIceStateChange()},t._pc.onicegatheringstatechange=function(){t._onIceStateChange()},t._pc.onsignalingstatechange=function(){t._onSignalingStateChange()},t._pc.onicecandidate=function(e){t._onIceCandidate(e)},t.initiator?t._setupData({channel:t._pc.createDataChannel(t.channelName,t.channelConfig)}):t._pc.ondatachannel=function(e){t._setupData(e)},"addTrack"in t._pc&&(t.streams&&t.streams.forEach(function(e){t.addStream(e)}),t._pc.ontrack=function(e){t._onTrack(e)}),t.initiator&&t._needsNegotiation()}function a(e){return"{"===e[0]?e.slice(1,-1):e}function c(e,t){var n=new Error(e);return n.code=t,n}function l(){}i(o,r),o.config={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:global.stun.twilio.com:3478?transport=udp"}]},o.constraints={},o.channelConfig={},Object.defineProperty(o.prototype,"bufferSize",{get:function(){return this._channel&&this._channel.bufferedAmount||0}}),o.prototype.address=function(){return{port:this.localPort,family:"IPv4",address:this.localAddress}},o.prototype.signal=function(e){var t=this;if(t.destroyed)throw c("cannot signal after peer is destroyed","ERR_SIGNALING");if("string"==typeof e)try{e=JSON.parse(e)}catch(t){e={}}e.renegotiate&&t._needsNegotiation(),e.candidate&&(t._pc.remoteDescription&&t._pc.remoteDescription.type?t._addIceCandidate(e.candidate):t._pendingCandidates.push(e.candidate)),e.sdp&&t._pc.setRemoteDescription(new t._wrtc.RTCSessionDescription(e),function(){t.destroyed||(t._checkForMediaRemovals(e.sdp),t._pendingCandidates.forEach(function(e){t._addIceCandidate(e)}),t._pendingCandidates=[],"offer"===t._pc.remoteDescription.type&&t._createAnswer())},function(e){t.destroy(c(e,"ERR_SET_REMOTE_DESCRIPTION"))}),e.sdp||e.candidate||e.renegotiate||t.destroy(c("signal() called with invalid signal data","ERR_SIGNALING"))},o.prototype._addIceCandidate=function(e){var t=this;try{t._pc.addIceCandidate(new t._wrtc.RTCIceCandidate(e),l,function(e){t.destroy(c(e,"ERR_ADD_ICE_CANDIDATE"))})}catch(e){t.destroy(c("error adding candidate: "+e.message,"ERR_ADD_ICE_CANDIDATE"))}},o.prototype.send=function(e){this._channel.send(e)},o.prototype.addStream=function(e){var t=this;e.getTracks().forEach(function(n){t.addTrack(n,e)})},o.prototype.addTrack=function(e,t){var n=this,r=n._pc.addTrack(e,t),i=n._senderMap.get(e)||new WeakMap;i.set(t,r),n._senderMap.set(e,i),n._needsNegotiation()},o.prototype.removeTrack=function(e,t){var n=this,r=n._senderMap.get(e),i=r?r.get(t):null;i||n.destroy(new Error("Cannot remove track that was never added."));try{n._pc.removeTrack(i)}catch(e){"NS_ERROR_UNEXPECTED"===e.name?n._sendersAwaitingStable.push(i):n.destroy(e)}},o.prototype.removeStream=function(e){var t=this;e.getTracks().forEach(function(n){t.removeTrack(n,e)})},o.prototype._needsNegotiation=function(){var e=this;e._batchedNegotiation||(e._batchedNegotiation=!0,setTimeout(function(){e._batchedNegotiation=!1,e.negotiate()},0))},o.prototype.negotiate=function(){var e=this;e.initiator?e._isNegotiating?e._queuedNegotiation=!0:e._createOffer():e.emit("signal",{renegotiate:!0}),e._isNegotiating=!0},o.prototype.destroy=function(e){var t=this;if(!t.destroyed){if(t.destroyed=!0,t.connected=!1,t._pcReady=!1,t._channelReady=!1,t._remoteTracks=null,t._remoteStreams=null,t._senderMap=null,clearInterval(t._interval),clearTimeout(t._reconnectTimeout),t._interval=null,t._reconnectTimeout=null,t._chunk=null,t._cb=null,t._channel){try{t._channel.close()}catch(e){}t._channel.onmessage=null,t._channel.onopen=null,t._channel.onclose=null,t._channel.onerror=null}if(t._pc){try{t._pc.close()}catch(e){}t._pc.oniceconnectionstatechange=null,t._pc.onicegatheringstatechange=null,t._pc.onsignalingstatechange=null,t._pc.onicecandidate=null,"addTrack"in t._pc&&(t._pc.ontrack=null),t._pc.ondatachannel=null}t._pc=null,t._channel=null,e&&t.emit("error",e),t.emit("close")}},o.prototype._setupData=function(e){var t=this;if(!e.channel)return t.destroy(c("Data channel event is missing `channel` property","ERR_DATA_CHANNEL"));t._channel=e.channel,t._channel.binaryType="arraybuffer","number"==typeof t._channel.bufferedAmountLowThreshold&&(t._channel.bufferedAmountLowThreshold=65536),t.channelName=t._channel.label,t._channel.onmessage=function(e){t._onChannelMessage(e)},t._channel.onbufferedamountlow=function(){t._onChannelBufferedAmountLow()},t._channel.onopen=function(){t._onChannelOpen()},t._channel.onclose=function(){t._onChannelClose()},t._channel.onerror=function(e){t.destroy(c(e,"ERR_DATA_CHANNEL"))}},o.prototype._createOffer=function(){var e=this;e.destroyed||e._pc.createOffer(function(t){function n(){var n=e._pc.localDescription||t;e.emit("signal",{type:n.type,sdp:n.sdp})}e.destroyed||(t.sdp=e.sdpTransform(t.sdp),e._pc.setLocalDescription(t,function(){if(e.destroyed)return;e.trickle||e._iceComplete?n():e.once("_iceComplete",n)},function(t){e.destroy(c(t,"ERR_SET_LOCAL_DESCRIPTION"))}))},function(t){e.destroy(c(t,"ERR_CREATE_OFFER"))},e.offerConstraints)},o.prototype._createAnswer=function(){var e=this;e.destroyed||e._pc.createAnswer(function(t){function n(){var n=e._pc.localDescription||t;e.emit("signal",{type:n.type,sdp:n.sdp})}e.destroyed||(t.sdp=e.sdpTransform(t.sdp),e._pc.setLocalDescription(t,function(){if(e.destroyed)return;e.trickle||e._iceComplete?n():e.once("_iceComplete",n)},function(t){e.destroy(c(t,"ERR_SET_LOCAL_DESCRIPTION"))}))},function(t){e.destroy(c(t,"ERR_CREATE_ANSWER"))},e.answerConstraints)},o.prototype._onIceStateChange=function(){var e=this;if(!e.destroyed){var t=e._pc.iceConnectionState,n=e._pc.iceGatheringState;e.emit("iceStateChange",t,n),"connected"!==t&&"completed"!==t||(clearTimeout(e._reconnectTimeout),e._pcReady=!0,e._maybeReady()),"failed"===t&&e.destroy(c("Ice connection failed.","ERR_ICE_CONNECTION_FAILURE")),"closed"===t&&e.destroy(new Error("Ice connection closed."))}},o.prototype.getStats=function(e){var t=this;0===t._pc.getStats.length?t._pc.getStats().then(function(t){var n=[];t.forEach(function(e){n.push(e)}),e(null,n)},function(t){e(t)}):t._isReactNativeWebrtc?t._pc.getStats(null,function(t){var n=[];t.forEach(function(e){n.push(e)}),e(null,n)},function(t){e(t)}):t._pc.getStats.length>0?t._pc.getStats(function(n){if(!t.destroyed){var r=[];n.result().forEach(function(e){var t={};e.names().forEach(function(n){t[n]=e.stat(n)}),t.id=e.id,t.type=e.type,t.timestamp=e.timestamp,r.push(t)}),e(null,r)}},function(t){e(t)}):e(null,[])},o.prototype._maybeReady=function(){var e=this;!e.connected&&!e._connecting&&e._pcReady&&e._channelReady&&(e._connecting=!0,function t(){e.destroyed||e.getStats(function(n,r){if(!e.destroyed){n&&(r=[]);var i={},s={},o={},a=!1;if(r.forEach(function(e){"remotecandidate"!==e.type&&"remote-candidate"!==e.type||(i[e.id]=e),"localcandidate"!==e.type&&"local-candidate"!==e.type||(s[e.id]=e),"candidatepair"!==e.type&&"candidate-pair"!==e.type||(o[e.id]=e)}),r.forEach(function(e){"transport"===e.type&&e.selectedCandidatePairId&&u(o[e.selectedCandidatePairId]),("googCandidatePair"===e.type&&"true"===e.googActiveConnection||("candidatepair"===e.type||"candidate-pair"===e.type)&&e.selected)&&u(e)}),a||Object.keys(o).length&&!Object.keys(s).length){if(e._connecting=!1,e.connected=!0,e._chunk){try{e.send(e._chunk)}catch(n){return e.destroy(c(n,"ERR_DATA_CHANNEL"))}e._chunk=null;var l=e._cb;e._cb=null,l(null)}"number"!=typeof e._channel.bufferedAmountLowThreshold&&(e._interval=setInterval(function(){e._onInterval()},150),e._interval.unref&&e._interval.unref()),e.emit("connect")}else setTimeout(t,100)}function u(t){a=!0;var n=s[t.localCandidateId];n&&n.ip?(e.localAddress=n.ip,e.localPort=Number(n.port)):n&&n.ipAddress?(e.localAddress=n.ipAddress,e.localPort=Number(n.portNumber)):"string"==typeof t.googLocalAddress&&(n=t.googLocalAddress.split(":"),e.localAddress=n[0],e.localPort=Number(n[1]));var r=i[t.remoteCandidateId];r&&r.ip?(e.remoteAddress=r.ip,e.remotePort=Number(r.port)):r&&r.ipAddress?(e.remoteAddress=r.ipAddress,e.remotePort=Number(r.portNumber)):"string"==typeof t.googRemoteAddress&&(r=t.googRemoteAddress.split(":"),e.remoteAddress=r[0],e.remotePort=Number(r[1])),e.remoteFamily="IPv4"}})}())},o.prototype._onInterval=function(){var e=this;!e._cb||!e._channel||e._channel.bufferedAmount>65536||e._onChannelBufferedAmountLow()},o.prototype._onSignalingStateChange=function(){var e=this;e.destroyed||("stable"===e._pc.signalingState&&(e._isNegotiating=!1,e._sendersAwaitingStable.forEach(function(t){e.removeTrack(t),e._queuedNegotiation=!0}),e._sendersAwaitingStable=[],e._queuedNegotiation&&(e._queuedNegotiation=!1,e._needsNegotiation()),e.emit("negotiate")),e.emit("signalingStateChange",e._pc.signalingState))},o.prototype._onIceCandidate=function(e){var t=this;t.destroyed||(e.candidate&&t.trickle?t.emit("signal",{candidate:{candidate:e.candidate.candidate,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid}}):e.candidate||(t._iceComplete=!0,t.emit("_iceComplete")))},o.prototype._onChannelMessage=function(e){if(!this.destroyed){var t=e.data;t instanceof ArrayBuffer&&(t=new Uint8Array(t)),this.emit("data",t)}},o.prototype._onChannelBufferedAmountLow=function(){var e=this;if(!e.destroyed&&e._cb){var t=e._cb;e._cb=null,t(null)}},o.prototype._onChannelOpen=function(){var e=this;e.connected||e.destroyed||(e._channelReady=!0,e._maybeReady())},o.prototype._onChannelClose=function(){this.destroyed||this.destroy()},o.prototype._onTrack=function(e){var t=this;t.destroyed||e.streams.forEach(function(n){t.emit("track",e.track,n),t._remoteTracks.push({track:e.track,stream:n}),t._remoteStreams.some(function(e){return e.id===n.id})||(t._remoteStreams.push(n),setTimeout(function(){t.emit("stream",n)},0))})},o.prototype._checkForMediaRemovals=function(e){var t=this,n=t._parseMsids(e);t._remoteTracks=t._remoteTracks.filter(function(e){var r=e.track,i=e.stream,s=n.some(function(e){var t=a(r.id),n=a(i.id);return e.trackId===t&&e.streamId===n});return s||t.emit("removetrack",r,i),s}),t._remoteStreams=t._remoteStreams.filter(function(e){var r=n.some(function(t){var n=a(e.id);return t.streamId===n});return r||t.emit("removestream",e),r})},o.prototype._parseMsids=function(e){var t=e.split("\n").filter(function(e){return 0===e.indexOf("a=ssrc:")&&-1!==e.indexOf(" msid:")}).map(function(e){var t=e.slice(e.indexOf(" msid:")+" msid:".length,-1).split(" ");return{streamId:t[0],trackId:t[1]}}),n=e.split("\n").filter(function(e){return 0===e.indexOf("a=msid:{")}).map(function(e){var t=e.slice(e.indexOf("a=msid:{")+"a=msid:{".length,-2).split("} {");return{streamId:t[0],trackId:t[1]}});return[].concat(t,n)},o.prototype._transformConstraints=function(e){if(0===Object.keys(e).length)return e;if((e.mandatory||e.optional)&&!this._isChromium){var t=Object.assign({},e.optional,e.mandatory);return void 0!==t.OfferToReceiveVideo&&(t.offerToReceiveVideo=t.OfferToReceiveVideo,delete t.OfferToReceiveVideo),void 0!==t.OfferToReceiveAudio&&(t.offerToReceiveAudio=t.OfferToReceiveAudio,delete t.OfferToReceiveAudio),t}return e.mandatory||e.optional||!this._isChromium?e:(void 0!==e.offerToReceiveVideo&&(e.OfferToReceiveVideo=e.offerToReceiveVideo,delete e.offerToReceiveVideo),void 0!==e.offerToReceiveAudio&&(e.OfferToReceiveAudio=e.offerToReceiveAudio,delete e.offerToReceiveAudio),{mandatory:e})}},{"./lib/randombytes":1,eventemitter:2,inherits:3}],1:[function(e,t,n){t.exports=function(e){var t=new Uint8Array(e);return window.crypto.getRandomValues(t),t}},{}],2:[function(e,t,n){!function(e){"function"!=typeof Array.isArray&&(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e){for(var t=0,n=this.length;t<n;t++)if(this[t]===e)return t;return-1});var t=e.EventEmitter=function(){},n=Array.isArray;t.prototype.emit=function(e){if("error"===e&&(!this._events||!this._events.error||n(this._events.error)&&!this._events.error.length))throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");if(!this._events)return!1;var t=this._events[e];if(!t)return!1;if("function"==typeof t){switch(arguments.length){case 1:t.call(this);break;case 2:t.call(this,arguments[1]);break;case 3:t.call(this,arguments[1],arguments[2]);break;default:var r=Array.prototype.slice.call(arguments,1);t.apply(this,r)}return!0}if(n(t)){r=Array.prototype.slice.call(arguments,1);for(var i=t.slice(),s=0,o=i.length;s<o;s++)i[s].apply(this,r);return!0}return!1},t.prototype.addListener=function(e,t){if("function"!=typeof t)throw new Error("addListener only takes instances of Function");return this._events||(this._events={}),this.emit("newListener",e,t),this._events[e]?n(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,this},t.prototype.on=t.prototype.addListener,t.prototype.once=function(e,t){var n=this;n.on(e,function r(){n.removeListener(e,r),t.apply(this,arguments)})},t.prototype.removeListener=function(e,t){if("function"!=typeof t)throw new Error("removeListener only takes instances of Function");if(!this._events||!this._events[e])return this;var r=this._events[e];if(n(r)){var i=r.indexOf(t);if(i<0)return this;r.splice(i,1),0==r.length&&delete this._events[e]}else this._events[e]===t&&delete this._events[e];return this},t.prototype.removeAllListeners=function(e){return e&&this._events&&this._events[e]&&(this._events[e]=null),this},t.prototype.listeners=function(e){return this._events||(this._events={}),this._events[e]||(this._events[e]=[]),n(this._events[e])||(this._events[e]=[this._events[e]]),this._events[e]}}(void 0===n?window:n)},{}],3:[function(e,t,n){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}]},{},[])("/")}),function(){var e,t,n,r,i,s,o,a,c,l,u;function h(e,t){e[0]=e[1],e[1]=e[2],e[2]=e[3],e[3]=e[4],e[4]=t}function d(d,f,_,p,m,g,y,b){var v,w,E,k,x,A,S,P,T,C,O,N;function R(e){var t=this;if(!(this instanceof R))return new R(e);this._sign=e.sign,this._send_delay=1e3/e.packets_per_second,this._sending=e.initiator,this._multiplexer=m.Multiplexer(a,c),this._demultiplexer=m.Demultiplexer(a,c),this._send_zlib_buffer=[new Uint8Array(0),new Uint8Array(0),new Uint8Array(0),new Uint8Array(0),new Uint8Array(0)],this._receive_zlib_buffer=[new Uint8Array(0),new Uint8Array(0),new Uint8Array(0),new Uint8Array(0),new Uint8Array(0)],this.once("connect",function(){t._last_sent=+new Date,t._sending&&t._real_send()}),b.call(this,e)}function I(e){return e.constructor.from(d.blake2b_256(e))}function M(e){return v.encode(e).slice(1,-1)}function L(e,i,s,o,a,c,l){var h,f,_,p=this;if(null==c&&(c=2),null==l&&(l={}),!(this instanceof L))return new L(e,i,s,o,a,c,l);g.call(this),a<1&&(a=1),this._pending_http_ids=new Map,this._http_address={},(h=this._socket=w({simple_peer_constructor:R,simple_peer_opts:{config:{iceServers:o},packets_per_second:a,sign:function(t){return d.sign(t,e,i)}},http_address:this._http_address})).on("http_peer_connection_alias",function(e,t,n){s.forEach(function(r){if(r.host===e&&r.port===t)return p._pending_http_ids.set(n,r.node_id),n.on("close",function(){p._pending_http_ids.delete(n)})})}),h.on("node_connected",function(e){var i,s,o;i=x(e),s=p._socket.get_id_mapping(e),p._pending_http_ids.has(s)&&(o=p._pending_http_ids.get(s),p._pending_http_ids.delete(s),o!==e)?s.destroy():d.verify(s._signature_received,s._sdp_received,i)?(s.on("custom_data",function(s,o){if(!p._bootstrap_node)switch(s){case t:p._socket.add_tag(e,"detox-responder"),p.fire("node_tagged",i);break;case n:p._socket.del_tag(e,"detox-responder"),p.fire("node_untagged",i);break;default:if(s<r)return;p.fire("data",i,s-r,o)}}),p.fire("node_connected",i)):s.destroy()}),h.on("node_disconnected",function(e){p.fire("node_disconnected",x(e))}),f={bootstrap:s,hash:I,k:c,nodeId:e,socket:this._socket,timeout:1e3*u,verify:d.verify},(_=this._dht=new E(Object.assign(f,l))).on("error",function(e){p.fire("error",e)}),_.once("ready",function(){p.fire("ready")})}function D(e,t){var n=this;if(null==t&&(t=10),!(this instanceof D))return new D(e,t);g.call(this),this._encryptor_instances=T(),this._rewrapper_instances=T(),this._last_node_in_routing_path=T(),this._multiplexers=T(),this._demultiplexers=T(),this._established_routing_paths=T(),this._ronion=p(l,i,s,t).on("activity",function(e,t){n.fire("activity",e,t)}).on("create_request",function(t,r,i){var s,o,c,l,u;if(!n._destroyed&&(s=P([t,r]),!n._encryptor_instances.has(s))){o=d.Encryptor(!1,e);try{o.put_handshake_message(i)}catch(e){return void e}n._ronion.create_response(t,r,o.get_handshake_message()),n._ronion.confirm_incoming_segment_established(t,r),n._multiplexers.set(s,m.Multiplexer(a,n._max_packet_data_size)),n._demultiplexers.set(s,m.Demultiplexer(a,n._max_packet_data_size)),o.ready()&&(c=o.get_rewrapper_keys().map(d.Rewrapper),(l=T()).set(t,o),(u=T()).set(t,c),n._encryptor_instances.set(s,l),n._rewrapper_instances.set(s,u),n._last_node_in_routing_path.set(s,t))}}).on("send",function(e,t){n.fire("send",e,t)}).on("data",function(e,t,r,i,s){var o,a,c,l;n._destroyed||(o=P([e,t]),a=n._last_node_in_routing_path.get(o),S(r,a)&&(c=n._demultiplexers.get(o))&&(c.feed(s),c.have_more_data()&&(l=c.get_data(),n.fire("data",e,t,i,l))))}).on("encrypt",function(e){var t,r,i,s,o,a,c;n._destroyed||(t=e.address,r=e.segment_id,i=e.target_address,s=e.plaintext,o=P([t,r]),(a=null!=(c=n._encryptor_instances.get(o))?c.get(i):void 0)&&a.ready()&&(e.ciphertext=a.encrypt(s)))}).on("decrypt",function(e){var t,r,i,s,o,a,c;if(!n._destroyed&&(t=e.address,r=e.segment_id,i=e.target_address,s=e.ciphertext,o=P([t,r]),(a=null!=(c=n._encryptor_instances.get(o))?c.get(i):void 0)&&a.ready()))try{e.plaintext=a.decrypt(s)}catch(e){e,a.destroy(),n._encryptor_instances.get(o).delete(i)}}).on("wrap",function(e){var t,r,i,s,o,a,c,l;n._destroyed||(t=e.address,r=e.segment_id,i=e.target_address,s=e.unwrapped,o=P([t,r]),(a=null!=(c=n._rewrapper_instances.get(o))&&null!=(l=c.get(i))?l[0]:void 0)&&(e.wrapped=a.wrap(s)))}).on("unwrap",function(e){var t,r,i,s,o,a,c,l;n._destroyed||(t=e.address,r=e.segment_id,i=e.target_address,s=e.wrapped,o=P([t,r]),(a=null!=(c=n._rewrapper_instances.get(o))&&null!=(l=c.get(i))?l[1]:void 0)&&(e.unwrapped=a.unwrap(s)))}),this._max_packet_data_size=this._ronion.get_max_command_data_length()}return v=f.bencode,w=f["webrtc-socket"],E=f["webtorrent-dht"],k=_.array2hex,x=_.hex2array,A=_.string2array,S=_.are_arrays_equal,P=_.concat_arrays,T=_.ArrayMap,R.prototype=Object.create(b.prototype),(C=R.prototype).emit=function(t,n){var r,i;switch(t){case"signal":n.signature=Array.from(this._sign(A(n.sdp))),b.prototype.emit.call(this,"signal",n);break;case"data":if(this._sending)return void this.destroy();if(n.length!==c)return void this.destroy();for(this._demultiplexer.feed(n);this._demultiplexer.have_more_data();)(i=(r=this._demultiplexer.get_data())[0])===e?b.prototype.emit.call(this,"data",this._zlib_decompress(r.subarray(1))):b.prototype.emit.call(this,"custom_data",i,r.subarray(1));this._sending=!0,this._real_send();break;default:b.prototype.emit.apply(this,arguments)}},C.signal=function(e){if(e.signature){this._signature_received=Uint8Array.from(e.signature),this._sdp_received=A(e.sdp);try{b.prototype.signal.call(this,e)}catch(e){}}else this.destroy()},C.send=function(t){this._send_multiplex(this._zlib_compress(t),e)},C._send_routing_data=function(e,t){this._send_multiplex(e,t)},C._send_multiplex=function(e,t){var n,r;(n=r=new Uint8Array(e.length+1)).set([t]),n.set(e,1),this._multiplexer.feed(r)},C._real_send=function(){var e,t=this;e=Math.max(0,this._send_delay-(new Date-this._last_sent)),setTimeout(function(){var e;if(!t.destroyed)try{b.prototype.send.call(t,t._multiplexer.get_block()),t._sending=!1,t._last_sent=+new Date}catch(n){e=n,t.emit("error",e)}},e)},C._zlib_compress=function(e){var t;return t=y.deflate(e,{dictionary:P(this._send_zlib_buffer),level:1}),h(this._send_zlib_buffer,e),t},C._zlib_decompress=function(e){var t;return t=y.inflate(e,{dictionary:P(this._receive_zlib_buffer)}),h(this._receive_zlib_buffer,t),t},C.setMaxListeners=function(){},Object.defineProperty(R.prototype,"constructor",{value:R}),L.prototype=Object.create(g.prototype),(O=L.prototype).start_bootstrap_node=function(e,t,n,r){null==n&&(n=e),null==r&&(r=t),this._destroyed||(Object.assign(this._http_address,{address:n,port:r}),this._dht.listen(t,e),this._bootstrap_node=!0)},O.get_bootstrap_nodes=function(){var e;return this._destroyed?[]:function(){var t,n,r=[];for(t in n=this._dht._rpc.socket.socket._peer_connections)(e=n[t]).http_server&&e.id&&r.push({node_id:e.id,host:e.http_server.host,port:e.http_server.port});return r}.call(this).filter(Boolean)},O.lookup=function(e){this._destroyed||this._dht.lookup(e)},O.add_used_tag=function(e){var n,r;this._destroyed||(n=k(e),(r=this._socket.get_id_mapping(n))&&(r._send_routing_data(new Uint8Array(0),t),this._socket.add_tag(n,"detox-initiator")))},O.del_used_tag=function(e){var t,r;this._destroyed||(t=k(e),(r=this._socket.get_id_mapping(t))&&(r._send_routing_data(new Uint8Array(0),n),this._socket.del_tag(t,"detox-initiator")))},O.send_data=function(e,t,n){var i,s;this._destroyed||n.length>a||(i=k(e),(s=this._socket.get_id_mapping(i))&&s._send_routing_data(n,t+r))},O.generate_announcement_message=function(e,t,n){var r,s,o,a,c,l,u,h;for(r=+new Date,s=new Uint8Array(n.length*i),o=0,a=n.length;o<a;++o)c=o,l=n[o],s.set(l,c*i);return u=M({seq:r,v:s}),h=d.sign(u,e,t),Uint8Array.from(v.encode({k:e,seq:r,sig:h,v:s}))},O.verify_announcement_message=function(e){var t;try{e=v.decode(e)}catch(e){}return e&&e.k&&e.seq&&e.sig&&e.v?(t=M({seq:e.seq,v:e.v}),d.verify(e.sig,t,e.k)?Uint8Array.from(e.k):null):null},O.publish_announcement_message=function(e){!this._destroyed&&this.verify_announcement_message(e)&&this._dht.put(v.decode(e))},O.find_introduction_nodes=function(e,t,n){var r;this._destroyed||(r=I(e),this._dht.get(r,function(e,r){var s,o,a,c,l;if(r&&r.v){if(o=[],(s=Uint8Array.from(r.v)).length%i==0){for(a=0,c=s.length/i;a<c;++a)l=a,o.push(s.subarray(l*i,(l+1)*i));t(o)}}else"function"==typeof n&&n()}))},O.destroy=function(e){this._destroyed||(this._dht.destroy(e),delete this._dht,this._destroyed=!0)},Object.defineProperty(L.prototype,"constructor",{value:L}),D.prototype=Object.create(g.prototype),(N=D.prototype).process_packet=function(e,t){this._destroyed||this._ronion.process_packet(e,t)},N.construct_routing_path=function(e){var t=this;return this._destroyed?Promise.reject():(e=e.slice(),new Promise(function(n,r){var i,s,c,l,u,h,f,_,p,g;function y(r,i,h){var b,v,w;if(S(s,r)&&S(p,i)){clearTimeout(_),t._ronion.off("create_response",y);try{f.put_handshake_message(h)}catch(e){return e,void u()}f.ready()?(l.set(s,f.get_rewrapper_keys().map(d.Rewrapper)),t._ronion.confirm_outgoing_segment_established(s,p),t._multiplexers.set(g,m.Multiplexer(a,t._max_packet_data_size)),t._demultiplexers.set(g,m.Demultiplexer(a,t._max_packet_data_size)),function r(){var i;if(!e.length)return t._established_routing_paths.set(g,[s,p]),void n(p);function a(e,n,i){if(S(s,e)&&S(p,n))if(t._ronion.off("extend_response",a),clearTimeout(w),i.length){try{v.put_handshake_message(i)}catch(e){return void u()}v.ready()?(l.set(b,v.get_rewrapper_keys().map(d.Rewrapper)),t._ronion.confirm_extended_path(s,p),r()):u()}else u()}t._ronion.on("extend_response",a),b=e.shift(),(i=d.convert_public_key(b))?(v=d.Encryptor(!0,i),c.set(b,v),w=setTimeout(function(){t._ronion.off("extend_response",a),u()},1e3*o),t._ronion.extend_request(s,p,b,v.get_handshake_message())):u()}()):u()}}i=e[e.length-1],s=e.shift(),c=T(),l=T(),u=function(){t._destroy_routing_path(s,p),r("Routing path creation failed")},(h=d.convert_public_key(s))?(f=d.Encryptor(!0,h),c.set(s,f),t._ronion.on("create_response",y),_=setTimeout(function(){t._ronion.off("create_response",y),u()},1e3*o),p=t._ronion.create_request(s,f.get_handshake_message()),g=P([s,p]),t._encryptor_instances.set(g,c),t._rewrapper_instances.set(g,l),t._last_node_in_routing_path.set(g,i)):u()}))},N.destroy_routing_path=function(e,t){this._destroy_routing_path(e,t)},N.get_max_packet_data_size=function(){return this._max_packet_data_size},N.send_data=function(e,t,n,r){var i,s,o,c;if(!this._destroyed&&!(r.length>a)&&(i=P([e,t]),s=this._last_node_in_routing_path.get(i),o=this._multiplexers.get(i)))for(o.feed(r);o.have_more_blocks();)c=o.get_block(),this._ronion.data(e,t,s,n,c)},N.destroy=function(){var e=this;this._destroyed||(this._destroyed=!0,this._established_routing_paths.forEach(function(t){var n,r;n=t[0],r=t[1],e._destroy_routing_path(n,r)}))},N._destroy_routing_path=function(e,t){var n,r;n=P([e,t]),(r=this._encryptor_instances.get(n))&&(r.forEach(function(e){e.destroy()}),this._encryptor_instances.delete(n),this._rewrapper_instances.delete(n),this._last_node_in_routing_path.delete(n),this._multiplexers.delete(n),this._demultiplexers.delete(n),this._established_routing_paths.delete(n))},Object.defineProperty(D.prototype,"constructor",{value:D}),{ready:d.ready,DHT:L,Router:D,MAX_DATA_SIZE:a}}e=0,t=1,n=2,r=10,i=32,s=16,o=10,a=Math.pow(2,16)-1,l=(c=512)-3,u=30,"function"==typeof define&&define.amd?define("@detox/transport",["@detox/crypto","@detox/dht","@detox/utils","ronion","fixed-size-multiplexer","async-eventer","pako","@detox/simple-peer"],d):"object"==typeof exports?module.exports=d(require("@detox/crypto"),require("@detox/dht"),require("@detox/utils"),require("ronion"),require("fixed-size-multiplexer"),require("async-eventer"),require("pako"),require("@detox/simple-peer")):this.detox_transport=d(this.detox_crypto,this.detox_dht,this.detox_utils,this.ronion,this.fixed_size_multiplexer,this.async_eventer,this.pako,this.SimplePeer)}.call(this),function(){function e(e,t,n,r,i,s){var o=new Uint8Array(3*m+y+v+m);return o.set(e),o.set(t,m),o.set(n,2*m),o.set(r,3*m),o.set(i,3*m+y),o.set(s,3*m+y+v),o}function t(e){return[e.subarray(0,g),e.subarray(g,g+m),e.subarray(g+m)]}function n(n,q,F,j,H){function W(e,E,O,N,I,M,L){var D=this;if(null==N&&(N=1),null==I&&(I=2),null==M&&(M=10),null==L&&(L={}),!(this instanceof W))return new W(e,E,O,N,I,M,L);H.call(this),this.i=ee(),this.G=n.create_keypair(e),this.J=q.MAX_DATA_SIZE,this.f=ee(),this.l=te(),this.b=ee(),this.I=te(),this.j=ee(),this.h=ee(),this.g=ee(),this.C=ee(),this.A=ee(),this.R=ee(),this.s=ee(),this.o=ee(),this.H=ee(),this.B=te(),this.v=ee(),this.N=ee(),this.M=ee(),this.w=ee(),this.D=te(),this.ha=J(k,function(){var e=+new Date-1e3*k;D.R.forEach(function(t,n){if(t<e){if(D.j.has(n)){var r=D.j.get(n);t=r[0],r=r[1],D.fa(t,r)}D.R.delete(n)}}),D.A.forEach(function(t,n){t<e&&(D.Z(n),D.A.delete(n))});var t=+new Date-2e3*A;D.b.forEach(function(e,n){e<t&&D.b.delete(n)})}),this.la=J(k/5*4,function(){D.i.forEach(function(e,t){var n=e[1],r=e[3];e=e[4],r.size<n&&e&&(e<(n=+new Date-3*w)&&D.Y(t)),r.forEach(function(e){e=K([t,e]);var n=D.h.get(e);e=n[0],n=n[1],D.X(e,n)&&(e=K([e,n]),D.B.add(e))})})}),this.ka=J(P,function(){D.da()&&D.ja()}),this.a=q.DHT(this.G.ed25519.public,this.G.ed25519.private,E,O,N,I,L).on("node_connected",function(e){D.l.add(e),D.b.delete(e),D.fire("aware_of_nodes_count",D.b.size),D.fire("connected_nodes_count",D.l.size);var t=$(e);D.da()&&(function(e,t){for(var n=-1,r=t.length>>>0;++n<r;)if(e===t[n])return!0;return!1}(t,D.get_bootstrap_nodes().map(function(e){return e.node_id}))||D.aa(e))}).on("node_disconnected",function(e){D.l.delete(e),D.fire("connected_nodes_count",D.l.size),D.I.delete(e)}).on("data",function(e,t,n){var a;switch(t){case r:D.c.process_packet(e,n);break;case i:var c=(t=[n.subarray(0,m),n.subarray(m)])[0];if(n=t[1],!D.o.has(c))break;c=(t=D.o.get(c))[0],t=t[1],D.m(c,t,h,n);break;case s:var l=D.P(7)||[];for(l=l.concat(D.O(10-l.length)||[]),n=new Uint8Array(l.length*m),t=0,a=l.length;t<a;++t){c=t;var u=l[t];n.set(u,c*m)}D.K(e,o,n);break;case o:if(D.I.has(e)&&(D.I.delete(e),n.length&&0==n.length%m))for(e=n.length/m,l=D.ba(),t=0;t<e;++t)if(c=t,c=n.subarray(c*m,(c+1)*m),!Y(c,D.G.ed25519.public)&&!D.l.has(c))if(D.b.has(c)||D.b.size<S)D.b.set(c,+new Date),D.fire("aware_of_nodes_count",D.b.size);else{if(!l.length)break;a=G(l),D.b.delete(a),D.b.set(c,+new Date),D.fire("aware_of_nodes_count",D.b.size)}}}).on("ready",function(){D.a.lookup(V(m)),D.a.lookup(V(m)),D.a.lookup(V(m)),D.fire("ready")}),this.c=q.Router(this.G.x25519.private,M).on("activity",function(e,t){var n=K([e,t]);D.j.has(n)||D.j.set(n,[e,t]),D.T(e),D.R.set(n,+new Date)}).on("send",function(e,t){D.K(e,r,t)}).on("data",function(e,r,s,o){var b,E,k=K([e,r]);switch(s){case a:var A=D.a.verify_announcement_message(o);if(!A)break;D.o.has(A)&&clearInterval(D.o.get(A)[2]),s=J(x,function(){D.j.has(k)&&D.a.publish_announcement_message(o)}),D.o.set(A,[e,r,s]),D.a.publish_announcement_message(o);break;case c:var S=o;if(S.length!==m)break;var P=function(t,n){var i,s=S,o=i=new Uint8Array(1+m+n.length*m);for(o.set([t]),o.set(s,1),t=0,s=n.length;t<s;++t){o=t;var a=n[t];i.set(a,1+m+o*m)}D.m(e,r,l,i)};D.a.find_introduction_nodes(S,function(e){e.length?P(T,e):P(C,[])},function(){P(C,[])});break;case u:var O=(s=[o.subarray(0,m),o.subarray(m,2*m),o.subarray(2*m,3*m),o.subarray(3*m)])[0],N=s[1];if(S=s[2],A=s[3],D.s.has(O))break;s=Z(w,function(){D.s.delete(O)}),D.s.set(O,[e,r,S,s]),D.K(N,i,function(e,t){var n=new Uint8Array(m+t.length);return n.set(e),n.set(t,m),n}(S,A));break;case d:A=(s=t(o))[0],O=s[1];var I=s[2];if(!D.s.has(O))break;N=(s=D.s.get(O))[0];var M=s[1];if(S=s[2],s=s[3],!n.verify(A,O,S))break;D.s.delete(O),clearTimeout(s),D.m(N,M,f,o),A=K([N,M]),D.H.set(k,[N,M]),D.H.set(A,[e,r]);break;case h:if(!D.g.has(k))break;var L=(s=D.g.get(k))[0];if(N=s[1],!D.i.has(L))break;var B=(s=D.i.get(L))[0];if(!s[3].has(N))break;try{A=(M=n.one_way_decrypt(B.x25519.private,o)).subarray(0,g);var z=M.subarray(g);s=[z.subarray(0,m),z.subarray(m,2*m),z.subarray(2*m,3*m),z.subarray(3*m,3*m+y),z.subarray(3*m+y,3*m+y+v),z.subarray(3*m+y+v,3*m+y+v+m)],S=s[0];var U=s[1];O=s[2],I=s[3];var q=s[4],F=s[5],j=b=new Uint8Array(m+z.length);if(j.set(N),j.set(z,m),n.verify(A,b,S)){var H=K([L,S]);if(!D.h.has(H)){if(D.f.has(H)){var W=D.f.get(H);if(W.L&&!W.u){var V=0;for(E=L.length;V<E;++V){var G=V,Y=L[V];if(Y!==S[G]){if(Y>S[G])return;W.u=!0;break}}}}else W={L:!1},D.f.set(H,W);o={real_public_key:L,target_id:S,secret:F,application:q,number_of_intermediate_nodes:null},D.fire("introduction",o).then(function(){var e=o.number_of_intermediate_nodes;if(!e)throw Error("Direct connections are not yet supported");if(e=D.V(e,[U])){e.push(U);var t=e[0];D.c.construct_routing_path(e).then(function(e){var r=n.Encryptor(!1,B.x25519.private);r.put_handshake_message(I);var i=r.get_handshake_message();D.v.set(H,r),D.W(L,S,t,e),D.f.delete(H),D.ea(L,S),e=n.sign(O,L,B.ed25519.private),D.S(L,S,d,function(e,t,n){var r=new Uint8Array(g+m+y);return r.set(e),r.set(t,g),r.set(n,g+m),r}(e,O,i))}).catch(function(e){Q(e),D.f.delete(H),W.L&&W.u&&D.fire("connection_failed",L,S,R)})}}).catch(function(e){Q(e),D.f.delete(H),W.L&&W.u&&D.fire("connection_failed",L,S,R)})}}}catch(e){Q(A=e)}break;case _:if(D.H.has(k))N=(s=D.H.get(k))[0],M=s[1],D.m(N,M,_,o);else if(D.g.has(k)&&(s=D.g.get(k),L=s[0],S=s[1],H=K([L,S]),s=D.v.get(H))&&(A=D.M.get(H)))for(s=s.decrypt(o),A.feed(s);A.have_more_data();)s=(N=A.get_data())[0],D.fire("data",L,S,s,N.subarray(1));break;case p:D.g.has(k)&&D.B.has(k)?D.B.delete(k):D.X(e,r)}}),this.ca=this.c.get_max_packet_data_size()-b}var V=F.random_bytes,G=F.pull_random_item_from_array,Y=F.are_arrays_equal,$=F.array2hex,X=F.hex2array,K=F.concat_arrays,Z=F.timeoutSet,J=F.intervalSet,Q=F.error_handler,ee=F.ArrayMap,te=F.ArraySet;return W.CONNECTION_ERROR_CANT_FIND_INTRODUCTION_NODES=O,W.CONNECTION_ERROR_NOT_ENOUGH_INTERMEDIATE_NODES=N,W.CONNECTION_ERROR_NO_INTRODUCTION_NODES=C,W.CONNECTION_ERROR_CANT_CONNECT_TO_RENDEZVOUS_NODE=R,W.CONNECTION_ERROR_OUT_OF_INTRODUCTION_NODES=I,W.CONNECTION_PROGRESS_CONNECTED_TO_RENDEZVOUS_NODE=M,W.CONNECTION_PROGRESS_FOUND_INTRODUCTION_NODES=L,W.CONNECTION_PROGRESS_INTRODUCTION_SENT=D,W.ANNOUNCEMENT_ERROR_NO_INTRODUCTION_NODES_CONNECTED=B,W.ANNOUNCEMENT_ERROR_NO_INTRODUCTION_NODES_CONFIRMED=z,W.ANNOUNCEMENT_ERROR_NOT_ENOUGH_INTERMEDIATE_NODES=U,W.prototype={start_bootstrap_node:function(e,t,n,r){null==n&&(n=e),null==r&&(r=t),this.a.start_bootstrap_node(e,t,n,r),this.F=!0,this.$()},get_bootstrap_nodes:function(){return this.a.get_bootstrap_nodes()},announce:function(e,t,r){if(this.F)return null;var i=(e=n.create_keypair(e)).ed25519.public;return this.i.has(i)?null:(this.i.set(i,[e,t,r,te()]),this.Y(i),i)},Y:function(e){function t(t){var n;if(t&&f.push(t),!--d)if(f.length){f=f.concat(h);var r=i.a.generate_announcement_message(e,o.ed25519.private,f),s=0;for(n=f.length;s<n;++s)t=f[s],i.S(e,t,a,r);i.fire("announced",e)}else i.U(e,1),i.fire("announcement_failed",e,z)}function n(n){var i,s=this;if(i=this.V(l,r.concat(h))){i.push(n);var o=i[0];this.c.construct_routing_path(i).then(function(r){s.W(e,n,o,r),u.add(n),t(n)}).catch(function(e){Q(e),t()})}else this.fire("announcement_failed",e,U)}var r,i=this,s=this.i.get(e),o=s[0],c=s[1],l=s[2],u=s[3],h=[];if(u.forEach(function(e){h.push(e)}),c-=h.length)if(this.U(e,+new Date),r=this.O(c,h)){var d=c,f=[];for(s=0,c=r.length;s<c;++s)n.call(this,r[s])}else this.U(e,1),this.fire("announcement_failed",e,B)},U:function(e,t){this.i.get(e)[4]=t},connect_to:function(r,i,s,o,a){function h(e){b.u||(d.f.delete(y),d.fire("connection_failed",p,i,e))}var d=this;if(this.F)return null;if(!a)throw Error("Direct connections are not yet supported");var _=n.create_keypair(r),p=_.ed25519.public;if(Y(p,i))return null;var y=K([p,i]);if(this.f.has(y))return p;var b={L:!0,u:!1};if(this.f.set(y,b),this.h.has(y))return null;if(!(r=this.V(a)))return h(N),null;var v=r[0],E=r[r.length-1];return this.c.construct_routing_path(r).then(function(r){function a(a,c,x,A){if(Y(v,a)&&Y(r,c)&&x===l){c=(a=function(e){var t,n=e[0],r=e.subarray(1,1+m),i=[],s=0;for(t=(e=e.subarray(1+m)).length/m;s<t;++s){var o=s;i.push(e.subarray(o*m,(o+1)*m))}return[n,r,i]}(A))[0],x=a[1];var S=a[2];Y(i,x)&&(clearTimeout(k),c!==T?h(c):(d.fire("connection_progress",p,i,L),function a(){function c(e,s,o,a){Y(v,e)&&Y(r,s)&&o===f&&(e=(o=t(a))[0],s=o[1],o=o[2],Y(s,A)&&n.verify(e,A,i)&&(T.put_handshake_message(o),d.v.set(y,T),clearTimeout(N),d.c.off("data",c),d.W(p,i,v,r),d.f.delete(y),d.ea(p,i)))}var l,k;if(!b.u)if(S.length){var x=G(S),A=V(m),P=n.convert_public_key(i),T=n.Encryptor(!0,P),C=T.get_handshake_message();C=e(p,E,A,C,s,o);var O=l=new Uint8Array(m+C.length);O.set(x),O.set(C,m),O=n.sign(l,p,_.ed25519.private),(l=k=new Uint8Array(C.length+g)).set(O),l.set(C,g),P=n.one_way_encrypt(P,k),d.c.on("data",c),d.m(v,r,u,function(e,t,n,r){var i=new Uint8Array(3*m+r.length);return i.set(e),i.set(t,m),i.set(n,2*m),i.set(r,3*m),i}(A,x,i,P)),d.fire("connection_progress",p,i,D);var N=Z(w,function(){d.c.off("data",c),T.destroy(),a()})}else h(I)}()))}}d.fire("connection_progress",p,i,M),d.c.on("data",a),d.m(v,r,c,i);var k=Z(w,function(){d.c.off("data",a),h(O)})}).catch(function(e){Q(e),h(R)}),p},get_max_data_size:function(){return this.J},send_to:function(e,t,n,r){var i,s,o,a=this;if(!this.F){var c=K([e,t]);if((i=this.v.get(c))&&!(r.length>this.J)&&(s=this.N.get(c))){var l=o=new Uint8Array(r.length+1);l.set([n]),l.set(r,1),s.feed(o),this.w.has(c)||this.w.set(c,setTimeout(function(){for(a.w.delete(c);s.have_more_blocks();){var n=s.get_block();n=i.encrypt(n),a.S(e,t,_,n)}}))}}},destroy:function(){this.ia||(this.F||this.$(),this.a.destroy(),this.ia=!0)},$:function(){var e=this;clearInterval(this.ha),clearInterval(this.la),clearInterval(this.ka),this.A.forEach(function(t,n){e.Z(n)}),this.j.forEach(function(t){e.fa(t[0],t[1])}),this.s.forEach(function(e){clearTimeout(e[3])}),this.c.destroy()},da:function(){return!this.F&&!!(this.b.size<S||this.ba(!0).length)},ba:function(e){null==e&&(e=!1);var t=[],n=+new Date-1e3*A,r=!1;return this.b.forEach(function(i,s){!r&&i<n&&(t.push(s),e&&!r&&(r=!0))}),t},ja:function(){var e,t;if(e=this.P(5)){var n=0;for(t=e.length;n<t;++n){var r=e[n];this.aa(r)}}},aa:function(e){this.I.add(e),this.K(e,s,new Uint8Array(0))},V:function(e,t){var n;null==t&&(t=[]);var r=null!=(n=this.P(1,t))?n[0]:void 0;return r&&(e=this.O(e-1,t.concat([r])))?[r].concat(e):null},P:function(e,t){var n,r,i=[];if(null==e&&(e=1),null==t&&(t=[]),!this.l.size)return this.a.lookup(V(m)),null;var s=Array.from(this.l.values()),o=0;for(r=(n=this.get_bootstrap_nodes()).length;o<r;++o){var a=n[o];t.push(X(a.node_id))}var c=te(t);if(!(s=s.filter(function(e){return!c.has(e)})).length)return null;for(o=0;o<e;++o)s.length&&i.push(G(s));return i},O:function(e,t){var n=[];if(this.b.size<e)return null;var r=Array.from(this.b.keys());if(t){var i=te(t);r=r.filter(function(e){return!i.has(e)})}if(r.length<e)return null;for(t=0;t<e;++t)n.push(G(r));return n},W:function(e,t,n,r){var i=K([n,r]);if(!this.g.has(i)){var s=K([e,t]);this.h.set(s,[n,r]),this.g.set(i,[e,t]),this.N.set(s,j.Multiplexer(this.J,this.ca)),this.M.set(s,j.Demultiplexer(this.J,this.ca)),this.fire("routing_paths_count",this.h.size)}},fa:function(e,t){var n=this,r=K([e,t]);if(this.j.has(r)&&(this.j.delete(r),this.c.destroy_routing_path(e,t),this.B.delete(r),this.o.forEach(function(e,t){var i=e[0],s=e[1];e=e[2],i=K([i,s]),Y(r,i)&&(clearInterval(e),n.o.delete(t))}),this.g.has(r))){e=(t=this.g.get(r))[0],t=t[1];var i=K([e,t]);if(this.g.delete(r),this.h.delete(i),this.w.has(i)&&(clearTimeout(this.w.get(i)),this.w.delete(i)),this.i.has(e)){var s=this.i.get(e)[3];s.delete(t)}(s=this.v.get(i))&&(s.destroy(),this.v.delete(i)),this.N.delete(i),this.M.delete(i),this.ma(e,t),this.fire("routing_paths_count",this.h.size)}},ea:function(e,t){var n=K([e,t]);this.D.add(n),this.fire("connected",e,t),this.fire("application_connections_count",this.D.size)},ma:function(e,t){var n=K([e,t]);this.D.has(n)&&(this.D.delete(n),this.fire("disconnected",e,t),this.fire("application_connections_count",this.D.size))},K:function(e,t,n){function r(o){Y(e,o)&&(clearTimeout(s),i.a.off("node_connected",r),i.T(e),i.a.send_data(e,t,n))}var i=this;if(this.l.has(e))this.T(e),this.a.send_data(e,t,n);else{this.a.on("node_connected",r);var s=Z(E,function(){i.a.off("node_connected",r)});this.a.lookup(e)}},S:function(e,t,n,r){e=K([e,t]),this.h.has(e)&&(e=(t=this.h.get(e))[0],t=t[1],this.m(e,t,n,r))},m:function(e,t,n,r){return 0===r.length&&(r=new Uint8Array(1)),this.c.send_data(e,t,n,r)},X:function(e,t){var n=K([e,t]);return!(this.B.has(n)||!this.j.has(n))&&(this.m(e,t,p,new Uint8Array(0)),!0)},T:function(e){this.A.has(e)||this.ga(e),this.A.set(e,+new Date)},ga:function(e){var t=this.C.get(e)||0;++t,this.C.set(e,t),1===t&&this.a.add_used_tag(e)},Z:function(e){var t;(t=this.C.get(e))&&(--t?this.C.set(e,t):(this.C.delete(e),this.a.del_used_tag(e)))}},W.prototype=Object.assign(Object.create(H.prototype),W.prototype),Object.defineProperty(W.prototype,"constructor",{value:W}),{ready:function(e){n.ready(function(){q.ready(function(){e()})})},generate_seed:function(){return V(m)},Core:W}}var r=0,i=1,s=2,o=3,a=0,c=1,l=2,u=3,h=4,d=5,f=6,_=7,p=8,m=32,g=64,y=48,b=16,v=64,w=30,E=10,k=60,x=600,A=300,S=1e3,P=30,T=0,C=1,O=2,N=3,R=4,I=5,M=0,L=1,D=2,B=0,z=1,U=2;"function"==typeof define&&define.amd?define("@detox/core",["@detox/crypto","@detox/transport","@detox/utils","fixed-size-multiplexer","async-eventer"],n):"object"==typeof exports?module.exports=n(require("@detox/crypto"),require("@detox/transport"),require("@detox/utils"),require("fixed-size-multiplexer"),require("async-eventer")):this.detox_core=n(this.detox_crypto,this.detox_transport,this.detox_utils,this.fixed_size_multiplexer,this.async_eventer)}.call(this),function(){function e(e){return new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat64(0,!1)}function t(e){var t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!1),t}function n(n,h,d,f){function _(t,n,d,p){var m=this;if(null==n&&(n=null),null==d&&(d=3),null==p&&(p=3),!(this instanceof _))return new _(t,n,d,p);f.call(this),this.g=t,this.m=n||g(u),this.A=h.create_keypair(this.m),this.o=this.A.ed25519.public,this.w=d,this.l=p,this.v=this.g.get_max_data_size(),this.c=A(),this.h=A(),this.i=A(),this.j=0,this.g.once("announced",function(e){!m.a&&m.b(e)&&m.fire("announced")}).on("connected",function(e,t){!m.a&&m.b(e)&&(m.c.add(t),m.fire("connected",t))}).on("connection_progress",function(e,t,n){!m.a&&m.b(e)&&m.fire("connection_progress",t,n)}).on("connection_failed",function(e,t,n){!m.a&&m.b(e)&&m.fire("connection_failed",t,n)}).on("disconnected",function(e,t){!m.a&&m.b(e)&&(m.c.delete(t),m.h.delete(t),m.i.delete(t),m.fire("disconnected",t))}).on("introduction",function(e){if(!m.a&&m.b(e.real_public_key)&&E(C,e.application.subarray(0,C.length)))return m.fire("introduction",e.target_id,e.secret,e.application).then(function(){e.number_of_intermediate_nodes=Math.max(m.l-1,1)})}).on("data",function(t,n,h,d){if(!m.a&&m.b(t)&&(h===i||h===s||m.s(n)))switch(h){case r:break;case i:if(d.length!==u)break;m.fire("secret",n,d).then(function(){m.i.add(n),m.f(n,s,new Uint8Array(0))}).catch(x);break;case s:if(!m.h.has(n))break;m.fire("secret_received",n);break;case o:m.fire("nickname",n,b(d),d);break;case a:if(9>d.length)break;h=e(t=d.subarray(0,8));var f=d.subarray(8,16);f=e(f),d=d.subarray(16),m.f(n,c,t),m.fire("text_message",n,h,f,b(d),d);break;case c:m.fire("text_message_received",n,e(d));break;default:h<l||m.fire("custom_command",n,h-l,d)}})}function p(e){var t=T(e).subarray(0,2);return S(k([e,t]))}function m(e){var t=P(e);if(e=t.subarray(0,-2),t=t.subarray(-2),!E(T(e).subarray(0,2),t))throw Error("Checksum is not correct");return e}var g=d.random_bytes,y=d.string2array,b=d.array2string,v=d.hex2array,w=d.array2hex,E=d.are_arrays_equal,k=d.concat_arrays,x=d.error_handler,A=d.ArraySet,S=d.base58_encode,P=d.base58_decode,T=h.blake2b_256,C=y("detox-chat-v0");return _.CONNECTION_ERROR_CANT_FIND_INTRODUCTION_NODES=n.CONNECTION_ERROR_CANT_FIND_INTRODUCTION_NODES,_.CONNECTION_ERROR_NOT_ENOUGH_INTERMEDIATE_NODES=n.CONNECTION_ERROR_NOT_ENOUGH_INTERMEDIATE_NODES,_.CONNECTION_ERROR_NO_INTRODUCTION_NODES=n.CONNECTION_ERROR_NO_INTRODUCTION_NODES,_.CONNECTION_ERROR_CANT_CONNECT_TO_RENDEZVOUS_POINT=n.CONNECTION_ERROR_CANT_CONNECT_TO_RENDEZVOUS_POINT,_.CONNECTION_ERROR_OUT_OF_INTRODUCTION_NODES=n.CONNECTION_ERROR_OUT_OF_INTRODUCTION_NODES,_.CONNECTION_PROGRESS_CONNECTED_TO_RENDEZVOUS_NODE=n.CONNECTION_PROGRESS_CONNECTED_TO_RENDEZVOUS_NODE,_.CONNECTION_PROGRESS_FOUND_INTRODUCTION_NODES=n.CONNECTION_PROGRESS_FOUND_INTRODUCTION_NODES,_.CONNECTION_PROGRESS_INTRODUCTION_SENT=n.CONNECTION_PROGRESS_INTRODUCTION_SENT,_.prototype={announce:function(){this.u||this.a||(this.u=!0,this.g.announce(this.m,this.w,Math.max(this.l-1,1)))},connect_to:function(e,t){this.a||this.c.has(e)||this.g.connect_to(this.m,e,C,t,this.l)},nickname:function(e,t){!this.a&&this.c.has(e)&&("string"==typeof t&&(t=y(t)),this.f(e,o,t))},secret:function(e,t){var n;!this.a&&this.c.has(e)&&((n=new Uint8Array(u)).set(t),this.h.add(e),this.f(e,i,n))},text_message:function(e,n,r){if(this.a||!this.c.has(e))return 0;if("string"==typeof r&&(r=y(r)),!r.length)return 0;var i=+new Date;return i<=this.j&&(i=this.j+1),(n=k([t(i),t(n),r])).length>this.v?0:(this.j=i,this.f(e,a,n),i)},custom_command:function(e,t,n){this.f(e,t+l,n)},destroy:function(){this.a||(this.a=!0)},b:function(e){return E(this.o,e)},s:function(e){return this.h.has(e)&&this.i.has(e)},f:function(e,t,n){this.g.send_to(this.o,e,t,n)}},_.prototype=Object.assign(Object.create(f.prototype),_.prototype),Object.defineProperty(_.prototype,"constructor",{value:_}),{ready:function(e){n.ready(function(){h.ready(function(){e()})})},Chat:_,generate_seed:function(){return g(u)},generate_secret:function(){return g(u)},id_encode:function(e,t){return p(k([e,t]))},id_decode:function(e){if((e=m(e)).length<u||e.length>2*u)throw Error("Incorrect ID");return[e.subarray(0,u),e.subarray(u)]},bootstrap_node_encode:function(e,t,n){return p(k([v(e),y(t),new Uint8Array(Uint16Array.of(n).buffer)]))},bootstrap_node_decode:function(e){var t=m(e);if(t.length<u+1+2)throw Error("Incorrect bootstrap node information");return[e=w(t.subarray(0,u)),b(t.subarray(u,-2)),t=new Uint16Array(t.slice(-2).buffer)[0]]}}}var r=0,i=1,s=2,o=3,a=4,c=5,l=64,u=32;"function"==typeof define&&define.amd?define("@detox/chat",["@detox/core","@detox/crypto","@detox/utils","async-eventer"],n):"object"==typeof exports?module.exports=n(require("@detox/core"),require("@detox/crypto"),require("@detox/utils"),require("async-eventer")):this.detox_chat=n(this.detox_core,this.detox_crypto,this.detox_utils,this.async_eventer)}.call(this),function(e,t){if("function"==typeof define&&define.amd)define("autosize",["module","exports"],t);else if("undefined"!=typeof exports)t(module,exports);else{var n={exports:{}};t(n,n.exports),e.autosize=n.exports}}(this,function(e,t){"use strict";var n,r,i="function"==typeof Map?new Map:(n=[],r=[],{has:function(e){return-1<n.indexOf(e)},get:function(e){return r[n.indexOf(e)]},set:function(e,t){-1===n.indexOf(e)&&(n.push(e),r.push(t))},delete:function(e){var t=n.indexOf(e);-1<t&&(n.splice(t,1),r.splice(t,1))}}),s=function(e){return new Event(e,{bubbles:!0})};try{new Event("test")}catch(e){s=function(e){var t=document.createEvent("Event");return t.initEvent(e,!0,!1),t}}function o(e){var t=i.get(e);t&&t.destroy()}function a(e){var t=i.get(e);t&&t.update()}var c=null;"undefined"==typeof window||"function"!=typeof window.getComputedStyle?((c=function(e){return e}).destroy=function(e){return e},c.update=function(e){return e}):((c=function(e,t){return e&&Array.prototype.forEach.call(e.length?e:[e],function(e){return function(e){if(e&&e.nodeName&&"TEXTAREA"===e.nodeName&&!i.has(e)){var t,n=null,r=null,o=null,a=function(){e.clientWidth!==r&&h()},c=function(t){window.removeEventListener("resize",a,!1),e.removeEventListener("input",h,!1),e.removeEventListener("keyup",h,!1),e.removeEventListener("autosize:destroy",c,!1),e.removeEventListener("autosize:update",h,!1),Object.keys(t).forEach(function(n){e.style[n]=t[n]}),i.delete(e)}.bind(e,{height:e.style.height,resize:e.style.resize,overflowY:e.style.overflowY,overflowX:e.style.overflowX,wordWrap:e.style.wordWrap});e.addEventListener("autosize:destroy",c,!1),"onpropertychange"in e&&"oninput"in e&&e.addEventListener("keyup",h,!1),window.addEventListener("resize",a,!1),e.addEventListener("input",h,!1),e.addEventListener("autosize:update",h,!1),e.style.overflowX="hidden",e.style.wordWrap="break-word",i.set(e,{destroy:c,update:h}),"vertical"===(t=window.getComputedStyle(e,null)).resize?e.style.resize="none":"both"===t.resize&&(e.style.resize="horizontal"),n="content-box"===t.boxSizing?-(parseFloat(t.paddingTop)+parseFloat(t.paddingBottom)):parseFloat(t.borderTopWidth)+parseFloat(t.borderBottomWidth),isNaN(n)&&(n=0),h()}function l(t){var n=e.style.width;e.style.width="0px",e.offsetWidth,e.style.width=n,e.style.overflowY=t}function u(){if(0!==e.scrollHeight){var t=function(e){for(var t=[];e&&e.parentNode&&e.parentNode instanceof Element;)e.parentNode.scrollTop&&t.push({node:e.parentNode,scrollTop:e.parentNode.scrollTop}),e=e.parentNode;return t}(e),i=document.documentElement&&document.documentElement.scrollTop;e.style.height="",e.style.height=e.scrollHeight+n+"px",r=e.clientWidth,t.forEach(function(e){e.node.scrollTop=e.scrollTop}),i&&(document.documentElement.scrollTop=i)}}function h(){u();var t=Math.round(parseFloat(e.style.height)),n=window.getComputedStyle(e,null),r="content-box"===n.boxSizing?Math.round(parseFloat(n.height)):e.offsetHeight;if(r!==t?"hidden"===n.overflowY&&(l("scroll"),u(),r="content-box"===n.boxSizing?Math.round(parseFloat(window.getComputedStyle(e,null).height)):e.offsetHeight):"hidden"!==n.overflowY&&(l("hidden"),u(),r="content-box"===n.boxSizing?Math.round(parseFloat(window.getComputedStyle(e,null).height)):e.offsetHeight),o!==r){o=r;var i=s("autosize:resized");try{e.dispatchEvent(i)}catch(t){}}}}(e)}),e}).destroy=function(e){return e&&Array.prototype.forEach.call(e.length?e:[e],o),e},c.update=function(e){return e&&Array.prototype.forEach.call(e.length?e:[e],a),e}),t.default=c,e.exports=t.default});var _extends=Object.assign||function(e){for(var t,n=1;n<arguments.length;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},SwipeListener=function(e,t){if(e){"undefined"!=typeof window&&function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}"function"!=typeof window.CustomEvent&&(e.prototype=window.Event.prototype,window.CustomEvent=e)}(),t||(t={}),t=_extends({},{minHorizontal:10,minVertical:10,deltaHorizontal:3,deltaVertical:5,preventScroll:!1,lockAxis:!0},t);var n=[],r=!1,i=function(){r=!0};e.addEventListener("mousedown",i);var s=function(e){r=!1,a(e)};e.addEventListener("mouseup",s);var o=function(e){r&&(e.changedTouches=[{clientX:e.clientX,clientY:e.clientY}],c(e))};e.addEventListener("mousemove",o);var a=function(){var r=Math.abs,i=Math.max,s=Math.min;if(n.length){for(var o=[],a=[],c={top:!1,right:!1,bottom:!1,left:!1},l=0;l<n.length;l++)o.push(n[l].x),a.push(n[l].y);var u=o[0],h=o[o.length-1],d=a[0],f=a[a.length-1],_={x:[u,h],y:[d,f]};if(1<n.length){var p=new CustomEvent("swiperelease",{detail:_});e.dispatchEvent(p)}var m=o[0]-o[o.length-1],g="none";g=0<m?"left":"right";var y=s.apply(Math,o),b=i.apply(Math,o);if(r(m)>=t.minHorizontal&&("left"==g?r(y-o[o.length-1])<=t.deltaHorizontal&&(c.left=!0):"right"==g&&(r(b-o[o.length-1])<=t.deltaHorizontal&&(c.right=!0))),g="none",g=0<(m=a[0]-a[a.length-1])?"top":"bottom",y=s.apply(Math,a),b=i.apply(Math,a),r(m)>=t.minVertical&&("top"==g?r(y-a[a.length-1])<=t.deltaVertical&&(c.top=!0):"bottom"==g&&(r(b-a[a.length-1])<=t.deltaVertical&&(c.bottom=!0))),n=[],c.top||c.right||c.bottom||c.left){t.lockAxis&&((c.left||c.right)&&r(u-h)>r(d-f)?c.top=c.bottom=!1:(c.top||c.bottom)&&r(u-h)<r(d-f)&&(c.left=c.right=!1));var v={detail:_extends({directions:c},_)},w=new CustomEvent("swipe",v);e.dispatchEvent(w)}else{var E=new CustomEvent("swipecancel",{detail:_});e.dispatchEvent(E)}}},c=function(r){t.preventScroll&&r.preventDefault();var i=r.changedTouches[0];if(n.push({x:i.clientX,y:i.clientY}),1<n.length){var s=n[0].x,o=n[n.length-1].x,a=n[0].y,c=n[n.length-1].y,l=new CustomEvent("swiping",{detail:{x:[s,o],y:[a,c]}});e.dispatchEvent(l)}},l=!1;try{var u=Object.defineProperty({},"passive",{get:function(){l={passive:!t.preventScroll}}});window.addEventListener("testPassive",null,u),window.removeEventListener("testPassive",null,u)}catch(e){}return e.addEventListener("touchmove",c,l),e.addEventListener("touchend",a),{off:function(){e.removeEventListener("touchmove",c,l),e.removeEventListener("touchend",a),e.removeEventListener("mousedown",i),e.removeEventListener("mouseup",s),e.removeEventListener("mousemove",o)}}}};"undefined"!=typeof module&&void 0!==module.exports?module.exports=SwipeListener:"function"==typeof define&&define.amd?define("swipe-listener",[],function(){return SwipeListener}):window.SwipeListener=SwipeListener,function(){var e;function t(e){var t,n;function r(e){if(!(this instanceof r))return new r(e);this.array=e}for(r.prototype.clone=function(){return r(this.array.slice())},t=0,n=e.length;t<n;++t)i.call(this,t,e[t]);return r;function i(e,t){Object.defineProperty(r.prototype,t,{get:function(){return this.array[e]},set:function(t){this.array[e]=t}})}}function n(e,t,n,r){if(e.size<t+n)throw new Error;return e=e.slice(t,t+n),new Promise(function(t){var n;switch((n=new FileReader).onload=function(){t(n.result)},r){case"buffer":n.readAsArrayBuffer(e);break;case"string":n.readAsText(e)}})}e=1,define("js/state",["@detox/chat","@detox/utils","async-eventer"],function(r,i,s){var o,a,c,l,u,h,d,f,_,p,m;function g(t){var n,r,i,o,a,u,h,p,y,b,v,w,E,k=this;if(!(this instanceof g))return new g(t);s.call(this),this._chat_id=t,n=t+"-backup",r=!1,this._state=(w=localStorage.getItem(n))?(r=!0,JSON.parse(w)):(E=localStorage.getItem(t))?JSON.parse(E):Object.create(null),this._local_state={online:!1,announced:!1,connected_nodes_count:0,aware_of_nodes_count:0,routing_paths_count:0,application_connections_count:0,messages:c(),ui:{active_contact:null,sidebar_shown:!0},online_contacts:l(),contacts_with_pending_messages:l(),contacts_with_unread_messages:l()},i=r?new Promise(function(t){var r;(r=indexedDB.open(n,e)).onsuccess=function(e){k._backup_database=e.target.result,t()},r.onerror=function(e){console.error("Opening backup messages database failed",e),detox_chat_app.notify_error("An error happened during opening backup messages database, restoring from backup canceled, please restart"),localStorage.removeItem(n),indexedDB.deleteDatabase(n)}}):Promise.resolve(),this._database_ready=i.then(function(){return new Promise(function(n){var i;r&&indexedDB.deleteDatabase(t),(i=indexedDB.open(t,e)).onsuccess=function(e){k._database=e.target.result,n()},i.onerror=function(e){console.error("Opening messages database failed",e),detox_chat_app.notify_error("An error happened during opening messages database")},i.onupgradeneeded=function(e){k._database=e.target.result,k._database.createObjectStore("messages",{keyPath:"message_id",autoIncrement:!0}).createIndex("contact_id","contact_id")}})}).then(function(){if(r)return new Promise(function(e){var t,n;(t=n=k._backup_database.transaction("messages","readwrite")).oncomplete=function(){k._backup_database.close(),e()},t.onerror=function(e){console.error("Messages transaction failed",e)},n.objectStore("messages").openCursor().onsuccess=function(e){var t,n;(t=e.target.result)&&(n=t.value,k._messages_transaction(function(e){e.put(n)}),t.continue())}})}),this._messages_transactions=this._database_ready,"version"in this._state||((o=this._state).version=e,o.nickname="",o.seed=null,o.settings=JSON.parse(JSON.stringify(g.DEFAULT_SETTINGS)),o.contacts=[[[6,148,79,1,76,156,177,211,195,184,108,220,189,121,140,15,134,174,141,222,146,77,20,115,211,253,148,149,128,147,190,125],"Fake contact #1",0,0,null,null,null],[[6,148,79,1,76,156,177,211,195,184,108,220,189,121,140,15,134,174,141,222,146,77,20,115,211,253,148,149,128,147,190,126],"Fake contact #2",0,0,null,null,null]],o.contacts_requests=[],o.contacts_requests_blocked=[],o.secrets=[],setTimeout(function(){k.add_contact_message(k.get_contacts()[0].id,g.MESSAGE_ORIGIN_RECEIVED,+new Date,+new Date,"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."),k.add_contact_message(k.get_contacts()[0].id,g.MESSAGE_ORIGIN_SENT,+new Date,+new Date,"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.")})),this._state.seed&&(this._state.seed=Uint8Array.from(this._state.seed)),this._ready=Promise.all([this._database_ready,new Promise(function(e){k._state.seed?e():k._ready_resolve=e})]),r&&this._ready.then(function(){localStorage.removeItem(n),indexedDB.deleteDatabase(n),detox_chat_app.notify_success("Restoration from backup finished successfully!",5)}),this._state.contacts=c(function(){var e,t,n,r=[];for(e=0,n=(t=this._state.contacts).length;e<n;++e)(a=t[e])[0]=Uint8Array.from(a[0]),a[4]=a[4]&&Uint8Array.from(a[4]),a[5]=a[5]&&Uint8Array.from(a[5]),a[6]=a[6]&&Uint8Array.from(a[6]),a=d(a),r.push([a.id,a]);return r}.call(this)),this._state.contacts_requests=c(function(){var e,t,n,r=[];for(e=0,n=(t=this._state.contacts_requests).length;e<n;++e)(a=t[e])[0]=Uint8Array.from(a[0]),a=f(a),r.push([a.id,a]);return r}.call(this)),u=+new Date,this._state.contacts_requests_blocked=c(function(){var e,t,n,r=[];for(e=0,n=(t=this._state.contacts_requests_blocked).length;e<n;++e)(a=t[e]).blocked_until>u&&(a[0]=Uint8Array.from(a[0]),a=_(a),r.push([a.id,a]));return r}.call(this)),this._state.secrets=c(function(){var e,t,n,r=[];for(e=0,n=(t=this._state.secrets).length;e<n;++e)(h=t[e])[0]=Uint8Array.from(h[0]),h=m(h),r.push([h.secret,h]);return r}.call(this));for(p=0,b=(y=Array.from(this._state.contacts.keys())).length;p<b;++p)v=y[p],this._update_contact_with_pending_messages(v),this._update_contact_with_unread_messages(v)}return o=r.id_encode,a=i.are_arrays_equal,c=i.ArrayMap,l=i.ArraySet,u=Object.create(null),g.prototype={ready:function(e){return e&&this._ready.then(e),Boolean(this._state.seed)},get_as_blob:function(){var e=this;return Promise.all(function(){var e,t,n,r=[];for(e=0,n=(t=this.get_contacts()).length;e<n;++e)r.push(i.call(this,t[e]));return r;function i(e){return this._messages_transaction(function(t,n){t.index("contact_id").getAll(IDBKeyRange.only(e.id)).onsuccess=function(e){var t;t=(t=e.target.result).map(function(e){return[e.message_id,e.origin,e.date_written,e.date_sent,e.text]}),n(new Blob([JSON.stringify(t)]))}})}}.call(this)).then(function(t){var n,r,i;return n=e._serialize_state(),r=JSON.stringify([n.length].concat(t.map(function(e){return e.size}))),i=new ArrayBuffer(4),new DataView(i).setUint32(0,r.length,!1),new Blob([i,r,n].concat(t))})},set_from_blob:function(t){var r,i;i=this._chat_id+"-backup",localStorage.removeItem(i),indexedDB.deleteDatabase(i),n(t,0,4,"buffer").then(function(e){var r;return r=new DataView(e).getUint32(0,!1),n(t,4,r,"string")}).then(function(s){var o,a;if(o=s.length,a=(s=JSON.parse(s)).reduce(function(e,t){return e+t}),t.size!==4+o+a)throw Error;return n(t,4+o,s[0],"string").then(function(t){if(JSON.parse(t).version>e)throw detox_chat_app.notify_error("Restoration from backup created by newer version is not supported, upgrade first",5),new Error;return localStorage.setItem(i,t)}).then(function(){var e,a;return r=g(i),e=4+o+s[0],a=r.get_contacts().map(function(t,n){var r,i;return r=e,i=s[n+1],e+=i,[t.id,r,i]}),function e(){var i,s,o,c;if(i=a.shift())return s=i[0],o=i[1],c=i[2],n(t,o,c,"string").then(function(e){return r._messages_transaction(function(t){var n,r,i,o;for(n=0,i=(r=JSON.parse(e)).length;n<i;++n)o=r[n],t.put({contact_id:s,message_id:o[0],origin:o[1],date_written:o[2],date_sent:o[3],text:o[4]})})}).then(function(){return e()})}()})}).then(function(){detox_chat_app.notify_warning("Restoration from backup is almost done, restart is needed to finish the process")}).catch(function(){var e;console.error.apply(console,arguments),localStorage.removeItem(i),r&&null!=(e=r._database)&&e.close(),indexedDB.deleteDatabase(i),detox_chat_app.notify_error("Restoration from backup failed, make sure you have selected correct backup file and try again",5)})},delete_data:function(){this._deleted||(localStorage.removeItem(this._chat_id),this._database.close(),indexedDB.deleteDatabase(this._chat_id),this._deleted=!0)},_serialize_state:function(){var e,t,n,r,i,s,o,a,c,l,u,h,d;for(t in e={},n=this._state)switch(r=n[t],t){case"seed":e[t]=Array.from(r);break;case"contacts":case"contacts_requests":case"contacts_requests_blocked":case"secrets":for(i=[],s=0,a=(o=Array.from(r.values())).length;s<a;++s){for(u=0,h=(l=(c=o[s]).array.slice()).length;u<h;++u)d=u,(c=l[u])instanceof Uint8Array&&(l[d]=Array.from(c));i.push(l)}e[t]=i;break;default:e[t]=r}return JSON.stringify(e)},_save_state:function(){this._deleted||localStorage.setItem(this._chat_id,this._serialize_state())},get_seed:function(){return this._state.seed},set_seed:function(e){var t;t=this._state.seed,this._state.seed=e,this._ready_resolve&&(this._ready_resolve(),delete this._ready_resolve),this.fire("seed_changed",e,t),this._save_state()},get_nickname:function(){return this._state.nickname},set_nickname:function(e){var t,n;t=this._state.nickname,n=String(e),this._state.nickname=n,this.fire("nickname_changed",n,t),this._save_state()},get_online:function(){return this._local_state.online},set_online:function(e){var t,n;t=this._local_state.online,n=!!e,this._local_state.online=n,this.fire("online_changed",n,t)},get_announced:function(){return this._local_state.announced},set_announced:function(e){var t,n;t=this._local_state.announced,n=!!e,this._local_state.announced=n,this.fire("announced_changed",n,t)},get_connected_nodes_count:function(){return this._local_state.connected_nodes_count},set_connected_nodes_count:function(e){this._local_state.connected_nodes_count=e,this.fire("connected_nodes_count_changed",e)},get_aware_of_nodes_count:function(){return this._local_state.aware_of_nodes_count},set_aware_of_nodes_count:function(e){this._local_state.aware_of_nodes_count=e,this.fire("aware_of_nodes_count_changed",e)},get_routing_paths_count:function(){return this._local_state.routing_paths_count},set_routing_paths_count:function(e){this._local_state.routing_paths_count=e,this.fire("routing_paths_count_changed",e)},get_application_connections_count:function(){return this._local_state.application_connections_count},set_application_connections_count:function(e){this._local_state.application_connections_count=e,this.fire("application_connections_count_changed",e)},get_ui_active_contact:function(){return this._local_state.ui.active_contact},set_ui_active_contact:function(e){var t;t=this._local_state.ui.active_contact,this._local_state.ui.active_contact=e,this.fire("ui_active_contact_changed",e,t),e&&(this._update_contact_last_read_message(e),this._update_contact_with_unread_messages(e))},get_ui_sidebar_shown:function(){return this._local_state.ui.sidebar_shown},set_ui_sidebar_shown:function(e){var t;t=this._local_state.ui.sidebar_shown,this._local_state.ui.sidebar_shown=e,this.fire("ui_sidebar_shown_changed",e,t)},get_settings_announce:function(){return this._state.settings.announce},set_settings_announce:function(e){var t,n;t=this._state.settings.announce,n=!!e,this._state.settings.announce=n,this.fire("settings_announce_changed",n,t),this._save_state()},get_settings_block_contact_requests_for:function(){return this._state.settings.block_contact_requests_for},set_settings_block_contact_requests_for:function(e){var t;return t=this._state.settings.block_contact_requests_for,this._state.settings.block_contact_requests_for=parseInt(e),this.fire("settings_block_contact_requests_for_changed",e,t),this._save_state()},get_settings_bootstrap_nodes:function(){return this._state.settings.bootstrap_nodes},set_settings_bootstrap_nodes:function(e){var t;t=this._state.settings.bootstrap_nodes,this._state.settings.bootstrap_nodes=e,this.fire("settings_bootstrap_nodes_changed",e,t),this._save_state()},get_settings_bucket_size:function(){return this._state.settings.bucket_size},set_settings_bucket_size:function(e){var t;t=this._state.bucket_size,this._state.settings.bucket_size=parseInt(e),this.fire("settings_bucket_size_changed",e,t),this._save_state()},get_settings_experience:function(){return this._state.settings.experience},set_settings_experience:function(e){var t;t=this._state.experience,this._state.settings.experience=parseInt(e),this.fire("settings_experience_changed",e,t),this._save_state()},get_settings_help:function(){return this._state.settings.help},set_settings_help:function(e){var t,n;t=this._state.settings.help,n=!!e,this._state.settings.help=n,this.fire("settings_help_changed",n,t),this._save_state()},get_settings_ice_servers:function(){return this._state.settings.ice_servers},set_settings_ice_servers:function(e){var t;t=this._state.settings.ice_servers,this._state.settings.ice_servers=e,this.fire("settings_ice_servers_changed",e,t),this._save_state()},get_settings_max_pending_segments:function(){return this._state.settings.max_pending_segments},set_settings_max_pending_segments:function(e){var t;t=this._state.max_pending_segments,this._state.settings.max_pending_segments=parseInt(e),this.fire("settings_max_pending_segments_changed",e,t),this._save_state()},get_settings_number_of_intermediate_nodes:function(){return this._state.settings.number_of_intermediate_nodes},set_settings_number_of_intermediate_nodes:function(e){var t;t=this._state.number_of_intermediate_nodes,this._state.settings.number_of_intermediate_nodes=parseInt(e),this.fire("settings_number_of_intermediate_nodes_changed",e,t),this._save_state()},get_settings_number_of_introduction_nodes:function(){return this._state.settings.number_of_introduction_nodes},set_settings_number_of_introduction_nodes:function(e){var t;t=this._state.number_of_introduction_nodes,this._state.settings.number_of_introduction_nodes=parseInt(e),this.fire("settings_number_of_introduction_nodes_changed",e,t),this._save_state()},get_settings_online:function(){return this._state.settings.online},set_settings_online:function(e){var t,n;t=this._state.online,n=!!e,this._state.settings.online=n,this.fire("settings_online_changed",n,t),this._save_state()},get_settings_packets_per_second:function(){return this._state.settings.packets_per_second},set_settings_packets_per_second:function(e){var t;t=this._state.packets_per_second,this._state.settings.packets_per_second=parseInt(e),this.fire("settings_packets_per_second_changed",e,t),this._save_state()},get_settings_reconnects_intervals:function(){return this._state.settings.reconnects_intervals},set_settings_reconnects_intervals:function(e){var t;t=this._state.reconnects_intervals,this._state.settings.reconnects_intervals=e,this.fire("settings_reconnects_intervals_changed",e,t),this._save_state()},get_settings_send_ctrl_enter:function(){return this._state.settings.send_ctrl_enter},set_settings_send_ctrl_enter:function(e){var t,n;t=this._state.send_ctrl_enter,n=!!e,this._state.settings.send_ctrl_enter=n,this.fire("settings_send_ctrl_enter_changed",n,t),this._save_state()},get_contacts:function(){return Array.from(this._state.contacts.values())},get_contacts_with_pending_messages:function(){return Array.from(this._local_state.contacts_with_pending_messages.values())},get_contacts_with_unread_messages:function(){return Array.from(this._local_state.contacts_with_unread_messages.values())},get_contact:function(e){return this._state.contacts.get(e)},add_contact:function(e,t,n){var r;this.has_contact(e)||((t=t.trim())||(t=o(e,new Uint8Array(0))),r=d([e,t,0,0,n,null,null]),this._state.contacts.set(e,r),this.fire("contact_added",r),this.fire("contacts_changed"),this._save_state())},has_contact:function(e){return this._state.contacts.has(e)},_set_contact:function(e,t){var n,r,i,s;if(n=this.get_contact(e)){for(i in r=n.clone(),t)s=t[i],r[i]=s;this._state.contacts.set(e,r),this.fire("contact_changed",r,n),this.fire("contacts_changed"),this._save_state()}},set_contact_nickname:function(e,t){t||(t=o(e,new Uint8Array(0))),this._set_contact(e,{nickname:t})},set_contact_remote_secret:function(e,t){this._set_contact(e,{remote_secret:t})},set_contact_local_secret:function(e,t){var n,r;(n=this.get_contact(e))&&(r=n.old_local_secret||n.local_secret,this._set_contact(e,{old_local_secret:r,local_secret:t}))},_update_contact_last_active:function(e){this._set_contact(e,{last_time_active:+new Date})},_update_contact_last_read_message:function(e){this._set_contact(e,{last_read_message:+new Date})},del_contact_old_local_secret:function(e){this._set_contact(e,{old_local_secret:null})},del_contact:function(e){var t,n=this;(t=this.get_contact(e))&&(a(this.get_ui_active_contact()||new Uint8Array(0),e)&&this.set_ui_active_contact(null),this.del_contact_messages(e).then(function(){n._state.contacts.delete(e),n.fire("contact_deleted",t),n._update_contact_with_pending_messages(),n._update_contact_with_unread_messages(),n.fire("contacts_changed"),n._save_state()}))},get_contacts_requests:function(){return Array.from(this._state.contacts_requests.values())},add_contact_request:function(e,t){var n,r,i;this.has_contact_request(e)||(n=this._state.secrets.get(t).name,r=this.get_settings_experience>=g.EXPERIENCE_ADVANCED?o(e,new Uint8Array(0)):o(e,t),i=f([e,r,n]),this._state.contacts_requests.set(e,i),this.fire("contact_request_added",i),this.fire("contacts_requests_changed"),this._save_state())},has_contact_request:function(e){return this._state.contacts_requests.has(e)},del_contact_request:function(e){var t,n;(t=this._state.contacts_requests.get(e))&&(this._state.contacts_requests.delete(e),n=new Date+this.get_settings_block_contact_requests_for(),this._state.contacts_requests_blocked.set(e,_([e,n])),this.fire("contact_request_deleted",t),this.fire("contacts_requests_changed"),this._save_state())},get_contacts_requests_blocked:function(){return Array.from(this._state.contacts_requests_blocked.values())},has_contact_request_blocked:function(e){var t;return!!((t=this._state.contacts_requests_blocked.get(e))&&t.blocked_until>+new Date)||this._state.contacts_requests_blocked.delete(e)},get_online_contacts:function(){return Array.from(this._local_state.online_contacts)},add_online_contact:function(e){this._local_state.online_contacts.add(e),this.fire("contact_online",e),this.fire("online_contacts_changed"),this._update_contact_last_active(e)},has_online_contact:function(e){return this._local_state.online_contacts.has(e)},del_online_contact:function(e){this._local_state.online_contacts.delete(e),this.fire("contact_offline",e),this.fire("online_contacts_changed"),this._update_contact_last_active(e)},_update_contact_with_pending_messages:function(e){var t=this;this.get_contact_messages(e).then(function(n){var r,i;for(r=n.length-1;r>=0;--r)if((i=n[r]).origin===g.MESSAGE_ORIGIN_SENT&&!i.date_sent)return void(t._local_state.contacts_with_pending_messages.has(e)||(t._local_state.contacts_with_pending_messages.add(e),t.fire("contacts_with_pending_messages_changed")));t._local_state.contacts_with_pending_messages.delete(e),t.fire("contacts_with_pending_messages_changed")})},_update_contact_with_unread_messages:function(e){var t,n=this;t=this.get_contact(e).last_read_message,this.get_contact_messages(e).then(function(r){var i,s,o;for(i=0,s=r.length;i<s;++i)if((o=r[i]).origin===g.MESSAGE_ORIGIN_RECEIVED&&o.date_sent>t)return void(n._local_state.contacts_with_unread_messages.has(e)||(n._local_state.contacts_with_unread_messages.add(e),n.fire("contacts_with_unread_messages_changed")));n._local_state.contacts_with_unread_messages.delete(e),n.fire("contacts_with_unread_messages_changed")})},get_contact_messages:function(e){var t=this;return this._messages_transactions.then(function(){return t._local_state.messages.get(e)||t._messages_transaction(function(t,n){t.index("contact_id").getAll(IDBKeyRange.only(e)).onsuccess=function(e){n(e.target.result)}}).then(function(n){return n=n.map(function(e){return p([e.message_id,e.origin,e.date_written,e.date_sent,e.text])}),t._local_state.messages.set(e,n),n})})},get_contact_messages_to_be_sent:function(e){return this.get_contact_messages(e).then(function(e){return e.filter(function(e){return e.origin===g.MESSAGE_ORIGIN_SENT&&!e.date_sent})})},add_contact_message:function(e,t,n,r,i){var s=this;return this._messages_transaction(function(s,o){s.add({contact_id:e,origin:t,date_written:n,date_sent:r,text:i}).onsuccess=function(e){o(e.target.result)}}).then(function(o){var c;return c=p([o,t,n,r,i]),s._local_state.messages.delete(e),t===g.MESSAGE_ORIGIN_RECEIVED?(s._update_contact_last_active(e),a(s.get_ui_active_contact()||new Uint8Array(0),e)?s._update_contact_last_read_message(e):s._update_contact_with_unread_messages(e)):s._update_contact_with_pending_messages(e),s.fire("contact_message_added",e,c),s.fire("contact_messages_changed",e),o})},set_contact_message_sent:function(e,t,n){var r=this;this.get_contact_messages(e).then(function(i){var s,o;for(s=i.length-1;s>=0;--s)if((o=i[s]).id===t){o.date_sent=n,r._messages_transaction(a).then(c);break}function a(n){n.put({message_id:t,contact_id:e,origin:o.origin,date_written:o.date_written,date_sent:o.date_sent,text:o.text})}function c(){return r._update_contact_with_pending_messages(e),r.fire("contact_messages_changed",e)}})},del_contact_messages:function(e){var t=this;return this._messages_transaction(function(t){t.index("contact_id").openCursor(IDBKeyRange.only(e)).onsuccess=function(e){var t;(t=e.target.result)&&(t.delete(),t.continue())}}).then(function(){t._local_state.messages.delete(e),t.fire("contact_messages_changed",e)})},_messages_transaction:function(e){var t=this;return this._messages_transactions=this._messages_transactions.then(function(){return new Promise(function(n,r){var i,s,o;(s=o=t._database.transaction("messages","readwrite")).oncomplete=function(){n(i)},s.onerror=function(e){console.error("Messages transaction failed",e),r()},e(o.objectStore("messages"),function(e){i=e})})})},get_secrets:function(){return Array.from(this._state.secrets.values())},add_secret:function(e,t){var n;n=m([e,t]),this._state.secrets.set(n.secret,n),this.fire("secret_added",n),this.fire("secrets_changed"),this._save_state()},set_secret_name:function(e,t){var n;(n=this._state.secrets.get(e).clone()).name=t,this._state.secrets.set(e,n),this.fire("secrets_changed"),this._save_state()},set_secrets:function(e){this._state.secrets=e,this.fire("secrets_changed"),this._save_state()},del_secret:function(e){var t;(t=this._state.secrets.get(e))&&(this._state.secrets.delete(e),this.fire("secret_deleted",t),this.fire("secrets_changed"),this._save_state())}},g.prototype=Object.assign(Object.create(s.prototype),g.prototype),Object.defineProperty(g.prototype,"constructor",{value:g}),h={EXPERIENCE_REGULAR:0,EXPERIENCE_ADVANCED:1,EXPERIENCE_DEVELOPER:2,MESSAGE_ORIGIN_SENT:0,MESSAGE_ORIGIN_RECEIVED:1,MESSAGE_ORIGIN_SERVICE:2},Object.assign(g,h),Object.assign(g.prototype,h),g.DEFAULT_SETTINGS={announce:!0,block_contact_requests_for:2592e3,bootstrap_nodes:[{node_id:"50da72d1fe105c649a1c16c085627b368196e258667d2a2fc02d4b8af7182651",host:"0-testnet-bootstrap.detox.technology",port:443},{node_id:"252223a2ae1d325578d8cd2f0d65dada5d342927cfbbf8dbfd9edc3e247b5a0b",host:"1-testnet-bootstrap.detox.technology",port:443},{node_id:"e9a374b6aa204a48c40a9679a636319b029fa4e68ee29dbd7da9326ea681b91d",host:"2-testnet-bootstrap.detox.technology",port:443}],bucket_size:2,experience:g.EXPERIENCE_REGULAR,help:!0,ice_servers:[{urls:"stun:stun.l.google.com:19302"},{urls:"turn:0-testnet-turn.detox.technology",username:"detox-user",credential:"pwd"}],max_pending_segments:10,number_of_intermediate_nodes:3,number_of_introduction_nodes:3,online:!0,packets_per_second:5,reconnects_intervals:[[5,30],[10,60],[15,150],[100,300],[Number.MAX_SAFE_INTEGER,600]],send_ctrl_enter:!0},d=t(["id","nickname","last_time_active","last_read_message","remote_secret","local_secret","old_local_secret"]),f=t(["id","name","secret_name"]),_=t(["id","blocked_until"]),p=t(["id","origin","date_written","date_sent","text"]),m=t(["secret","name"]),{Contact:d,ContactRequest:f,ContactRequestBlocked:_,Message:p,Secret:m,State:g,get_instance:function(e){return e in u||(u[e]=g(e)),u[e]}}})}.call(this),function(){define("js/behaviors",["@detox/chat","js/state"],function(e,t){var n;return{state_instance:n={properties:{chatId:{type:String,value:"detox-chat-app"},state:Object},created:function(){this.state=t.get_instance(this.chatId),this.state.ready()||(detox_chat_app.notify_warning("Previous state was not found, new identity generated",60),this.state.set_seed(e.generate_seed()),this.state.add_secret(e.generate_secret().slice(0,4),"Default secret"))}},experience_level:[n,{advanced_user:{type:Boolean,value:!1},developer:{type:Boolean,value:!1},ready:function(){var e,t=this;e=this.state,this.advanced_user=e.get_settings_experience()>=e.EXPERIENCE_ADVANCED,this.developer=e.get_settings_experience()===e.EXPERIENCE_DEVELOPER,e.on("settings_experience_changed",function(n){t.advanced_user=n>=e.EXPERIENCE_ADVANCED,t.developer=n===e.EXPERIENCE_DEVELOPER})}}],help:[n,{properties:{help:Boolean},ready:function(){var e=this;this.help=this.state.get_settings_help(),this.state.on("settings_help_changed",function(t){e.help=t})}}]}})}.call(this),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define("hotkeys-js",t):e.hotkeys=t()}(this,function(){"use strict";var e="undefined"!=typeof navigator&&0<navigator.userAgent.toLowerCase().indexOf("firefox");function t(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,function(){n(window.event)})}function n(e,t){for(var n=t.slice(0,t.length-1),r=0;r<n.length;r++)n[r]=e[n[r].toLowerCase()];return n}function r(e){e||(e="");for(var t=(e=e.replace(/\s/g,"")).split(","),n=t.lastIndexOf("");0<=n;)t[n-1]+=",",t.splice(n,1),n=t.lastIndexOf("");return t}function i(e,t){for(var n=e.length<t.length?t:e,r=e.length<t.length?e:t,i=!0,s=0;s<n.length;s++)-1===r.indexOf(n[s])&&(i=!1);return i}for(var s={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,"":20,",":188,".":190,"/":191,"`":192,"-":e?173:189,"=":e?61:187,";":e?59:186,"'":222,"[":219,"]":221,"\\":220},o={"":16,shift:16,"":18,alt:18,option:18,"":17,ctrl:17,control:17,"":e?224:91,cmd:e?224:91,command:e?224:91},a=[],c={16:"shiftKey",18:"altKey",17:"ctrlKey"},l={16:!1,18:!1,17:!1},u={},h=1;h<20;h++)s["f"+h]=111+h;c[e?224:91]="metaKey";var d="all",f=l[e?224:91]=!1,_=function(e){return s[e.toLowerCase()]||e.toUpperCase().charCodeAt(0)};function p(e){d=e||"all"}function m(){return d||"all"}function g(e,t,n){var r=void 0;if(t.scope===n||"all"===t.scope){for(var i in r=0<t.mods.length,l)Object.prototype.hasOwnProperty.call(l,i)&&(!l[i]&&-1<t.mods.indexOf(+i)||l[i]&&-1===t.mods.indexOf(+i))&&(r=!1);(0!==t.mods.length||l[16]||l[18]||l[17]||l[91])&&!r&&"*"!==t.shortcut||!1===t.method(e,t)&&(e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation&&e.stopPropagation(),e.cancelBubble&&(e.cancelBubble=!0))}}function y(e,i,s){var h=r(e),d=[],p="all",b=document,v=0;for(void 0===s&&"function"==typeof i&&(s=i),"[object Object]"===toString.call(i)&&(i.scope&&(p=i.scope),i.element&&(b=i.element)),"string"==typeof i&&(p=i);v<h.length;v++)d=[],1<(e=h[v].split("+")).length&&(d=n(o,e)),(e="*"===(e=e[e.length-1])?"*":_(e))in u||(u[e]=[]),u[e].push({scope:p,mods:d,shortcut:h[v],method:s,key:h[v]});void 0===b||f||(f=!0,t(b,"keydown",function(e){!function(e){var t=u["*"],n=e.keyCode||e.which||e.charCode;if(-1===a.indexOf(n)&&a.push(n),93!==n&&224!==n||(n=91),n in l){for(var r in l[n]=!0,o)o[r]===n&&(y[r]=!0);if(!t)return}for(var i in l)Object.prototype.hasOwnProperty.call(l,i)&&(l[i]=e[c[i]]);if(y.filter.call(this,e)){var s=m();if(t)for(var h=0;h<t.length;h++)t[h].scope===s&&g(e,t[h],s);if(n in u)for(var d=0;d<u[n].length;d++)g(e,u[n][d],s)}}(e)}),t(b,"keyup",function(e){!function(e){var t=a.indexOf(n),n=e.keyCode||e.which||e.charCode;if(t<0||a.splice(t,1),93!==n&&224!==n||(n=91),n in l)for(var r in l[n]=!1,o)o[r]===n&&(y[r]=!1)}(e)}))}var b={setScope:p,getScope:m,deleteScope:function(e,t){var n=void 0,r=void 0;for(var i in e||(e=m()),u)if(Object.prototype.hasOwnProperty.call(u,i))for(n=u[i],r=0;r<n.length;)n[r].scope===e?n.splice(r,1):r++;m()===e&&p(t||"all")},getPressedKeyCodes:function(){return a.slice(0)},isPressed:function(e){return"string"==typeof e&&(e=_(e)),-1!==a.indexOf(e)},filter:function(e){var t=e.target.tagName||e.srcElement.tagName;return!("INPUT"===t||"SELECT"===t||"TEXTAREA"===t)},unbind:function(e,t){for(var s=r(e),a=void 0,c=[],l=void 0,h=0;h<s.length;h++){if(1<(a=s[h].split("+")).length&&(c=n(o,a)),e="*"===(e=a[a.length-1])?"*":_(e),t||(t=m()),!u[e])return;for(var d=0;d<u[e].length;d++)(l=u[e][d]).scope===t&&i(l.mods,c)&&(u[e][d]={})}}};for(var v in b)Object.prototype.hasOwnProperty.call(b,v)&&(y[v]=b[v]);if("undefined"!=typeof window){var w=window.hotkeys;y.noConflict=function(e){return e&&window.hotkeys===y&&(window.hotkeys=w),y},window.hotkeys=y}return y}),function(e){"use strict";var t={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:_,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *#* *(?:\n+|$)/,nptable:_,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( *)(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:/^ *(?:comment *(?:\n|\s*$)|closed *(?:\n{2,}|\s*$)|closing *(?:\n{2,}|\s*$))/,def:/^ {0,3}\[(label)\]: *\n? *<?([^\s>]+)>?(?:(?: +\n? *| *\n *)(title))? *(?:\n+|$)/,table:_,lheading:/^([^\n]+)\n *(=|-){2,} *(?:\n+|$)/,paragraph:/^([^\n]+(?:\n?(?!hr|heading|lheading| {0,3}>|tag)[^\n]+)+)/,text:/^[^\n]+/};function n(e){this.tokens=[],this.tokens.links={},this.options=e||m.defaults,this.rules=t.normal,this.options.gfm&&(this.options.tables?this.rules=t.tables:this.rules=t.gfm)}t._label=/(?:\\[\[\]]|[^\[\]])+/,t._title=/(?:"(?:\\"|[^"]|"[^"\n]*")*"|'\n?(?:[^'\n]+\n?)*'|\([^()]*\))/,t.def=u(t.def).replace("label",t._label).replace("title",t._title).getRegex(),t.bullet=/(?:[*+-]|\d+\.)/,t.item=/^( *)(bull) [^\n]*(?:\n(?!\1bull )[^\n]*)*/,t.item=u(t.item,"gm").replace(/bull/g,t.bullet).getRegex(),t.list=u(t.list).replace(/bull/g,t.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+t.def.source+")").getRegex(),t._tag="(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b",t.html=u(t.html).replace("comment",/<!--[\s\S]*?-->/).replace("closed",/<(tag)[\s\S]+?<\/\1>/).replace("closing",/<tag(?:"[^"]*"|'[^']*'|\s[^'"\/>\s]*)*?\/?>/).replace(/tag/g,t._tag).getRegex(),t.paragraph=u(t.paragraph).replace("hr",t.hr).replace("heading",t.heading).replace("lheading",t.lheading).replace("tag","<"+t._tag).getRegex(),t.blockquote=u(t.blockquote).replace("paragraph",t.paragraph).getRegex(),t.normal=p({},t),t.gfm=p({},t.normal,{fences:/^ *(`{3,}|~{3,})[ \.]*(\S+)? *\n([\s\S]*?)\n? *\1 *(?:\n+|$)/,paragraph:/^/,heading:/^ *(#{1,6}) +([^\n]+?) *#* *(?:\n+|$)/}),t.gfm.paragraph=u(t.paragraph).replace("(?!","(?!"+t.gfm.fences.source.replace("\\1","\\2")+"|"+t.list.source.replace("\\1","\\3")+"|").getRegex(),t.tables=p({},t.gfm,{nptable:/^ *(\S.*\|.*)\n *([-:]+ *\|[-| :]*)\n((?:.*\|.*(?:\n|$))*)\n*/,table:/^ *\|(.+)\n *\|( *[-:]+[-| :]*)\n((?: *\|.*(?:\n|$))*)\n*/}),n.rules=t,n.lex=function(e,t){return new n(t).lex(e)},n.prototype.lex=function(e){return e=e.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,"\n"),this.token(e,!0)},n.prototype.token=function(e,n){var r,i,s,o,a,c,l,u,h,d,f;for(e=e.replace(/^ +$/gm,"");e;)if((s=this.rules.newline.exec(e))&&(e=e.substring(s[0].length),s[0].length>1&&this.tokens.push({type:"space"})),s=this.rules.code.exec(e))e=e.substring(s[0].length),s=s[0].replace(/^ {4}/gm,""),this.tokens.push({type:"code",text:this.options.pedantic?s:s.replace(/\n+$/,"")});else if(s=this.rules.fences.exec(e))e=e.substring(s[0].length),this.tokens.push({type:"code",lang:s[2],text:s[3]||""});else if(s=this.rules.heading.exec(e))e=e.substring(s[0].length),this.tokens.push({type:"heading",depth:s[1].length,text:s[2]});else if(n&&(s=this.rules.nptable.exec(e))){for(e=e.substring(s[0].length),c={type:"table",header:s[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:s[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:s[3].replace(/\n$/,"").split("\n")},u=0;u<c.align.length;u++)/^ *-+: *$/.test(c.align[u])?c.align[u]="right":/^ *:-+: *$/.test(c.align[u])?c.align[u]="center":/^ *:-+ *$/.test(c.align[u])?c.align[u]="left":c.align[u]=null;for(u=0;u<c.cells.length;u++)c.cells[u]=c.cells[u].split(/ *\| */);this.tokens.push(c)}else if(s=this.rules.hr.exec(e))e=e.substring(s[0].length),this.tokens.push({type:"hr"});else if(s=this.rules.blockquote.exec(e))e=e.substring(s[0].length),this.tokens.push({type:"blockquote_start"}),s=s[0].replace(/^ *> ?/gm,""),this.token(s,n),this.tokens.push({type:"blockquote_end"});else if(s=this.rules.list.exec(e)){for(e=e.substring(s[0].length),f=(o=s[2]).length>1,this.tokens.push({type:"list_start",ordered:f,start:f?+o:""}),r=!1,d=(s=s[0].match(this.rules.item)).length,u=0;u<d;u++)l=(c=s[u]).length,~(c=c.replace(/^ *([*+-]|\d+\.) +/,"")).indexOf("\n ")&&(l-=c.length,c=this.options.pedantic?c.replace(/^ {1,4}/gm,""):c.replace(new RegExp("^ {1,"+l+"}","gm"),"")),this.options.smartLists&&u!==d-1&&(o===(a=t.bullet.exec(s[u+1])[0])||o.length>1&&a.length>1||(e=s.slice(u+1).join("\n")+e,u=d-1)),i=r||/\n\n(?!\s*$)/.test(c),u!==d-1&&(r="\n"===c.charAt(c.length-1),i||(i=r)),this.tokens.push({type:i?"loose_item_start":"list_item_start"}),this.token(c,!1),this.tokens.push({type:"list_item_end"});this.tokens.push({type:"list_end"})}else if(s=this.rules.html.exec(e))e=e.substring(s[0].length),this.tokens.push({type:this.options.sanitize?"paragraph":"html",pre:!this.options.sanitizer&&("pre"===s[1]||"script"===s[1]||"style"===s[1]),text:s[0]});else if(n&&(s=this.rules.def.exec(e)))e=e.substring(s[0].length),s[3]&&(s[3]=s[3].substring(1,s[3].length-1)),h=s[1].toLowerCase(),this.tokens.links[h]||(this.tokens.links[h]={href:s[2],title:s[3]});else if(n&&(s=this.rules.table.exec(e))){for(e=e.substring(s[0].length),c={type:"table",header:s[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:s[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:s[3].replace(/(?: *\| *)?\n$/,"").split("\n")},u=0;u<c.align.length;u++)/^ *-+: *$/.test(c.align[u])?c.align[u]="right":/^ *:-+: *$/.test(c.align[u])?c.align[u]="center":/^ *:-+ *$/.test(c.align[u])?c.align[u]="left":c.align[u]=null;for(u=0;u<c.cells.length;u++)c.cells[u]=c.cells[u].replace(/^ *\| *| *\| *$/g,"").split(/ *\| */);this.tokens.push(c)}else if(s=this.rules.lheading.exec(e))e=e.substring(s[0].length),this.tokens.push({type:"heading",depth:"="===s[2]?1:2,text:s[1]});else if(n&&(s=this.rules.paragraph.exec(e)))e=e.substring(s[0].length),this.tokens.push({type:"paragraph",text:"\n"===s[1].charAt(s[1].length-1)?s[1].slice(0,-1):s[1]});else if(s=this.rules.text.exec(e))e=e.substring(s[0].length),this.tokens.push({type:"text",text:s[0]});else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0));return this.tokens};var r={escape:/^\\([\\`*{}\[\]()#+\-.!_>])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:_,tag:/^<!--[\s\S]*?-->|^<\/?[a-zA-Z0-9\-]+(?:"[^"]*"|'[^']*'|\s[^<'">\/\s]*)*?\/?>/,link:/^!?\[(inside)\]\(href\)/,reflink:/^!?\[(inside)\]\s*\[([^\]]*)\]/,nolink:/^!?\[((?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]])*)\]/,strong:/^__([\s\S]+?)__(?!_)|^\*\*([\s\S]+?)\*\*(?!\*)/,em:/^_([^\s_](?:[^_]|__)+?[^\s_])_\b|^\*((?:\*\*|[^*])+?)\*(?!\*)/,code:/^(`+)\s*([\s\S]*?[^`]?)\s*\1(?!`)/,br:/^ {2,}\n(?!\s*$)/,del:_,text:/^[\s\S]+?(?=[\\<!\[`*]|\b_| {2,}\n|$)/};function i(e,t){if(this.options=t||m.defaults,this.links=e,this.rules=r.normal,this.renderer=this.options.renderer||new s,this.renderer.options=this.options,!this.links)throw new Error("Tokens array requires a `links` property.");this.options.gfm?this.options.breaks?this.rules=r.breaks:this.rules=r.gfm:this.options.pedantic&&(this.rules=r.pedantic)}function s(e){this.options=e||{}}function o(){}function a(e){this.tokens=[],this.token=null,this.options=e||m.defaults,this.options.renderer=this.options.renderer||new s,this.renderer=this.options.renderer,this.renderer.options=this.options}function c(e,t){return e.replace(t?/&/g:/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function l(e){return e.replace(/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi,function(e,t){return"colon"===(t=t.toLowerCase())?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""})}function u(e,t){return e=e.source,t=t||"",{replace:function(t,n){return n=(n=n.source||n).replace(/(^|[^\[])\^/g,"$1"),e=e.replace(t,n),this},getRegex:function(){return new RegExp(e,t)}}}function h(e,t){return d[" "+e]||(/^[^:]+:\/*[^/]*$/.test(e)?d[" "+e]=e+"/":d[" "+e]=e.replace(/[^/]*$/,"")),e=d[" "+e],"//"===t.slice(0,2)?e.replace(/:[\s\S]*/,":")+t:"/"===t.charAt(0)?e.replace(/(:\/*[^/]*)[\s\S]*/,"$1")+t:e+t}r._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,r._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,r.autolink=u(r.autolink).replace("scheme",r._scheme).replace("email",r._email).getRegex(),r._inside=/(?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]]|\](?=[^\[]*\]))*/,r._href=/\s*<?([\s\S]*?)>?(?:\s+['"]([\s\S]*?)['"])?\s*/,r.link=u(r.link).replace("inside",r._inside).replace("href",r._href).getRegex(),r.reflink=u(r.reflink).replace("inside",r._inside).getRegex(),r.normal=p({},r),r.pedantic=p({},r.normal,{strong:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/}),r.gfm=p({},r.normal,{escape:u(r.escape).replace("])","~|])").getRegex(),url:u(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("email",r._email).getRegex(),_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^~~(?=\S)([\s\S]*?\S)~~/,text:u(r.text).replace("]|","~]|").replace("|","|https?://|ftp://|www\\.|[a-zA-Z0-9.!#$%&'*+/=?^_`{\\|}~-]+@|").getRegex()}),r.breaks=p({},r.gfm,{br:u(r.br).replace("{2,}","*").getRegex(),text:u(r.gfm.text).replace("{2,}","*").getRegex()}),i.rules=r,i.output=function(e,t,n){return new i(t,n).output(e)},i.prototype.output=function(e){for(var t,n,r,i,s="";e;)if(i=this.rules.escape.exec(e))e=e.substring(i[0].length),s+=i[1];else if(i=this.rules.autolink.exec(e))e=e.substring(i[0].length),r="@"===i[2]?"mailto:"+(n=c(this.mangle(i[1]))):n=c(i[1]),s+=this.renderer.link(r,null,n);else if(this.inLink||!(i=this.rules.url.exec(e))){if(i=this.rules.tag.exec(e))!this.inLink&&/^<a /i.test(i[0])?this.inLink=!0:this.inLink&&/^<\/a>/i.test(i[0])&&(this.inLink=!1),e=e.substring(i[0].length),s+=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(i[0]):c(i[0]):i[0];else if(i=this.rules.link.exec(e))e=e.substring(i[0].length),this.inLink=!0,s+=this.outputLink(i,{href:i[2],title:i[3]}),this.inLink=!1;else if((i=this.rules.reflink.exec(e))||(i=this.rules.nolink.exec(e))){if(e=e.substring(i[0].length),t=(i[2]||i[1]).replace(/\s+/g," "),!(t=this.links[t.toLowerCase()])||!t.href){s+=i[0].charAt(0),e=i[0].substring(1)+e;continue}this.inLink=!0,s+=this.outputLink(i,t),this.inLink=!1}else if(i=this.rules.strong.exec(e))e=e.substring(i[0].length),s+=this.renderer.strong(this.output(i[2]||i[1]));else if(i=this.rules.em.exec(e))e=e.substring(i[0].length),s+=this.renderer.em(this.output(i[2]||i[1]));else if(i=this.rules.code.exec(e))e=e.substring(i[0].length),s+=this.renderer.codespan(c(i[2].trim(),!0));else if(i=this.rules.br.exec(e))e=e.substring(i[0].length),s+=this.renderer.br();else if(i=this.rules.del.exec(e))e=e.substring(i[0].length),s+=this.renderer.del(this.output(i[1]));else if(i=this.rules.text.exec(e))e=e.substring(i[0].length),s+=this.renderer.text(c(this.smartypants(i[0])));else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0))}else i[0]=this.rules._backpedal.exec(i[0])[0],e=e.substring(i[0].length),"@"===i[2]?r="mailto:"+(n=c(i[0])):(n=c(i[0]),r="www."===i[1]?"http://"+n:n),s+=this.renderer.link(r,null,n);return s},i.prototype.outputLink=function(e,t){var n=c(t.href),r=t.title?c(t.title):null;return"!"!==e[0].charAt(0)?this.renderer.link(n,r,this.output(e[1])):this.renderer.image(n,r,c(e[1]))},i.prototype.smartypants=function(e){return this.options.smartypants?e.replace(/---/g,"").replace(/--/g,"").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1").replace(/'/g,"").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1").replace(/"/g,"").replace(/\.{3}/g,""):e},i.prototype.mangle=function(e){if(!this.options.mangle)return e;for(var t,n="",r=e.length,i=0;i<r;i++)t=e.charCodeAt(i),Math.random()>.5&&(t="x"+t.toString(16)),n+="&#"+t+";";return n},s.prototype.code=function(e,t,n){if(this.options.highlight){var r=this.options.highlight(e,t);null!=r&&r!==e&&(n=!0,e=r)}return t?'<pre><code class="'+this.options.langPrefix+c(t,!0)+'">'+(n?e:c(e,!0))+"\n</code></pre>\n":"<pre><code>"+(n?e:c(e,!0))+"\n</code></pre>"},s.prototype.blockquote=function(e){return"<blockquote>\n"+e+"</blockquote>\n"},s.prototype.html=function(e){return e},s.prototype.heading=function(e,t,n){return"<h"+t+' id="'+this.options.headerPrefix+n.toLowerCase().replace(/[^\w]+/g,"-")+'">'+e+"</h"+t+">\n"},s.prototype.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},s.prototype.list=function(e,t,n){var r=t?"ol":"ul";return"<"+r+(t&&1!==n?' start="'+n+'"':"")+">\n"+e+"</"+r+">\n"},s.prototype.listitem=function(e){return"<li>"+e+"</li>\n"},s.prototype.paragraph=function(e){return"<p>"+e+"</p>\n"},s.prototype.table=function(e,t){return"<table>\n<thead>\n"+e+"</thead>\n<tbody>\n"+t+"</tbody>\n</table>\n"},s.prototype.tablerow=function(e){return"<tr>\n"+e+"</tr>\n"},s.prototype.tablecell=function(e,t){var n=t.header?"th":"td";return(t.align?"<"+n+' style="text-align:'+t.align+'">':"<"+n+">")+e+"</"+n+">\n"},s.prototype.strong=function(e){return"<strong>"+e+"</strong>"},s.prototype.em=function(e){return"<em>"+e+"</em>"},s.prototype.codespan=function(e){return"<code>"+e+"</code>"},s.prototype.br=function(){return this.options.xhtml?"<br/>":"<br>"},s.prototype.del=function(e){return"<del>"+e+"</del>"},s.prototype.link=function(e,t,n){if(this.options.sanitize){try{var r=decodeURIComponent(l(e)).replace(/[^\w:]/g,"").toLowerCase()}catch(e){return n}if(0===r.indexOf("javascript:")||0===r.indexOf("vbscript:")||0===r.indexOf("data:"))return n}this.options.baseUrl&&!f.test(e)&&(e=h(this.options.baseUrl,e));var i='<a href="'+e+'"';return t&&(i+=' title="'+t+'"'),i+">"+n+"</a>"},s.prototype.image=function(e,t,n){this.options.baseUrl&&!f.test(e)&&(e=h(this.options.baseUrl,e));var r='<img src="'+e+'" alt="'+n+'"';return t&&(r+=' title="'+t+'"'),r+(this.options.xhtml?"/>":">")},s.prototype.text=function(e){return e},o.prototype.strong=o.prototype.em=o.prototype.codespan=o.prototype.del=o.prototype.text=function(e){return e},o.prototype.link=o.prototype.image=function(e,t,n){return""+n},o.prototype.br=function(){return""},a.parse=function(e,t){return new a(t).parse(e)},a.prototype.parse=function(e){this.inline=new i(e.links,this.options),this.inlineText=new i(e.links,p({},this.options,{renderer:new o})),this.tokens=e.reverse();for(var t="";this.next();)t+=this.tok();return t},a.prototype.next=function(){return this.token=this.tokens.pop()},a.prototype.peek=function(){return this.tokens[this.tokens.length-1]||0},a.prototype.parseText=function(){for(var e=this.token.text;"text"===this.peek().type;)e+="\n"+this.next().text;return this.inline.output(e)},a.prototype.tok=function(){switch(this.token.type){case"space":return"";case"hr":return this.renderer.hr();case"heading":return this.renderer.heading(this.inline.output(this.token.text),this.token.depth,l(this.inlineText.output(this.token.text)));case"code":return this.renderer.code(this.token.text,this.token.lang,this.token.escaped);case"table":var e,t,n,r,i="",s="";for(n="",e=0;e<this.token.header.length;e++)n+=this.renderer.tablecell(this.inline.output(this.token.header[e]),{header:!0,align:this.token.align[e]});for(i+=this.renderer.tablerow(n),e=0;e<this.token.cells.length;e++){for(t=this.token.cells[e],n="",r=0;r<t.length;r++)n+=this.renderer.tablecell(this.inline.output(t[r]),{header:!1,align:this.token.align[r]});s+=this.renderer.tablerow(n)}return this.renderer.table(i,s);case"blockquote_start":for(s="";"blockquote_end"!==this.next().type;)s+=this.tok();return this.renderer.blockquote(s);case"list_start":s="";for(var o=this.token.ordered,a=this.token.start;"list_end"!==this.next().type;)s+=this.tok();return this.renderer.list(s,o,a);case"list_item_start":for(s="";"list_item_end"!==this.next().type;)s+="text"===this.token.type?this.parseText():this.tok();return this.renderer.listitem(s);case"loose_item_start":for(s="";"list_item_end"!==this.next().type;)s+=this.tok();return this.renderer.listitem(s);case"html":var c=this.token.pre||this.options.pedantic?this.token.text:this.inline.output(this.token.text);return this.renderer.html(c);case"paragraph":return this.renderer.paragraph(this.inline.output(this.token.text));case"text":return this.renderer.paragraph(this.parseText())}};var d={},f=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function _(){}function p(e){for(var t,n,r=1;r<arguments.length;r++)for(n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}function m(e,t,r){if(null==e)throw new Error("marked(): input parameter is undefined or null");if("string"!=typeof e)throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");if(r||"function"==typeof t){r||(r=t,t=null);var i,s,o=(t=p({},m.defaults,t||{})).highlight,l=0;try{i=n.lex(e,t)}catch(e){return r(e)}s=i.length;var u=function(e){if(e)return t.highlight=o,r(e);var n;try{n=a.parse(i,t)}catch(t){e=t}return t.highlight=o,e?r(e):r(null,n)};if(!o||o.length<3)return u();if(delete t.highlight,!s)return u();for(;l<i.length;l++)!function(e){"code"!==e.type?--s||u():o(e.text,e.lang,function(t,n){return t?u(t):null==n||n===e.text?--s||u():(e.text=n,e.escaped=!0,void(--s||u()))})}(i[l])}else try{return t&&(t=p({},m.defaults,t)),a.parse(n.lex(e,t),t)}catch(e){if(e.message+="\nPlease report this to https://github.com/markedjs/marked.",(t||m.defaults).silent)return"<p>An error occurred:</p><pre>"+c(e.message+"",!0)+"</pre>";throw e}}_.exec=_,m.options=m.setOptions=function(e){return p(m.defaults,e),m},m.defaults={gfm:!0,tables:!0,breaks:!1,pedantic:!1,sanitize:!1,sanitizer:null,mangle:!0,smartLists:!1,silent:!1,highlight:null,langPrefix:"lang-",smartypants:!1,headerPrefix:"",renderer:new s,xhtml:!1,baseUrl:null},m.Parser=a,m.parser=a.parse,m.Renderer=s,m.TextRenderer=o,m.Lexer=n,m.lexer=n.lex,m.InlineLexer=i,m.inlineLexer=i.output,m.parse=m,"undefined"!=typeof module&&"object"==typeof exports?module.exports=m:"function"==typeof define&&define.amd?define("marked",[],function(){return m}):e.marked=m}(this||("undefined"!=typeof window?window:global)),function(){define("js/markdown",["marked"],function(e){var t,n;return(t=new e.Renderer).link=function(){return e.Renderer.prototype.link.apply(this,arguments).replace(/<a/,'$& target="_blank" rel="noreferrer noopener"')},t.image=t.link,n={baseUrl:"#",breaks:!0,gfm:!0,headerIds:!1,renderer:t,sanitize:!0,tables:!0},function(t){return e(t,n)}})}.call(this);